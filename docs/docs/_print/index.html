<!doctype html>
<html itemscope itemtype="http://schema.org/WebPage" lang="en" class="no-js">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link rel="canonical" type="text/html" href="/docs/">
<link rel="alternate" type="application/rss&#43;xml" href="/docs/index.xml">
<meta name="robots" content="noindex, nofollow">


<link rel="shortcut icon" href="/favicons/favicon.ico" >
<link rel="apple-touch-icon" href="/favicons/apple-touch-icon-180x180.png" sizes="180x180">
<link rel="icon" type="image/png" href="/favicons/favicon-16x16.png" sizes="16x16">
<link rel="icon" type="image/png" href="/favicons/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/favicons/android-36x36.png" sizes="36x36">
<link rel="icon" type="image/png" href="/favicons/android-48x48.png" sizes="48x48">
<link rel="icon" type="image/png" href="/favicons/android-72x72.png" sizes="72x72">
<link rel="icon" type="image/png" href="/favicons/android-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="/favicons/android-144x144.png" sizes="144x144">
<link rel="icon" type="image/png" href="/favicons/android-192x192.png" sizes="192x192">

<title>Documentation | buzzpirat</title>
<meta name="description" content="All-In-One Hardware Hacking tool for learning, practice, and play">
<meta property="og:title" content="Documentation" />
<meta property="og:description" content="All-In-One Hardware Hacking tool for learning, practice, and play" />
<meta property="og:type" content="website" />
<meta property="og:url" content="/docs/" /><meta property="og:site_name" content="buzzpirat" />
<meta itemprop="name" content="Documentation">
<meta itemprop="description" content="All-In-One Hardware Hacking tool for learning, practice, and play"><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Documentation"/>
<meta name="twitter:description" content="All-In-One Hardware Hacking tool for learning, practice, and play"/>




<link rel="preload" href="/scss/main.min.32eaa2fda0f7c82e78980a4fdfc08c5d0d69e751112d336c36776a89ea96acec.css" as="style">
<link href="/scss/main.min.32eaa2fda0f7c82e78980a4fdfc08c5d0d69e751112d336c36776a89ea96acec.css" rel="stylesheet" integrity="">

<script
  src="https://code.jquery.com/jquery-3.6.3.min.js"
  integrity="sha512-STof4xm1wgkfm7heWqFJVn58Hm3EtS31XFaagaa8VMReCXAkQnJZ+jEy8PCC/iT18dFy95WcExNHFTqLyp72eQ=="
  crossorigin="anonymous"></script>
<script defer
  src="https://unpkg.com/lunr@2.3.9/lunr.min.js"
  integrity="sha384-203J0SNzyqHby3iU6hzvzltrWi/M41wOP5Gu+BiJMz5nwKykbkUx8Kp7iti0Lpli"
  crossorigin="anonymous"></script>

  </head>
  <body class="td-section">
    <header>
      <style>
  @media (max-width: 991px) {
  .navbar-custom {
  background-color: #30638e !important;
  background-image: none !important;
  }
  }
  .navbar-custom {
  background-image: none !important;
  }
  .search-custom::placeholder {
  color: white;
  opacity: 1;
  }
  .nav-item{
  padding-inline-end: 0.5rem;
  }
</style>
<header>
  
  
  <nav class="navbar navbar-custom navbar-dark navbar-expand-lg js-navbar-scroll " style="background-color:#30638e;">
  
    <div class="container-fluid fw-bold">
      <a class="navbar-brand" href="/">
      <img src="/favicons/buzzpirat-white-144x144.png" alt="Icono" width="30" height="30" class="d-inline-block align-top" />
      <span class="navbar-brand__name">Buzzpirat</span>
      </a>
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#main_navbar" aria-controls="main_navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse justify-content-end" id="main_navbar">
        <ul class="navbar-nav">
          
          <li class="nav-item">
            <a class="nav-link" href="https://fr33project.org/buzz.php"  target="_blank" rel="noopener"  ><span>Buy</span></a>
          </li>
          
          <li class="nav-item">
            <a class="nav-link" href="/"  ><span>Home</span></a>
          </li>
          
          <li class="nav-item">
            <a class="nav-link" href="/docs/"  ><span>Docs</span></a>
          </li>
          
          <li class="nav-item">
            <a class="nav-link" href="https://github.com/therealdreg/buzzpirat/discussions"  target="_blank" rel="noopener"  ><span>Community</span></a>
          </li>
          
          <li class="nav-item">
            <a class="nav-link" href="https://github.com/therealdreg/buzzpirat"  target="_blank" rel="noopener"  ><span>GitHub</span></a>
          </li>
          
          <li class="nav-item">
            <a class="nav-link" href="/donations/"  ><span>Donations</span></a>
          </li>
          
          <li class="nav-item">
            <a class="nav-link" href="/acknowledgements/"  ><span>Acknowledgements</span></a>
          </li>
          
          <li class="nav-item td-search td-search--offline">
            <div style="color: white" class="td-search__icon"></div>
            <input
              type="search" style="border: none;"
              class="td-search__input form-control search-custom"
              placeholder="Search this site…"
              aria-label="Search this site…"
              autocomplete="off"
              data-offline-search-index-json-src="/offline-search-index.json"
              data-offline-search-base-href="/"
              data-offline-search-max-results="10"
              >
          </li>
        </ul>
      </div>
    </div>
  </nav>
</header>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>

    </header>
    <div class="container-fluid td-outer">
      <div class="td-main">
        <div class="row flex-xl-nowrap">
          <main class="col-12 col-md-9 col-xl-8 ps-md-5" role="main">
            




<div class="td-content">
<div class="pageinfo pageinfo-primary d-print-none">
<p>
This is the multi-page printable view of this section.
<a href="#" onclick="print();return false;">Click here to print</a>.
</p><p>
<a href="/docs/">Return to the regular view of this page</a>.
</p>
</div>



<h1 class="title">Documentation</h1>





    <ul>
    
  
  
  
  

  
    
    
	
<li>1: <a href="#pg-81b64e5e890a35284f3748234c4098b1">Getting Started</a></li>


    
    <ul>
        
  
  
  
  

  

    </ul>
    
  
    
    
	
<li>2: <a href="#pg-e459c51a85b49d14d7b61448e704de0d">How to use</a></li>


    
    <ul>
        
  
  
  
  

  

    </ul>
    
  
    
    
	
<li>3: <a href="#pg-c639f7a400d557214471d50010a514eb">Unbrick</a></li>


    
    <ul>
        
  
  
  
  

  

    </ul>
    
  
    
    
	
<li>4: <a href="#pg-f0244b1b55a581904dd1c3ad618f02b4">Binary I/O</a></li>


    
    <ul>
        
  
  
  
  

  

    </ul>
    
  
    
    
	
<li>5: <a href="#pg-e33d280f8f801c075f49bbb64a6ec927">Firmware Update</a></li>


    
    <ul>
        
  
  
  
  

  

    </ul>
    
  
    
    
	
<li>6: <a href="#pg-6b758cfd7e576dd18fee3c05f62ee978">AVRDude</a></li>


    
    <ul>
        
  
  
  
  

  

    </ul>
    
  
    
    
	
<li>7: <a href="#pg-d33db6d5cfbb7ff60d1e19cd08607f8c">Flashrom</a></li>


    
    <ul>
        
  
  
  
  

  

    </ul>
    
  

    </ul>


<div class="content">
      
</div>
</div>


  
  
  
  

  
  

  
    
    
	
    

<div class="td-content" style="">
    
	<h1 id="pg-81b64e5e890a35284f3748234c4098b1">1 - Getting Started</h1>
    <div class="lead">I have no idea about hardware hacking, where should I start?</div>
	<p>Just bought a full Buzzpirat kit with everything included and want to start using it, but have no idea about mathematics, electronics, or hardware hacking? This is your starting point, let&rsquo;s go!</p>
<h2 id="what-is-the-buzzpirat">What is the Buzzpirat?</h2>
<p>The Buzzpirat is a hardware hacking tool that allows you to talk with chips. It is based on the Bus Pirate v3, a universal bus interface that talks to electronics from a computer serial terminal. The Buzzpirat is a Bus Pirate clone with a few modifications to make it more secure+complete for hardware hacking</p>
<h2 id="what-is-hardware-hacking">What is hardware hacking?</h2>
<p>Hardware Hacking is the art of breaking and/or modifying electronics for fun, profit, and the advancement of technology. Hardware hacking is not limited to electronics, but it often is. Other examples of hardware hacking include modifying cars, bicycles, and other mechanical systems.</p>
<h2 id="our-first-time-communicating-with-a-chip">Our first time communicating with a chip</h2>
<p>Let&rsquo;s start with a simple example. We will use the Buzzpirat to communicate with a chip and read its content. For this example, we will use a AT24C256 I2C EEPROM 5V board. This board is included in our full kit for practice purposes. You can purchase another one on Aliexpress, Amazon, or eBay.</p>
<p><img src="/conn/at24c256schboard.png" alt=""></p>
<p>Intimidated by seeing a schematic and a board with lots of strange components? Don&rsquo;t worry, we&rsquo;ll take it step by step to understand what&rsquo;s going on.</p>
<p>For this case, simply use the official Buzzpirat cables with the female Dupont connector they come with; there&rsquo;s no need to use SMD IC clips. Connect the Buzzpirat to the AT24C256 board by attaching the +5v(SW5V0) to VCC, CLK to SCL, MOSI(SDA) to SDA, and GND to GND, ensuring each connection is secure for proper functionality.</p>


<div class="alert alert-warning" role="alert">
<h4 class="alert-heading">Warning</h4>

    <strong>Also, connect the VPU pin to a SW5V0 pin of the Buzzpirat</strong>.

</div>

<table>
<thead>
<tr>
<th>Buzzpirat</th>
<th>AT24C256 board</th>
</tr>
</thead>
<tbody>
<tr>
<td>+5v(SW5V0)</td>
<td>VCC</td>
</tr>
<tr>
<td>CLK</td>
<td>SCL</td>
</tr>
<tr>
<td>MOSI(SDA)</td>
<td>SDA</td>
</tr>
<tr>
<td>GND</td>
<td>GND</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>Buzzpirat</th>
<th>Buzzpirat</th>
</tr>
</thead>
<tbody>
<tr>
<td>+5v(SW5V0)</td>
<td>VPU</td>
</tr>
</tbody>
</table>
<p><img src="/conn/atcconnection.png" alt=""></p>
<p><img src="/conn/conn1.png" alt=""></p>
<style>
  #table-buzzpirat  { max-width: 80%; border: 2px solid #333; }
  #table-buzzpirat th, #table-buzzpirat  td { border-bottom: 1px solid #ddd; text-align: center }
  #table-buzzpirat th { background-color: #403f4c; color: #fff; }
  #table-buzzpirat .lt-red { color: #dc3545;font-weight: bold;}
  #table-buzzpirat .lt-white { color: #ffffff;font-weight: bold;}
  #table-buzzpirat .lt-yellow { color: #f4f901;font-weight: bold;}
  #table-buzzpirat .lt-black { color: #070d18;font-weight: bold;}
  #table-buzzpirat .lt-green { color: #2fffab;font-weight: bold;}
  #table-buzzpirat .lt-gray { color: #8d8d8d;font-weight: bold;}
  #table-buzzpirat .bgr-red { background-color: #fff; }
  #table-buzzpirat .bgr-white { background-color: #403f4c; }
  #table-buzzpirat .bgr-yellow { background-color: #403f4c; }
  #table-buzzpirat .bgr-black { background-color: #fff; }
  #table-buzzpirat .bgr-green { background-color: #403f4c; }
  #table-buzzpirat .bgr-gray { background-color: #fff; }
</style>
<div class="table-responsive-sm">
<table id="table-buzzpirat" class="td-initial table table-dark">
  <thead>
    <tr>
      <th class="bgr-red lt-red display-6">MODE</th>
      <th class="bgr-white lt-white display-6">MOSI</th>
      <th class="bgr-yellow lt-yellow display-6">CLK</th>
      <th class="bgr-black lt-black display-6">MISO</th>
      <th class="bgr-green lt-green display-6">CS</th>
      <th class="bgr-gray lt-gray display-6">AUX</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td class="lt-red bgr-red">HiZ</td>
      <td class="lt-white bgr-white">-</td>
      <td class="lt-yellow bgr-yellow">-</td>
      <td class="lt-black bgr-black">-</td>
      <td class="lt-green bgr-green">-</td>
      <td class="lt-gray bgr-gray">-</td>
    </tr>
    <tr>
      <td class="lt-red bgr-red">1-Wire</td>
      <td class="lt-white bgr-white">OWD</td>
      <td class="lt-yellow bgr-yellow">-</td>
      <td class="lt-black bgr-black">-</td>
      <td class="lt-green bgr-green">-</td>
      <td class="lt-gray bgr-gray">-</td>
    </tr>
    <tr>
      <td class="lt-red bgr-red">UART</td>
      <td class="lt-white bgr-white">TX</td>
      <td class="lt-yellow bgr-yellow">-</td>
      <td class="lt-black bgr-black">RX</td>
      <td class="lt-green bgr-green">-</td>
      <td class="lt-gray bgr-gray">-</td>
    </tr>
    <tr>
      <td class="lt-red bgr-red">I2C</td>
      <td class="lt-white bgr-white">SDA</td>
      <td class="lt-yellow bgr-yellow">SCL</td>
      <td class="lt-black bgr-black">-</td>
      <td class="lt-green bgr-green">-</td>
      <td class="lt-gray bgr-gray">-</td>
    </tr>
    <tr>
      <td class="lt-red bgr-red">SPI</td>
      <td class="lt-white bgr-white">MOSI</td>
      <td class="lt-yellow bgr-yellow">CLK</td>
      <td class="lt-black bgr-black">MISO</td>
      <td class="lt-green bgr-green">CS</td>
      <td class="lt-gray bgr-gray">-</td>
    </tr>
    <tr>
      <td class="lt-red bgr-red">JTAG</td>
      <td class="lt-white bgr-white">TDI</td>
      <td class="lt-yellow bgr-yellow">TCK</td>
      <td class="lt-black bgr-black">TDO</td>
      <td class="lt-green bgr-green">TMS</td>
      <td class="lt-gray bgr-gray">-</td>
    </tr>
    <tr>
      <td class="lt-red bgr-red">AVR</td>
      <td class="lt-white bgr-white">MOSI</td>
      <td class="lt-yellow bgr-yellow">SCK</td>
      <td class="lt-black bgr-black">MISO</td>
      <td class="lt-green bgr-green">RESET</td>
      <td class="lt-gray bgr-gray">XTAL1</td>
    <tr>
    <tr>
      <td class="lt-red bgr-red">PIC</td>
      <td class="lt-white bgr-white">PGD</td>
      <td class="lt-yellow bgr-yellow">PGC</td>
      <td class="lt-black bgr-black">-</td>
      <td class="lt-green bgr-green">MCLR</td>
      <td class="lt-gray bgr-gray">-</td>
    <tr>
    <tr>
      <td class="lt-red bgr-red">2-Wire</td>
      <td class="lt-white bgr-white">OWD1</td>
      <td class="lt-yellow bgr-yellow">OWD2</td>
      <td class="lt-black bgr-black">-</td>
      <td class="lt-green bgr-green">-</td>
      <td class="lt-gray bgr-gray">-</td>
    <tr>
    <tr>
      <td class="lt-red bgr-red">3-Wire</td>
      <td class="lt-white bgr-white">MOSI</td>
      <td class="lt-yellow bgr-yellow">CLK</td>
      <td class="lt-black bgr-black">MISO</td>
      <td class="lt-green bgr-green">CS</td>
      <td class="lt-gray bgr-gray">-</td>
    <tr>
  </tbody>
</table>
</div>
<table>
<thead>
<tr>
<th>Pin Name</th>
<th>Description (Buzzpirat is the master)</th>
</tr>
</thead>
<tbody>
<tr>
<td>MOSI</td>
<td>Master data out, slave in (SPI, JTAG), Serial data (1-Wire, I2C, KB), TX* (UART)</td>
</tr>
<tr>
<td>CLK</td>
<td>Clock signal (I2C, SPI, JTAG, KB)</td>
</tr>
<tr>
<td>MISO</td>
<td>Master data in, slave out (SPI, JTAG) RX (UART)</td>
</tr>
<tr>
<td>CS</td>
<td>Chip select (SPI), TMS (JTAG)</td>
</tr>
<tr>
<td>AUX</td>
<td>Auxiliary IO, frequency probe, pulse-width modulator</td>
</tr>
<tr>
<td>AUX-R</td>
<td>AUX-R is the AUX signal, but with a variable resistor of 10K+1K before reaching the pin</td>
</tr>
<tr>
<td>ADC</td>
<td>Voltage measurement probe (max 6volts)</td>
</tr>
<tr>
<td>VPU</td>
<td>Voltage input for on-board pull-up resistors (0-5volts).</td>
</tr>
<tr>
<td>TP0</td>
<td>Auxiliary PIN connected to VPU</td>
</tr>
<tr>
<td>+1.8v(SW1V8)</td>
<td>+1.8volt switchable power supply</td>
</tr>
<tr>
<td>+2.5v(SW2V5)</td>
<td>+2.5volt switchable power supply</td>
</tr>
<tr>
<td>+3.3v(SW3V3)</td>
<td>+3.3volt switchable power supply</td>
</tr>
<tr>
<td>+5.0v(SW5V0)</td>
<td>+5volt switchable power supply</td>
</tr>
<tr>
<td>GND</td>
<td>Ground, connect to ground of test circuit</td>
</tr>
</tbody>
</table>


<div class="alert alert-warning" role="alert">
<h4 class="alert-heading">Warning</h4>

    Use short &amp; high-quality USB&amp;Dupont cables. Long or low-quality cables can cause communication issues.

</div>



<div class="alert alert-warning" role="alert">
<h4 class="alert-heading">Warning</h4>

    Use VMs is not recommended, as it can cause communication issues.

</div>


</div>



    
      
  
  
  
  

  
  

  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-e459c51a85b49d14d7b61448e704de0d">2 - How to use</h1>
    <div class="lead">How to use your Buzzpirat mod from dangerousprototypes</div>
	<p>Once you have understood the &lsquo;Getting Started&rsquo; section, here you can delve deeper into the use of Buzzpirat.</p>
<p>The Buzzpirat is controlled by text commands entered through the serial terminal. If the terminal is blank, press enter to show the command prompt. Press &lsquo;?&rsquo;, followed by enter, to show the help menu.</p>
<p>Menus configure various Buzzpirat options like pull-up resistors, terminal speed, data display format (DEC, HEX, BIN), etc. Type the menu command, followed by enter, to display the options.
Syntax is used to interact with a device connected over a bus. Commands are mostly single characters, such as &lsquo;r&rsquo; to read a byte. Enter up to 4000 characters of syntax, press enter to execute the sequence.</p>
<p>Most menus have a default option shown in () before the prompt:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>Output type:
</span></span><span style="display:flex;"><span>1. High-Z outputs (H=input, L=GND)
</span></span><span style="display:flex;"><span>2. Normal outputs (H=Vcc, L=GND)
</span></span><span style="display:flex;"><span>(1) &gt; &lt;&lt;&lt; option 1 is the default
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Press enter to select the default option.
</span></span></code></pre></div><nav id="TableOfContents">
  <ul>
    <li><a href="#terminal">Terminal</a></li>
    <li><a href="#configuration-commands">Configuration commands</a>
      <ul>
        <li><a href="#-help-menu-with-latest-menu-and-syntax-options">&lsquo;?&rsquo; Help menu with latest menu and syntax options</a></li>
        <li><a href="#i-hardware-firmware-microcontroller-version-information">&lsquo;i&rsquo; Hardware, firmware, microcontroller version information</a></li>
        <li><a href="#m-set-bus-mode-1-wire-spi-i2c-jtag-uart-etc">&rsquo;m&rsquo; Set bus mode (1-Wire, SPI, I2C, JTAG, UART, etc)</a></li>
        <li><a href="#h-command-history">&lsquo;h&rsquo; Command history</a></li>
        <li><a href="#cc-toggle-aux-control-between-aux-and-cstms-pins">&lsquo;c&rsquo;/&lsquo;C&rsquo; Toggle AUX control between AUX and CS/TMS pins</a></li>
        <li><a href="#ll-set-msblsb-first-in-applicable-modes">&rsquo;l&rsquo;/&lsquo;L&rsquo; Set MSB/LSB first in applicable modes</a></li>
        <li><a href="#o-data-display-format-dec-hex-bin-or-raw">&lsquo;o&rsquo; Data display format (DEC, HEX, BIN, or raw)</a></li>
        <li><a href="#b-set-pc-side-serial-port-speed">&lsquo;b&rsquo; Set PC side serial port speed</a></li>
        <li><a href="#-perform-a-self-test">&lsquo;~&rsquo; Perform a self-test</a></li>
        <li><a href="#-reset">&lsquo;#&rsquo; Reset</a></li>
        <li><a href="#-jump-to-bootloader">&lsquo;$&rsquo; Jump to bootloader</a></li>
      </ul>
    </li>
    <li><a href="#utilities-commands">Utilities commands</a>
      <ul>
        <li><a href="#ww-power-supplies-offon">&lsquo;w&rsquo;/&lsquo;W&rsquo; Power supplies (off/ON)</a></li>
        <li><a href="#v-power-supply-voltage-report">&lsquo;v&rsquo; Power supply voltage report</a></li>
        <li><a href="#pp-pull-up-resistors">&lsquo;p&rsquo;/&lsquo;P&rsquo; Pull-up resistors</a></li>
        <li><a href="#f-measure-frequency-on-the-aux-pin">&lsquo;f&rsquo; Measure frequency on the AUX pin</a></li>
        <li><a href="#g-frequency-generatorpwm-on-the-aux-pin">&lsquo;g&rsquo; Frequency generator/PWM on the AUX pin</a></li>
        <li><a href="#s-servo">&lsquo;S&rsquo; Servo</a></li>
        <li><a href="#-convert-to-hexdecbin-number-format">&lsquo;=&rsquo; Convert to HEX/DEC/BIN number format</a></li>
        <li><a href="#-reverse-bits-in-byte">&lsquo;|&rsquo; Reverse bits in byte</a></li>
        <li><a href="#s-basic-script-engine">&rsquo;s&rsquo; BASIC script engine</a></li>
        <li><a href="#dd-measure-from-voltage-probe-oncecontinuous">&rsquo;d&rsquo;/&lsquo;D&rsquo; Measure from voltage probe (once/CONTINUOUS)</a></li>
        <li><a href="#aa-control-axillary-pin-lowhighread">&lsquo;a&rsquo;/&lsquo;A&rsquo;/&rsquo;@&rsquo; Control axillary pin (low/HIGH/read)</a></li>
      </ul>
    </li>
    <li><a href="#macros-user-macros">Macros, user macros</a>
      <ul>
        <li><a href="#0-list-mode-macros">(0) List mode macros</a></li>
        <li><a href="#-run-macro">(#) Run macro</a></li>
        <li><a href="#x--assign-user-macro">&lt;x= &gt; Assign user macro</a></li>
        <li><a href="#0-list-user-macros">&lt;0&gt; List user macros</a></li>
        <li><a href="#-run-user-macro">&lt;#&gt; Run user macro</a></li>
      </ul>
    </li>
    <li><a href="#bitwise-bus-commands">Bitwise bus commands</a>
      <ul>
        <li><a href="#-send-one-clock-tick">&lsquo;^&rsquo; Send one clock tick</a></li>
        <li><a href="#-or--toggle-clock-level-high--and-low-">&lsquo;/&rsquo; or &lsquo;\&rsquo; Toggle clock level high (/) and low (\)</a></li>
        <li><a href="#--or-95-toggle-data-state-high---and-low-95">&lsquo;-&rsquo; or &lsquo;_&rsquo; Toggle data state high (-) and low (&rsquo;_&rsquo;)</a></li>
        <li><a href="#-read-one-bit-with-clock">&lsquo;!&rsquo; Read one bit with clock</a></li>
        <li><a href="#-read-data-pin-state-no-clock">&lsquo;.&rsquo; Read data pin state (no clock)</a></li>
      </ul>
    </li>
    <li><a href="#bus-interaction-commands">Bus interaction commands</a>
      <ul>
        <li><a href="#123-or-91-bus-start-condition">&lsquo;{&rsquo; or &lsquo;[&rsquo; Bus start condition</a></li>
        <li><a href="#-or--bus-stop-condition">&lsquo;]&rsquo; or &lsquo;}&rsquo; Bus stop condition</a></li>
        <li><a href="#r-read-byte">&lsquo;r&rsquo; Read byte</a></li>
        <li><a href="#0b01-write-this-binary-value">0b01 Write this binary value</a></li>
        <li><a href="#0x01-write-this-hex-value">0x01 Write this HEX value</a></li>
        <li><a href="#0-255-write-this-decimal-value">0-255 Write this decimal value</a></li>
        <li><a href="#abc-write-this-ascii-string">&ldquo;abc&rdquo; Write this ASCII string</a></li>
        <li><a href="#--space-value-delimiter">&rsquo; &rsquo; (space), Value delimiter</a></li>
        <li><a href="#-delay-1usms">&lsquo;&amp;&rsquo;/&rsquo;%&rsquo; Delay 1uS/MS</a></li>
        <li><a href="#-repeat-eg-r10">&lsquo;:&rsquo; Repeat (e.g. r:10)</a></li>
        <li><a href="#-partial-16-bit-readwrite-eg-0x553">&lsquo;;&rsquo; Partial (&lt;16 bit) read/write (e.g. 0x55;3)</a></li>
      </ul>
    </li>
    <li><a href="#1-wire">1-Wire</a>
      <ul>
        <li><a href="#syntax">Syntax</a></li>
        <li><a href="#macro">Macro</a></li>
      </ul>
    </li>
    <li><a href="#uart">UART</a>
      <ul>
        <li><a href="#configuration-options">Configuration options</a></li>
        <li><a href="#syntax-1">Syntax</a></li>
        <li><a href="#r-read-a-byte">&lsquo;r&rsquo; read a byte</a></li>
        <li><a href="#parity-and-framing-errors">Parity and framing errors</a></li>
        <li><a href="#buffer-overrun-errors">Buffer overrun errors</a></li>
        <li><a href="#custom-baud-rate">Custom baud rate</a></li>
        <li><a href="#macros">Macros</a></li>
        <li><a href="#midi">MIDI</a></li>
        <li><a href="#connections">Connections</a></li>
      </ul>
    </li>
    <li><a href="#i2c">I2C</a>
      <ul>
        <li><a href="#configuration-options-1">Configuration options</a></li>
        <li><a href="#syntax-2">Syntax</a></li>
        <li><a href="#macro-1">Macro</a></li>
        <li><a href="#acknack-management">ACK/NACK management</a></li>
        <li><a href="#connections-1">Connections</a></li>
      </ul>
    </li>
    <li><a href="#spi">SPI</a>
      <ul>
        <li><a href="#configuration-options-2">Configuration options</a></li>
        <li><a href="#syntax-3">Syntax</a></li>
        <li><a href="#macro-2">Macro</a></li>
        <li><a href="#spi-bus-sniffer">SPI Bus sniffer</a></li>
        <li><a href="#clock-edgeclock-polaritysample-phase-macros">Clock edge/clock polarity/sample phase macros</a></li>
        <li><a href="#connections-2">Connections</a></li>
      </ul>
    </li>
    <li><a href="#raw-2-wire">Raw 2-wire</a>
      <ul>
        <li><a href="#configuration-options-3">Configuration options</a></li>
        <li><a href="#syntax-4">Syntax</a></li>
        <li><a href="#macro-3">Macro</a></li>
        <li><a href="#connections-3">Connections</a></li>
      </ul>
    </li>
    <li><a href="#raw-3-wire">Raw 3-wire</a>
      <ul>
        <li><a href="#configuration-options-4">Configuration options</a></li>
        <li><a href="#syntax-5">Syntax</a></li>
        <li><a href="#connections-4">Connections</a></li>
      </ul>
    </li>
    <li><a href="#hd44780-lcds">HD44780 LCDs</a>
      <ul>
        <li><a href="#syntax-6">Syntax</a></li>
        <li><a href="#macro-4">Macro</a></li>
      </ul>
    </li>
    <li><a href="#pc-keyboard">PC keyboard</a>
      <ul>
        <li><a href="#syntax-7">Syntax</a></li>
        <li><a href="#macro-5">Macro</a></li>
      </ul>
    </li>
    <li><a href="#dio">DIO</a></li>
    <li><a href="#basic-script-reference">BASIC script reference</a>
      <ul>
        <li><a href="#new">NEW</a></li>
        <li><a href="#list">LIST</a></li>
        <li><a href="#run">RUN</a></li>
        <li><a href="#variables">Variables</a></li>
        <li><a href="#let">LET</a></li>
        <li><a href="#if-ifstat-then-truestat-else-falsestat">IF {ifstat} THEN {truestat} ELSE {falsestat}</a></li>
        <li><a href="#goto-line">GOTO {line}</a></li>
        <li><a href="#gosub-line-and-return">GOSUB {line} and RETURN</a></li>
        <li><a href="#rem-text">REM {text}</a></li>
        <li><a href="#print-text">PRINT {text}</a></li>
        <li><a href="#input-questionvar">INPUT {question},{var}</a></li>
        <li><a href="#for-varminvalue-to-maxvalue-stats-next-var">FOR {var}={minvalue} TO {maxvalue} {stats} NEXT {var}</a></li>
        <li><a href="#read-var--data-val1-val2--val1-val2">READ {var} &amp; DATA {val1}, {val2}, .. {val1}, {val2},</a></li>
        <li><a href="#start">START</a></li>
        <li><a href="#stop">STOP</a></li>
        <li><a href="#startr">STARTR</a></li>
        <li><a href="#stopr">STOPR</a></li>
        <li><a href="#send-valvar">SEND {val/var}</a></li>
        <li><a href="#receive">RECEIVE</a></li>
        <li><a href="#clk-val">CLK {val}</a></li>
        <li><a href="#dat-val">DAT {val}</a></li>
        <li><a href="#bitread">BITREAD</a></li>
        <li><a href="#adc">ADC</a></li>
        <li><a href="#aux-val">AUX {val}</a></li>
        <li><a href="#auxpin-val">AUXPIN {val}</a></li>
        <li><a href="#psu-val">PSU {val}</a></li>
        <li><a href="#pullup-val">PULLUP {val}</a></li>
        <li><a href="#delay-var">DELAY {var}</a></li>
        <li><a href="#freq-var--duty-var">FREQ {var} &amp; DUTY {var}</a></li>
      </ul>
    </li>
  </ul>
</nav>

<h2 id="terminal">Terminal</h2>
<p>Talk to the Buzzpirat from a serial terminal set to 115200bps, 8/N/1</p>
<p>The Buzzpirat understands some VT-100 (ANSI C0) terminal emulation.</p>
<table>
<thead>
<tr>
<th>Keyboard Key</th>
<th>Ctrl-Key</th>
<th>Action</th>
</tr>
</thead>
<tbody>
<tr>
<td>[left arrow]</td>
<td>^B</td>
<td>Moves the cursor left one character</td>
</tr>
<tr>
<td>[right arrow]</td>
<td>^F</td>
<td>Moves the cursor right one character</td>
</tr>
<tr>
<td>[up arrow]</td>
<td>^P</td>
<td>Copies the previous command in the command history buffer to the command line</td>
</tr>
<tr>
<td>[down arrow]</td>
<td>^N</td>
<td>Copies the next command in the command history buffer to the command line</td>
</tr>
<tr>
<td></td>
<td>^A</td>
<td>Moves the cursor to the beginning of the line</td>
</tr>
<tr>
<td></td>
<td>^E</td>
<td>Moves the cursor to the end of the line</td>
</tr>
<tr>
<td>[backspace]</td>
<td>^H</td>
<td>Erases the character to the left of the cursor and moves the cursor left one character</td>
</tr>
<tr>
<td>[delete]</td>
<td>^D</td>
<td>Erases the character under (or to the right of) the cursor and moves the cursor left one character</td>
</tr>
</tbody>
</table>
<h2 id="configuration-commands">Configuration commands</h2>
<h3 id="-help-menu-with-latest-menu-and-syntax-options">&lsquo;?&rsquo; Help menu with latest menu and syntax options</h3>
<p>Print a help screen with all available menu and syntax options in the current firmware and hardware.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>HiZ&gt;?
</span></span><span style="display:flex;"><span> General                                        Protocol interaction
</span></span><span style="display:flex;"><span> ---------------------------------------------------------------------------
</span></span><span style="display:flex;"><span> ?      This help                       (0)     List current macros
</span></span><span style="display:flex;"><span> =X/|X  Converts X/reverse X            (x)     Macro x
</span></span><span style="display:flex;"><span> ~      Selftest                        [       Start
</span></span><span style="display:flex;"><span> #      Reset the BP                    ]       Stop
</span></span><span style="display:flex;"><span> $      Jump to bootloader              {       Start with read
</span></span><span style="display:flex;"><span> &amp;/%    Delay 1 us/ms                   }       Stop
</span></span><span style="display:flex;"><span> a/A/@  AUXPIN (low/HI/READ)            &#34;abc&#34;   Send string
</span></span><span style="display:flex;"><span> b      Set baudrate                    123
</span></span><span style="display:flex;"><span> c/C    AUX assignment (aux/CS)         0x123
</span></span><span style="display:flex;"><span> d/D    Measure ADC (once/CONT.)        0b110   Send value
</span></span><span style="display:flex;"><span> f      Measure frequency               r       Read
</span></span><span style="display:flex;"><span> g/S    Generate PWM/Servo              /       CLK hi
</span></span><span style="display:flex;"><span> h      Commandhistory                  \       CLK lo
</span></span><span style="display:flex;"><span> i      Versioninfo/statusinfo          ^       CLK tick
</span></span><span style="display:flex;"><span> l/L    Bitorder (msb/LSB)              -       DAT hi
</span></span><span style="display:flex;"><span> m      Change mode                     _       DAT lo
</span></span><span style="display:flex;"><span> o      Set output type                 .       DAT read
</span></span><span style="display:flex;"><span> p/P    Pullup resistors (off/ON)       !       Bit read
</span></span><span style="display:flex;"><span> s      Script engine                   :       Repeat e.g. r:10
</span></span><span style="display:flex;"><span> v      Show volts/states               .       Bits to read/write e.g. 0x55.2
</span></span><span style="display:flex;"><span> w/W    PSU (off/ON)            &lt;x&gt;/&lt;x= &gt;/&lt;0&gt;   Usermacro x/assign x/list all
</span></span><span style="display:flex;"><span> e/E    TP0 (input-low+READ/output-low) (TP0 is connected to VPU)
</span></span><span style="display:flex;"><span>HiZ&gt;
</span></span></code></pre></div><h3 id="i-hardware-firmware-microcontroller-version-information">&lsquo;i&rsquo; Hardware, firmware, microcontroller version information</h3>
<p>The information menu displays the hardware, firmware, and microcontroller version.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>HiZ&gt; i
</span></span><span style="display:flex;"><span>Buzzpirat v3.5 &lt;&lt;&lt;hardware version
</span></span><span style="display:flex;"><span>Community Firmware v7.1 - buzzpirat.com by Dreg LASTDEV [HiZ 1-WIRE UART I2C SPI 2WIRE 3WIRE KEYB LCD PIC DIO] Bootloader v4.5 &lt;&lt;&lt;firmware and bootloader version, project webpage
</span></span><span style="display:flex;"><span>DEVID:0x0447 REVID:0x3046 (24FJ64GA00 2 B8) &lt;&lt;&lt;PIC device ID and revision
</span></span><span style="display:flex;"><span>http://dangerousprototypes.com &lt;&lt;&lt;dangerousprototypes webpage
</span></span></code></pre></div><p>HiZ&gt;</p>
<p>If a bus mode is configured additional information about the configuration options is printed.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>*----------*
</span></span><span style="display:flex;"><span>POWER SUPPLIES OFF
</span></span><span style="display:flex;"><span>Voltage monitors: 5V: 0.0 | 3.3V: 0.0 | VPULLUP: 0.0 |
</span></span><span style="display:flex;"><span>a/A/@ controls AUX pin
</span></span><span style="display:flex;"><span>Normal outputs (H=V+, L=GND)
</span></span><span style="display:flex;"><span>Pull-up resistors ON
</span></span><span style="display:flex;"><span>MSB set: MOST sig bit first
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>* ----------*
</span></span><span style="display:flex;"><span>RAW2WIRE&gt;
</span></span></code></pre></div><h3 id="m-set-bus-mode-1-wire-spi-i2c-jtag-uart-etc">&rsquo;m&rsquo; Set bus mode (1-Wire, SPI, I2C, JTAG, UART, etc)</h3>
<p>Select a bus mode. The command resets the Buzzpirat and immediately disables all pins, pull-up resistors, and power supplies.</p>
<p>The default mode is HiZ, a safe mode with all pins set to high-impedance and all peripherals disabled.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>HiZ&gt;m
</span></span><span style="display:flex;"><span>1. HiZ
</span></span><span style="display:flex;"><span>2. 1-WIRE
</span></span><span style="display:flex;"><span>3. UART
</span></span><span style="display:flex;"><span>4. I2C
</span></span><span style="display:flex;"><span>5. SPI
</span></span><span style="display:flex;"><span>6. 2WIRE
</span></span><span style="display:flex;"><span>7. 3WIRE
</span></span><span style="display:flex;"><span>8. KEYB
</span></span><span style="display:flex;"><span>9. LCD
</span></span><span style="display:flex;"><span>10. PIC
</span></span><span style="display:flex;"><span>11. DIO
</span></span><span style="display:flex;"><span>x. exit(without change)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(1)&gt;
</span></span></code></pre></div><h3 id="h-command-history">&lsquo;h&rsquo; Command history</h3>
<p>The previous 10 commands can be replayed from the command history menu.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>SPI&gt; h
</span></span><span style="display:flex;"><span>1. h
</span></span><span style="display:flex;"><span>2. [10 r:3]
</span></span><span style="display:flex;"><span>3. m
</span></span><span style="display:flex;"><span>4. i
</span></span><span style="display:flex;"><span>x. exit
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(0)&gt; 2 &lt;&lt;&lt;replay #2
</span></span><span style="display:flex;"><span>CS ENABLED
</span></span><span style="display:flex;"><span>WRITE: 0x0A
</span></span><span style="display:flex;"><span>READ: 0x00 0x00 0x00
</span></span><span style="display:flex;"><span>CS DISABLED
</span></span><span style="display:flex;"><span>SPI&gt;
</span></span></code></pre></div><h3 id="cc-toggle-aux-control-between-aux-and-cstms-pins">&lsquo;c&rsquo;/&lsquo;C&rsquo; Toggle AUX control between AUX and CS/TMS pins</h3>
<p>Sometimes it&rsquo;s useful to control the CS pin from the user terminal. The c/C configures the a/A/@ commands to control the AUX or CS pins.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>3WIRE&gt; c
</span></span><span style="display:flex;"><span>a/A/@ controls AUX pin
</span></span><span style="display:flex;"><span>3WIRE&gt; C
</span></span><span style="display:flex;"><span>a/A/@ controls CS/TMS pin
</span></span><span style="display:flex;"><span>3WIRE&gt;
</span></span></code></pre></div><h3 id="ll-set-msblsb-first-in-applicable-modes">&rsquo;l&rsquo;/&lsquo;L&rsquo; Set MSB/LSB first in applicable modes</h3>
<p>The l/L command determines the bit order for reading and writing bytes in some bus modes. The bitorder command is available in all modes</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>3WIRE&gt; l
</span></span><span style="display:flex;"><span>MSB set: MOST sig bit first
</span></span><span style="display:flex;"><span>3WIRE&gt; L
</span></span><span style="display:flex;"><span>MSB set: LEAST sig bit first
</span></span><span style="display:flex;"><span>3WIRE&gt;
</span></span></code></pre></div><h3 id="o-data-display-format-dec-hex-bin-or-raw">&lsquo;o&rsquo; Data display format (DEC, HEX, BIN, or raw)</h3>
<p>The Buzzpirat can display values as hexadecimal, decimal, binary, and a raw ASCII byte. Change the setting in the data display format menu (o). The default display format is HEX.</p>
<p>The RAW display mode sends values to the terminal as raw byte values without any text conversion. This is useful for ASCII serial interfaces. It can also be used to speed up the display of bus sniffers and other high-speed functions where converting raw bytes to text takes too much time. Adjust the display format in your serial terminal to see the raw values as HEX/DEC/BIN.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>HiZ&gt; o
</span></span><span style="display:flex;"><span>1. HEX
</span></span><span style="display:flex;"><span>2. DEC
</span></span><span style="display:flex;"><span>3. BIN
</span></span><span style="display:flex;"><span>4. RAW
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(1)&gt;
</span></span><span style="display:flex;"><span>Display format set
</span></span><span style="display:flex;"><span>HiZ&gt;
</span></span></code></pre></div><h3 id="b-set-pc-side-serial-port-speed">&lsquo;b&rsquo; Set PC side serial port speed</h3>
<p>Adjust the speed of the serial port facing the computer (and USB-&gt;serial converter chip).</p>
<p>After choosing a speed you must adjust the serial terminal and press space to continue. The Buzzpirat will pause until the space key is pressed to verify that the terminal speed is correct.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>(9)&gt; 10
</span></span><span style="display:flex;"><span>Enter raw value for BRG
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(34)&gt; 34
</span></span><span style="display:flex;"><span>Adjust your terminal
</span></span><span style="display:flex;"><span>Space to continue
</span></span><span style="display:flex;"><span>HiZ&gt;
</span></span></code></pre></div><p>There is an option to set a custom baud rate with a raw BRG value. The value can be calculated according to the datasheet or with a utility (key constants: PIC24, 32MHz/16MIPS, BRGH=1): <a href="https://github.com/therealdreg/buzzpirat/tree/main/bin/picbaud/">https://github.com/therealdreg/buzzpirat/tree/main/bin/picbaud/</a></p>
<p>230400 baud is &lsquo;16&rsquo; (2.2% error)
460800 baud is &lsquo;8&rsquo; (3.3% error)
921600 baud is &lsquo;3&rsquo; (8.51% error)
One thing to note is that on some early PIC revisions (A3) the UART is weird and the exact values won&rsquo;t work. On these chips try a value +/-1.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>HiZ&gt; b
</span></span><span style="display:flex;"><span>Set serial port speed: (bps)
</span></span><span style="display:flex;"><span>1. 300
</span></span><span style="display:flex;"><span>2. 1200
</span></span><span style="display:flex;"><span>3. 2400
</span></span><span style="display:flex;"><span>4. 4800
</span></span><span style="display:flex;"><span>5. 9600
</span></span><span style="display:flex;"><span>6. 19200
</span></span><span style="display:flex;"><span>7. 38400
</span></span><span style="display:flex;"><span>8. 57600
</span></span><span style="display:flex;"><span>9. 115200
</span></span><span style="display:flex;"><span>10. BRG raw value
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(9)&gt;
</span></span><span style="display:flex;"><span>Adjust your terminal
</span></span><span style="display:flex;"><span>Space to continue
</span></span><span style="display:flex;"><span>HiZ&gt;
</span></span></code></pre></div><h3 id="-perform-a-self-test">&lsquo;~&rsquo; Perform a self-test</h3>
<p>Perform a hardware self-test. Requires jumpers between +5 and Vpu, +3.3 and ADC.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>HiZ&gt; ~
</span></span><span style="display:flex;"><span>Disconnect any devices
</span></span><span style="display:flex;"><span>Connect (Vpu to +5V) and (ADC to +3.3V)
</span></span><span style="display:flex;"><span>Space to continue
</span></span></code></pre></div><h3 id="-reset">&lsquo;#&rsquo; Reset</h3>
<p>Reset the Buzzpirat.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>HiZ&gt;#
</span></span><span style="display:flex;"><span>RESET
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Buzzpirat v3.5
</span></span><span style="display:flex;"><span>Community Firmware v7.1 - buzzpirat.com by Dreg LASTDEV [HiZ 1-WIRE UART I2C SPI 2WIRE 3WIRE KEYB LCD PIC DIO] Bootloader v4.5
</span></span><span style="display:flex;"><span>DEVID:0x0447 REVID:0x3046 (24FJ64GA00 2 B8)
</span></span><span style="display:flex;"><span>http://dangerousprototypes.com
</span></span><span style="display:flex;"><span>HiZ&gt;
</span></span></code></pre></div><h3 id="-jump-to-bootloader">&lsquo;$&rsquo; Jump to bootloader</h3>
<p>Bootloader v4.5 will respond with a version string if a key is pressed while it&rsquo;s active.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>HiZ&gt; $
</span></span><span style="display:flex;"><span>Are you sure? y
</span></span><span style="display:flex;"><span>BOOTLOADER
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Enter the bootloader for a firmware update without connecting the PGC and PGD pins. Remember to disconnect your terminal program before the upgrade.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>BL4+BL4+
</span></span></code></pre></div><h2 id="utilities-commands">Utilities commands</h2>
<h3 id="ww-power-supplies-offon">&lsquo;w&rsquo;/&lsquo;W&rsquo; Power supplies (off/ON)</h3>
<p>Toggle the switchable 1.8volt, 2.5volt, 3.3volt and 5.0volt power supplies with the w/W command. Capital &lsquo;W&rsquo; enables the supplies, lowercase &lsquo;w&rsquo; disables them. The power supplies on the Buzzpirat can supply up to 300mA</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>1-WIRE&gt; w
</span></span><span style="display:flex;"><span>POWER SUPPLIES OFF
</span></span><span style="display:flex;"><span>1-WIRE&gt; W
</span></span><span style="display:flex;"><span>POWER SUPPLIES ON
</span></span><span style="display:flex;"><span>1-WIRE&gt;
</span></span></code></pre></div><h3 id="v-power-supply-voltage-report">&lsquo;v&rsquo; Power supply voltage report</h3>
<p>The voltage report shows the current state of all the Buzzpirat pins and peripherals.</p>
<p>The first line is the pin number, according to the silk screen on the v3 PCB, and the wire color. T</p>
<p>The second line is the pin function in the current bus mode. The power supplies (1.8v, 2.5v, 3.3v, 5.0v), ADC, Vpu, and AUX pins are available in all modes. The other four pins will differ depending on the mode. In 1-Wire mode only one pin is used, one wire data (OWD).</p>
<p>The third line shows the current direction of each pin. I is an input pin, O is an output pin, P is a power supply.</p>
<p>The fourth line shows the current state of each pin. A voltage measurement is displayed for analog pins. The current pin reading, H high and L low, is printed for each digital pins.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>I2C&gt;v
</span></span><span style="display:flex;"><span>Pinstates:
</span></span><span style="display:flex;"><span>1.(BR)  2.(RD)  3.(OR)  4.(YW)  5.(GN)  6.(BL)  7.(PU)  8.(GR)  9.(WT)  0.(Blk)
</span></span><span style="display:flex;"><span>GND     3.3V    5.0V    ADC     VPU     AUX     SCL     SDA     -       -
</span></span><span style="display:flex;"><span>P       P       P       I       I       I       I       I       I       I
</span></span><span style="display:flex;"><span>GND     3.31V   4.87V   0.00V   2.44V   L       H       H       H       H
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>1.(BR)  2.(RD)  3.(OR)
</span></span><span style="display:flex;"><span>2.5V    1.8V    TP0
</span></span><span style="display:flex;"><span>P       P       I
</span></span><span style="display:flex;"><span>2.50V   1.79V   H
</span></span><span style="display:flex;"><span>I2C&gt;
</span></span></code></pre></div><h3 id="pp-pull-up-resistors">&lsquo;p&rsquo;/&lsquo;P&rsquo; Pull-up resistors</h3>
<p>p and P toggle the pull-up resistors off and on.</p>
<p>The on-board pull-up resistors must be powered through the Vpullup pin of the IO header. A warning is displayed if there&rsquo;s no voltage on the Vpullup pin. Check the voltage report (&lsquo;v&rsquo;) and verify that Vpu is attached to a power supply. See the practical guide to Buzzpirat pull-up resistors for a simple introduction.</p>
<p>Pull-up resistors are generally used with open collector/open drain bus types. A warning is displayed when the pull-ups are enabled if the Buzzpirat is configured for normal pin output.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>I2C&gt;P
</span></span><span style="display:flex;"><span>Pull-up resistors ON
</span></span><span style="display:flex;"><span>I2C&gt;
</span></span></code></pre></div><h3 id="f-measure-frequency-on-the-aux-pin">&lsquo;f&rsquo; Measure frequency on the AUX pin</h3>
<p>Measures frequency from 0Hz to 40MHz on the AUX pin, the method is an actual 1 second tick count. If the frequency is lower than a few MHz, the Buzzpirat does an &lsquo;autorange&rsquo; and measures the frequency again for an additional second.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>2WIRE&gt; f
</span></span><span style="display:flex;"><span>Frequency on AUX pin: autorange 50,283 Hz
</span></span><span style="display:flex;"><span>2WIRE&gt;
</span></span></code></pre></div><h3 id="g-frequency-generatorpwm-on-the-aux-pin">&lsquo;g&rsquo; Frequency generator/PWM on the AUX pin</h3>
<p>Enable the frequency generator with g, then set frequency and duty cycle. Frequencies from 1kHz to 4MHz are possible. Use g again to disable the PWM.</p>
<p>Note that the resolution at 4MHz is only 1 bit. Anything other than 50% duty cycle will be 100% off or 100% on.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>2WIRE&gt; g
</span></span><span style="display:flex;"><span>1KHz-4,000KHz PWM/frequency generator
</span></span><span style="display:flex;"><span>Frequency in KHz
</span></span><span style="display:flex;"><span>(50)&gt; 2000
</span></span><span style="display:flex;"><span>Duty cycle in %
</span></span><span style="display:flex;"><span>(50)&gt;
</span></span><span style="display:flex;"><span>PWM active
</span></span><span style="display:flex;"><span>2WIRE&gt; g
</span></span><span style="display:flex;"><span>PWM disabled
</span></span><span style="display:flex;"><span>2WIRE&gt;
</span></span></code></pre></div><h3 id="s-servo">&lsquo;S&rsquo; Servo</h3>
<p>S positions the servo arm to the desired angle, 0-180 degrees. The servo value can be updated as needed, press enter or x to exit. Use &lsquo;S&rsquo; or &lsquo;g&rsquo; again to disable the servo.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>1-WIRE&gt;S
</span></span><span style="display:flex;"><span>Position in degrees
</span></span><span style="display:flex;"><span>(90)&gt;20
</span></span><span style="display:flex;"><span>Servo active
</span></span><span style="display:flex;"><span>(x)&gt;100
</span></span><span style="display:flex;"><span>Servo active
</span></span><span style="display:flex;"><span>(x)&gt;30
</span></span><span style="display:flex;"><span>Servo active
</span></span><span style="display:flex;"><span>(x)&gt;
</span></span><span style="display:flex;"><span>1-WIRE&gt;S
</span></span><span style="display:flex;"><span>PWM disabled
</span></span><span style="display:flex;"><span>1-WIRE&gt;S 90 %:5000 S 180
</span></span><span style="display:flex;"><span>Servo active
</span></span><span style="display:flex;"><span>DELAY 5000ms
</span></span><span style="display:flex;"><span>Servo active
</span></span><span style="display:flex;"><span>1-WIRE&gt;
</span></span></code></pre></div>

<div class="alert alert-warning" role="alert">
<h4 class="alert-heading">Warning</h4>

    Some servos draw more current than the Buzzpirat can supply!! Use an external power supply instead.

</div>

<h3 id="-convert-to-hexdecbin-number-format">&lsquo;=&rsquo; Convert to HEX/DEC/BIN number format</h3>
<p>Base conversion command, available in all modes. Press &lsquo;=&rsquo; and enter any byte value to see the HEX/DEC/BIN equivalent. Firmware v2.1+</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>2WIRE&gt; =0b110
</span></span><span style="display:flex;"><span>0x06 = 6 = 0b00000110
</span></span><span style="display:flex;"><span>2WIRE&gt; =0xa
</span></span><span style="display:flex;"><span>0x0A = 10 = 0b00001010
</span></span><span style="display:flex;"><span>2WIRE&gt; =12
</span></span><span style="display:flex;"><span>0x0C = 12 = 0b00001100
</span></span><span style="display:flex;"><span>2WIRE&gt;
</span></span></code></pre></div><h3 id="-reverse-bits-in-byte">&lsquo;|&rsquo; Reverse bits in byte</h3>
<p>Reverse bit order in byte X. Displays the HEX/DEC/BIN value of the reversed byte.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>I2C&gt; |0b10101010
</span></span><span style="display:flex;"><span>0x55 = 85 = 0b01010101
</span></span><span style="display:flex;"><span>I2C&gt; |0b10000000
</span></span><span style="display:flex;"><span>0x01 = 1 = 0b00000001
</span></span><span style="display:flex;"><span>I2C&gt; |1
</span></span><span style="display:flex;"><span>0x80 = 128 = 0b10000000
</span></span><span style="display:flex;"><span>I2C&gt;
</span></span></code></pre></div><h3 id="s-basic-script-engine">&rsquo;s&rsquo; BASIC script engine</h3>
<p>Simple BASIC scripts can automate repetitive and tedious tasks.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>2WIRE&gt; s
</span></span><span style="display:flex;"><span>2WIRE(BASIC)&gt; list
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>65535 bytes.
</span></span><span style="display:flex;"><span>Ready.
</span></span><span style="display:flex;"><span>2WIRE(BASIC)&gt;
</span></span></code></pre></div><h3 id="dd-measure-from-voltage-probe-oncecontinuous">&rsquo;d&rsquo;/&lsquo;D&rsquo; Measure from voltage probe (once/CONTINUOUS)</h3>
<p>A lowercase d takes a measurement from the voltage measurement probe (ADC pin on the IO header).</p>
<p>A capital D takes continuous measurements from the voltage probe, press any key to exit.</p>
<p>The Buzzpirat voltage probe can measure up to 6.0volts (max 6.6volts, but with some margin for error).</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>HiZ&gt; d
</span></span><span style="display:flex;"><span>VOLTAGE PROBE: 3.31V
</span></span><span style="display:flex;"><span>HiZ&gt; D
</span></span><span style="display:flex;"><span>VOLTMETER MODE
</span></span><span style="display:flex;"><span>Any key to exit
</span></span><span style="display:flex;"><span>VOLTAGE PROBE: 3.30V
</span></span></code></pre></div><h3 id="aa-control-axillary-pin-lowhighread">&lsquo;a&rsquo;/&lsquo;A&rsquo;/&rsquo;@&rsquo; Control axillary pin (low/HIGH/read)</h3>
<p>The axillary pin is a general purpose digital pin that can be controlled from the Buzzpirat terminal. Capital A makes it a 3.3volt output (25mA max). Lowercase a makes it sink to ground (25mA max). @ makes in an input and reads the current state (5volt maximum input).</p>
<p>a/A/@ can also be used to control the CS pin using the &lsquo;c&rsquo;/&lsquo;C&rsquo; commands.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>UART&gt; A
</span></span><span style="display:flex;"><span>AUX HIGH
</span></span><span style="display:flex;"><span>UART&gt; a
</span></span><span style="display:flex;"><span>AUX LOW
</span></span><span style="display:flex;"><span>UART&gt; @
</span></span><span style="display:flex;"><span>AUX INPUT/HI-Z, READ: 0
</span></span><span style="display:flex;"><span>UART&gt;
</span></span></code></pre></div><h2 id="macros-user-macros">Macros, user macros</h2>
<p>Macros perform complex actions, like scanning for I2C addresses, interrogating a smart card, or probing a JTAG chain. Macros are numbers entered inside (). Macro (0) always displays a list of macros available in the current bus mode.</p>
<h3 id="0-list-mode-macros">(0) List mode macros</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>I2C&gt; (0)
</span></span><span style="display:flex;"><span>0.Macro menu
</span></span><span style="display:flex;"><span>1.7bit address search
</span></span><span style="display:flex;"><span>2.I2C sniffer
</span></span><span style="display:flex;"><span>I2C&gt;
</span></span></code></pre></div><p>Macro (0) always displays a list of macros available in the current bus mode.</p>
<h3 id="-run-macro">(#) Run macro</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>I2C&gt;(1)&lt;&lt;&lt;I2C search macro
</span></span><span style="display:flex;"><span>Searching 7bit I2C address space.
</span></span><span style="display:flex;"><span>Found devices at:
</span></span><span style="display:flex;"><span>0xA0(0x50 W) 0xA1(0x50 R)
</span></span><span style="display:flex;"><span>I2C&gt;
</span></span></code></pre></div><p>Execute a macro by typing the macro number between ().</p>
<h3 id="x--assign-user-macro">&lt;x= &gt; Assign user macro</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>I2C&gt; &lt;1=[0xa1 r:8]&gt;
</span></span><span style="display:flex;"><span>I2C&gt;
</span></span></code></pre></div><p>5 user macros can be stored to automate common commands. Each position can store 32 chars (including space).</p>
<h3 id="0-list-user-macros">&lt;0&gt; List user macros</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>I2C&gt; &lt;0&gt;
</span></span><span style="display:flex;"><span>1. &lt;[0xa1 r:8]&gt;
</span></span><span style="display:flex;"><span>2. &lt;&gt;
</span></span><span style="display:flex;"><span>3. &lt;&gt;
</span></span><span style="display:flex;"><span>4. &lt;&gt;
</span></span><span style="display:flex;"><span>5. &lt;&gt;
</span></span><span style="display:flex;"><span>I2C&gt;
</span></span></code></pre></div><p>User macro &lt;0&gt; lists the currently stored use macros.</p>
<h3 id="-run-user-macro">&lt;#&gt; Run user macro</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>I2C&gt; &lt;1&gt;
</span></span><span style="display:flex;"><span>I2C&gt; [0xa1 r:8]
</span></span></code></pre></div><p>Enter the macro number to recall the command. Press enter to execute.</p>
<h2 id="bitwise-bus-commands">Bitwise bus commands</h2>
<p>Bitwise commands are only available in certain bus modes.</p>
<h3 id="-send-one-clock-tick">&lsquo;^&rsquo; Send one clock tick</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>2WIRE&gt; ^
</span></span><span style="display:flex;"><span>CLOCK TICK
</span></span><span style="display:flex;"><span>2WIRE&gt;
</span></span></code></pre></div><p>Send one clock tick. ^:1…255 for multiple clock ticks.</p>
<h3 id="-or--toggle-clock-level-high--and-low-">&lsquo;/&rsquo; or &lsquo;\&rsquo; Toggle clock level high (/) and low (\)</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>2WIRE&gt; /\
</span></span><span style="display:flex;"><span>CLOCK, 1
</span></span><span style="display:flex;"><span>CLOCK, 0
</span></span><span style="display:flex;"><span>2WIRE&gt;
</span></span></code></pre></div><p>Set the clock signal high or low. Includes clock delay.</p>
<h3 id="--or-95-toggle-data-state-high---and-low-95">&lsquo;-&rsquo; or &lsquo;_&rsquo; Toggle data state high (-) and low (&rsquo;_&rsquo;)</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>2WIRE&gt; -_
</span></span><span style="display:flex;"><span>DATA OUTPUT, 1
</span></span><span style="display:flex;"><span>DATA OUTPUT, 0
</span></span><span style="display:flex;"><span>2WIRE&gt;
</span></span></code></pre></div><p>Set the data signal high or low. Includes data setup delay</p>
<h3 id="-read-one-bit-with-clock">&lsquo;!&rsquo; Read one bit with clock</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>2WIRE&gt; !
</span></span><span style="display:flex;"><span>READ BIT:
</span></span><span style="display:flex;"><span>0 *pin is now HiZ
</span></span><span style="display:flex;"><span>2WIRE&gt;
</span></span></code></pre></div><p>Send one clock tick and read one bit from the bus.</p>
<p>On a bus with a bi-directional data line (raw2wire, 1-Wire), the data pin is left as a high-impedance input after this command.</p>
<h3 id="-read-data-pin-state-no-clock">&lsquo;.&rsquo; Read data pin state (no clock)</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>2WIRE&gt; .
</span></span><span style="display:flex;"><span>0 *pin is now HiZ
</span></span><span style="display:flex;"><span>2WIRE&gt;
</span></span></code></pre></div><p>Make the data pin an input and read, but do not send a clock. This can be used as /.\ to achieve the same thing as the ! command.</p>
<p>On a bus with a bi-directional data line (raw2wire, 1-wire), the data pin is left as a high-impedance input after this command.</p>
<h2 id="bus-interaction-commands">Bus interaction commands</h2>
<p>These commands actually manipulate the bus and interacts with chips. These commands have the same general function in each bus mode, such as &lsquo;r&rsquo; to read a byte of data. See the individual bus mode guides for each protocol.</p>
<h3 id="123-or-91-bus-start-condition">&lsquo;{&rsquo; or &lsquo;[&rsquo; Bus start condition</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>I2C&gt; [
</span></span><span style="display:flex;"><span>I2C START BIT
</span></span><span style="display:flex;"><span>I2C&gt;
</span></span></code></pre></div><p>This command generally starts bus activity. In various modes it starts (I2C), selects (SPI), resets (1-wire), or opens (UART).</p>
<h3 id="-or--bus-stop-condition">&lsquo;]&rsquo; or &lsquo;}&rsquo; Bus stop condition</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>SPI&gt; ]
</span></span><span style="display:flex;"><span>CS DISABLED
</span></span><span style="display:flex;"><span>SPI&gt;
</span></span></code></pre></div><p>This command generally stops bus activity. In various modes it stops (I2C), deselects (SPI), or closes (UART).</p>
<h3 id="r-read-byte">&lsquo;r&rsquo; Read byte</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>I2C&gt; r
</span></span><span style="display:flex;"><span>READ: 0x00
</span></span><span style="display:flex;"><span>I2C&gt; r:3
</span></span><span style="display:flex;"><span>READ: ACK 0x00 ACK 0x00 ACK 0x00
</span></span><span style="display:flex;"><span>I2C&gt;
</span></span></code></pre></div><p>r reads a byte from the bus. Use with the repeat command (r:1…255) for bulk reads.</p>
<h3 id="0b01-write-this-binary-value">0b01 Write this binary value</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>I2C&gt; 0b1001
</span></span><span style="display:flex;"><span>WRITE: 0x09 ACK
</span></span><span style="display:flex;"><span>I2C&gt; 0b1001:2
</span></span><span style="display:flex;"><span>WRITE: 0x09 ACK 0x09 ACK
</span></span><span style="display:flex;"><span>I2C&gt;
</span></span></code></pre></div><p>Enter a binary value to write it to the bus.</p>
<p>Binary values are commonly used in electronics because the 1&rsquo;s and 0&rsquo;s correspond to register &lsquo;switches&rsquo; that control various aspects of a device. Enter a binary number as 0b and then the bits. Padding 0&rsquo;s are not required, 0b00000001=0b1. Can be used with the repeat command.</p>
<h3 id="0x01-write-this-hex-value">0x01 Write this HEX value</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>SPI&gt; 0x15
</span></span><span style="display:flex;"><span>WRITE: 0x15
</span></span><span style="display:flex;"><span>SPI&gt; 0xfa:5
</span></span><span style="display:flex;"><span>WRITE: 0xFA 0xFA 0xFA 0xFA 0xFA
</span></span><span style="display:flex;"><span>SPI&gt;
</span></span></code></pre></div><p>Enter a HEX value to write it to the bus.</p>
<p>Hexadecimal values are base 16 numbers that use a-f for the numbers 10-15, this format is very common in computers and electronics. Enter HEX values as shown above, precede the value with 0x or 0h. Single digit numbers don&rsquo;t need 0 padding, 0x01 and 0x1 are interpreted the same. A-F can be lower-case or capital letters.</p>
<h3 id="0-255-write-this-decimal-value">0-255 Write this decimal value</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>SPI&gt; 18
</span></span><span style="display:flex;"><span>WRITE: 0x12
</span></span><span style="display:flex;"><span>SPI&gt; 13:5
</span></span><span style="display:flex;"><span>WRITE: 0x0D 0x0D 0x0D 0x0D 0x0D
</span></span><span style="display:flex;"><span>SPI&gt;
</span></span></code></pre></div><p>Any number not preceded by 0x, 0h, or 0b is interpreted as a decimal value and sent to the bus.</p>
<p>Decimal values are common base 10 numbers. Just enter the value, no special designator is required.</p>
<h3 id="abc-write-this-ascii-string">&ldquo;abc&rdquo; Write this ASCII string</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>SPI&gt; &#34;abcd&#34;
</span></span><span style="display:flex;"><span>WRITE: &#34;abcd&#34;
</span></span><span style="display:flex;"><span>SPI&gt;
</span></span></code></pre></div><p>The ASCII values enclosed in &quot;&quot; are sent to the bus.</p>
<h3 id="--space-value-delimiter">&rsquo; &rsquo; (space), Value delimiter</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>SPI&gt; [1 2,3rr]
</span></span><span style="display:flex;"><span>CS ENABLED
</span></span><span style="display:flex;"><span>WRITE: 0x01
</span></span><span style="display:flex;"><span>WRITE: 0x02
</span></span><span style="display:flex;"><span>WRITE: 0x03
</span></span><span style="display:flex;"><span>READ: 0x0A
</span></span><span style="display:flex;"><span>READ: 0x0A
</span></span><span style="display:flex;"><span>CS DISABLED
</span></span><span style="display:flex;"><span>SPI&gt;
</span></span></code></pre></div><p>Use a coma or space to separate numbers. Any combination is fine, no delimiter is required between non-number values.</p>
<h3 id="-delay-1usms">&lsquo;&amp;&rsquo;/&rsquo;%&rsquo; Delay 1uS/MS</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>SPI&gt; &amp;
</span></span><span style="display:flex;"><span>DELAY 1us
</span></span><span style="display:flex;"><span>SPI&gt; &amp;:10
</span></span><span style="display:flex;"><span>DELAY 10us
</span></span><span style="display:flex;"><span>SPI&gt; %
</span></span><span style="display:flex;"><span>DELAY 1ms
</span></span><span style="display:flex;"><span>SPI&gt; %:10
</span></span><span style="display:flex;"><span>DELAY 10ms
</span></span><span style="display:flex;"><span>SPI&gt;
</span></span></code></pre></div><p>&amp; delays 1us, % delays 1ms. Use the repeat command for multiple delays.</p>
<h3 id="-repeat-eg-r10">&lsquo;:&rsquo; Repeat (e.g. r:10)</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>SPI&gt; &amp;:10
</span></span><span style="display:flex;"><span>DELAY 10us
</span></span><span style="display:flex;"><span>SPI&gt; r:0b10
</span></span><span style="display:flex;"><span>READ: 0x00 0x00
</span></span><span style="display:flex;"><span>SPI&gt; 5:0x3
</span></span><span style="display:flex;"><span>WRITE: 0x05 0x05 0x05
</span></span><span style="display:flex;"><span>SPI&gt;
</span></span></code></pre></div><p>Many Buzzpirat commands can be repeated by adding &lsquo;: &rsquo; to a command, followed by the number of times to repeat the command. To read five byte, enter r:5, etc. The repeat values can be HEX/DEC/BIN.</p>
<h3 id="-partial-16-bit-readwrite-eg-0x553">&lsquo;;&rsquo; Partial (&lt;16 bit) read/write (e.g. 0x55;3)</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>2WIRE&gt; 0xaa;4
</span></span><span style="display:flex;"><span>WRITE: 0x0A;4
</span></span></code></pre></div><p>Will write 0x0a (4 bits) to the bus.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>2WIRE&gt; 0xFFFF;12
</span></span><span style="display:flex;"><span>WRITE: 0x0FFF;12
</span></span></code></pre></div><p>Will write 0x0FFF (12 bits) to the bus.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>2WIRE&gt; 0x55:4;2
</span></span><span style="display:flex;"><span>WRITE: 0x01;2 0x01;2 0x1;2 0x01;2
</span></span></code></pre></div><p>Can be combined with the repeat command.</p>
<p>NOTE: works currently only with the raw2wire and raw3wire busses.</p>
<h2 id="1-wire">1-Wire</h2>
<ul>
<li><strong>Bus:</strong> <a href="http://en.wikipedia.org/wiki/1-Wire">1-Wire</a> (Dallas/Maxim 1-Wire protocol).</li>
<li><strong>Connections:</strong> one pin (OWD) and ground.</li>
<li><strong>Output types:</strong> open drain/open collector, pull-up resistor required.</li>
<li><strong>Pull-up resistors:</strong> always required (2K – 10K, 2K or less for parasitic power parts).</li>
<li><strong>Maximum voltage:</strong> 5.5volts (5volt safe).</li>
</ul>
<p>1-Wire uses a single data signal wire. Most devices also require a power and ground connection. Some parts draw power parasitically through the 1-Wire bus and don&rsquo;t require a separate power source.</p>
<h3 id="syntax">Syntax</h3>
<table>
<thead>
<tr>
<th>Command</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>A/a/@</code></td>
<td>Toggle auxiliary pin. Capital “A” sets AUX high, small “a” sets to ground. @ sets aux to input (high impedance mode) and reads the pin value.</td>
</tr>
<tr>
<td><code>D/d</code></td>
<td>Measure voltage on the ADC pin (v1+ hardware only).</td>
</tr>
<tr>
<td><code>W/w</code></td>
<td>Capital ‘W’ enables the on-board power supplies. Small ‘w’ disables them. (v1+ hardware only).</td>
</tr>
<tr>
<td><code>{</code> or <code>[</code></td>
<td>1-Wire bus reset.</td>
</tr>
<tr>
<td><code>]</code> or <code>}</code></td>
<td>–</td>
</tr>
<tr>
<td><code>r</code></td>
<td>Read one byte. (<code>r:1…255</code> for bulk reads)</td>
</tr>
<tr>
<td><code>0b</code></td>
<td>Write this binary value. Format is 0b00000000 for a byte, but partial bytes are also fine: 0b1001.</td>
</tr>
<tr>
<td><code>0x</code></td>
<td>Write this HEX value. Format is 0×01. Partial bytes are fine: 0xA. A-F can be lower-case or capital letters.</td>
</tr>
<tr>
<td><code>0-255</code></td>
<td>Write this decimal value. Any number not preceded by 0x or 0b is interpreted as a decimal value.</td>
</tr>
<tr>
<td><code>,</code></td>
<td>Value delimiter. Use a coma or space to separate numbers. Any combination is fine, no delimiter is required between non-number values: <code>{0xa6,0, 0 16 5 0b111 0xaF}</code>.</td>
</tr>
<tr>
<td><code>&amp;</code></td>
<td>Delay 1uS. (<code>&amp;:1…255</code> for multiple delays)</td>
</tr>
<tr>
<td><code>(#)</code></td>
<td>Run macro, <code>(0)</code> for macro list</td>
</tr>
<tr>
<td><code>Bitwise</code></td>
<td>-</td>
</tr>
<tr>
<td><code>^</code></td>
<td>One clock tick, use data state from previous – or _ operation. (<code>^:1…255</code> for multiple clock ticks)</td>
</tr>
<tr>
<td><code>/</code> or <code>\</code></td>
<td>–</td>
</tr>
<tr>
<td><code>-</code> or <code>_</code></td>
<td>Set the 1-Wire data state to 1 (-) or 0 (_). This will be used on the next ^ command, no actual bus change. (updated in v5.2, this previously set the state and sent a bit)</td>
</tr>
<tr>
<td><code>!</code></td>
<td>Read one bit with clock.</td>
</tr>
<tr>
<td><code>.</code></td>
<td>Read current data state setting from last - or _ command, no actual bus change.</td>
</tr>
</tbody>
</table>
<h3 id="macro">Macro</h3>
<table>
<thead>
<tr>
<th>Command</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>0</code></td>
<td>Macro menu</td>
</tr>
<tr>
<td><code>1-50</code></td>
<td>Reserved for device address shortcuts.</td>
</tr>
<tr>
<td><code>51</code></td>
<td>READ ROM (0×33) *for single device bus</td>
</tr>
<tr>
<td><code>85</code></td>
<td>MATCH ROM (0×55) *followed by 64bit address</td>
</tr>
<tr>
<td><code>204</code></td>
<td>SKIP ROM (0xCC) *followed by command</td>
</tr>
<tr>
<td><code>236</code></td>
<td>ALARM SEARCH (0xEC)</td>
</tr>
<tr>
<td><code>240</code></td>
<td>SEARCH ROM (0xF0)</td>
</tr>
</tbody>
</table>
<p><strong>Notes:</strong></p>
<p>1-Wire specifies a 2K or smaller resistor when working with parasitically powered devices. Since v3a the on-board pull-up resistor on MOSI are 2K. Use an external 2K pull-up resistor if you have a v2go. Parasitically powered parts may appear to work with resistors larger than 2K ohms, but will fail certain operations (like EEPROM writes).</p>
<p>The 1-wire reset command can detect two bus errors. If no 1-wire chips respond to the reset command by pulling the bus low, it will report *No device detected (0x02). If the bus stays low for too long after the reset, because the pull-up resistor isn&rsquo;t working or there&rsquo;s a short circuit, it will report *Short or no pull-up (0x01).</p>
<p>One wire is a time sensitive protocol. There&rsquo;s no actual data wire to set high or low with the - and _ commands, so I just store the desired value and send it with the next clock tick (^).</p>
<p>The _ and - commands just set the data state that will be used on the next clock tick command (^). Example: previously you could write 4 high bits with -^^^, now you must use -^^^^. I feel this is more consistent with the operation of the other modes.</p>
<h2 id="uart">UART</h2>
<ul>
<li><strong>Bus:</strong> <a href="http://en.wikipedia.org/wiki/Serial_uart">UART</a>, <a href="http://en.wikipedia.org/wiki/Musical_Instrument_Digital_Interface">MIDI</a> (universal asynchronous receiver transmitter).</li>
<li><strong>Connections:</strong> two pins (RX/TX) and ground.</li>
<li><strong>Output types:</strong> 3.3volt normal output, or <a href="http://en.wikipedia.org/wiki/High_impedence">open collector</a>  pull-up resistors required.</li>
<li><strong>Pull-up resistors:</strong> required for open collector output mode (2K – 10K).</li>
<li><strong>Maximum Voltage:</strong> 5.5volts (5volt safe).</li>
</ul>
<p>UART is also known as the common PC serial port. The PC serial port operates at full RS232 voltage levels (-13volts to +13volts) which are not compatible with the Buzzpirat.</p>
<h3 id="configuration-options">Configuration options</h3>
<ul>
<li><strong>Speed (bps):</strong> 300, 1200, 2400, 4800, 9600, 19200, 38400, 57600, 115200, 31250, BRG.</li>
<li><strong>Data bits and parity:</strong> 8/none, 8/even, 8/odd, 9/none.</li>
<li><strong>Stop bits:</strong> 1, 2.</li>
<li><strong>Receive polarity:</strong> idle 1, idle 0.</li>
<li><strong>Output type:</strong> open drain/open collector (high=Hi-Z, low=ground), normal (high=3.3volts, low=ground). Use open drain/open collector output types with pull-up resistors for multi-voltage interfacing.</li>
</ul>
<h3 id="syntax-1">Syntax</h3>
<table>
<thead>
<tr>
<th>Command</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>A/a/@</code></td>
<td>Toggle auxiliary pin. Capital “A” sets AUX high, small “a” sets to ground. @ sets aux to input (high impedance mode) and reads the pin value.</td>
</tr>
<tr>
<td><code>D/d</code></td>
<td>Measure voltage on the ADC pin (v1+ hardware only).</td>
</tr>
<tr>
<td><code>W/w</code></td>
<td>Capital ‘W’ enables the on-board power supplies. Small ‘w’ disables them. (v1+ hardware only).</td>
</tr>
<tr>
<td><code>[</code></td>
<td>Open UART, discard received bytes.</td>
</tr>
<tr>
<td><code>{</code></td>
<td>Open UART, display data as it arrives asynchronously.</td>
</tr>
<tr>
<td><code>]</code> or <code>}</code></td>
<td>Close UART.</td>
</tr>
<tr>
<td><code>r</code></td>
<td>Check UART for byte, or fail if empty. Displays framing (-f) and parity (-p) errors (<code>r:1…255</code> for bulk reads)</td>
</tr>
<tr>
<td><code>0b</code></td>
<td>Write this binary value. Format is 0b00000000 for a byte, but partial bytes are also fine: 0b1001.</td>
</tr>
<tr>
<td><code>0x</code></td>
<td>Write this HEX value. Format is 0×01. Partial bytes are fine: 0xA. A-F can be lower-case or capital letters.</td>
</tr>
<tr>
<td><code>0-255</code></td>
<td>Write this decimal value. Any number not preceded by 0x or 0b is interpreted as a decimal value.</td>
</tr>
<tr>
<td><code>,</code></td>
<td>Value delimiter. Use a coma or space to separate numbers. Any combination is fine, no delimiter is required between non-number values: <code>{0xa6,0, 0 16 5 0b111 0xaF}</code>.</td>
</tr>
<tr>
<td><code>&amp;</code></td>
<td>Delay 1uS. (<code>&amp;:1…255</code> for multiple delays)</td>
</tr>
<tr>
<td><code>(#)</code></td>
<td>Run macro, <code>(0)</code> for macro list</td>
</tr>
</tbody>
</table>
<h3 id="r-read-a-byte">&lsquo;r&rsquo; read a byte</h3>
<p>UART mode requires special handling compared to the other Buzzpirat modes because data can arrive at any time. UART mode displays framing and parity errors, and automatically clears buffer overruns.</p>
<h3 id="parity-and-framing-errors">Parity and framing errors</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>READ: -p -f 0×40 &lt;&lt;&lt;-p -f flag set
</span></span></code></pre></div><p>The Buzzpirat reports framing errors (-f) and parity errors (-p) when reading a byte from the UART. It’s unlikely you’ll see these errors unless the UART speed is mismatched with the sender.</p>
<h3 id="buffer-overrun-errors">Buffer overrun errors</h3>
<p>The Buzzpirat hardware has a four-byte UART buffer that holds data until you read it with an ‘r’ command, or until it can be printed to the terminal if live display is enabled with ‘[&rsquo;. After it fills, new data will be lost. This is called a buffer overrun.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>READ: 0x40 *Bytes dropped*&lt;&lt;&lt;bytes dropped error
</span></span></code></pre></div><p>The Buzzpirat detects buffer errors, clears them, and alerts you of dropped bytes. The overrun bit is cleared any time you use the r, {, or [commands. If you close the live UART display (]) and more than 5 bytes come in, the next read command (r) will clear the error and print the <em>bytes dropped</em> warning.</p>
<p>Prevent buffer problems by reducing the amount of data the Buzzpirat transfers over USB for each byte of UART data. Raw display mode reduces the four byte hex value 0×00 to a single raw byte value. A better way is to use macro (1) or (2) to view unformatted UART output, this is a 1:1 transfer of bytes that should work at the highest possible speeds.</p>
<h3 id="custom-baud-rate">Custom baud rate</h3>
<p>A custom baud rate is set with the BRG option. Use a PIC UART calculator to find the correct value.</p>
<p>Set the calculator with the Buzzpirat values: PIC24, 32MHz clock. Enter the desired baud rate and hit calculate. Use the value from the BRGH=1 section. For 9700bps enter 411 at the Buzzpirat BRG prompt.</p>
<h3 id="macros">Macros</h3>
<table>
<thead>
<tr>
<th>Command</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>0</code></td>
<td>Macro menu</td>
</tr>
<tr>
<td><code>1</code></td>
<td>Transparent UART bridge. Reset to exit.</td>
</tr>
<tr>
<td><code>2</code></td>
<td>Live raw UART monitor. Any key exits.</td>
</tr>
<tr>
<td><code>3</code></td>
<td>Transparent UART bridge with flow control.</td>
</tr>
</tbody>
</table>
<h4 id="transparent-uart-bridge">Transparent UART bridge</h4>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>UART&gt;(1)&lt;&lt;&lt;macro 1, transparent UART bridge
</span></span><span style="display:flex;"><span>UART bridge. Space continues, anything else exits.
</span></span><span style="display:flex;"><span>Reset to exit.
</span></span></code></pre></div><p>The transparent UART mode macro (1) creates a simple serial-&gt;USB bridge. The only way to exit this mode is to reset the Buzzpirat hardware.</p>
<p>Buffer overrun errors that occur during bridge mode are automatically cleared so that data continues as normal (firmware v3.0+). The MODE LED will turn off to alert you of the buffer overrun error.</p>
<p>Macro (3) is a second UART bridge mode that includes the CTS and RTS flow control signals. CTS is on the CS pin (PIC input from external circuit is passed to FTDI USB-&gt;serial chip). RTS is on the CLOCK pin (PIC output mirrors output from FTDI chip).</p>
<p>Note that the Buzzpirat serial port UART facing the computer (the one that connects to the USB-&gt;serial converter chip and sends text to your computer) is NOT adjusted to the same speed as the UART bridge. The USB-side serial port UART will continue to operate at the default setting (115200bps) unless adjusted with the &lsquo;b&rsquo; menu.</p>
<p>If you use the UART bridge with a computer program that opens the virtual serial port at a different baud rate, say 9600bps, the exchange will be garbled because the Buzzpirat expects 115200bps input from the computer. Adjust the computer-side serial speed first with the &lsquo;b&rsquo; menu, then start the serial bridge at the desired speed.</p>
<h4 id="live-uart-monitor">Live UART monitor</h4>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>UART&gt;(2)&lt;&lt;&lt;macro 2, UART monitor
</span></span><span style="display:flex;"><span>Raw UART input. Space to exit.
</span></span><span style="display:flex;"><span>UART&gt;
</span></span></code></pre></div><p>The UART monitor macro (2) shows a live display of UART input as raw byte values without any type of formatting. Press any key to exit the live monitor. This mode works best with a terminal that can display raw byte values in a variety of formats.</p>
<p>This macro is like the transparent UART macro (1) but without transmission abilities, and it can be exited with a key press. It’s useful for monitoring high-speed UART input that causes buffer overrun errors in other modes.</p>
<h3 id="midi">MIDI</h3>
<p>MIDI is a command set used by electronic (music) instruments. It travels over a standard serial UART configured for 31250bps/8/n/1. Since firmware v2.7 MIDI is a speed option in the UART library.</p>
<p>MIDI is a ring network, each node has an input and output socket. Each node passes messages to the next in the ring. The input and outputs are opto-isolated. The signaling is at 5volts, 5ma (current-based signaling). An adapter is required.</p>
<h3 id="connections">Connections</h3>
<p>Connect the Buzzpirat transmit pin (TX/MOSI) to the UART device receive pin (RX). Connect the Buzzpirat receive pin (RX/MISO) to the UART device transmit pin (TX).</p>
<p>For macros and modes with flow control: CTS is on the CS pin (PIC input from external circuit is passed to FTDI USB-&gt;serial chip). RTS is on the CLOCK pin (PIC output mirrors output from FTDI chip)</p>
<h2 id="i2c">I2C</h2>
<ul>
<li><strong>Bus:</strong> <a href="http://en.wikipedia.org/wiki/I2c">I2C</a> (eye-squared-see or eye-two-see)</li>
<li><strong>Connections:</strong> two pins (SDA/SCL) and ground</li>
<li><strong>Output types:</strong> <a href="/docs/Pull-up_resistors,_high_impedance_pins,_and_open_collector_buses">open drain/open collector</a></li>
<li><strong>Pull-up resistors:</strong> pull-ups always required (2K - 10K ohms)</li>
<li><strong>Maximum voltage:</strong> 5.5volts (5volt safe)</li>
</ul>
<p>I2C is a common 2-wire bus for low speed interfaces.</p>
<p>I2C implementation does not currently support clock stretching.</p>
<h3 id="configuration-options-1">Configuration options</h3>
<ul>
<li><strong>Speed:</strong> I2C has three speed options:~50kHz, ~100kHz, and ~400kHz.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>HiZ&gt;m&lt;&lt;&lt;open the mode menu
</span></span><span style="display:flex;"><span>1. HiZ
</span></span><span style="display:flex;"><span>…
</span></span><span style="display:flex;"><span>4. I2C
</span></span><span style="display:flex;"><span>…
</span></span><span style="display:flex;"><span>(1) &gt;4&lt;&lt;&lt;choose I2C mode
</span></span><span style="display:flex;"><span>Set speed:
</span></span><span style="display:flex;"><span>1. 50KHz
</span></span><span style="display:flex;"><span>2. 100KHz
</span></span><span style="display:flex;"><span>3. 400kHz
</span></span><span style="display:flex;"><span>(1) &gt;1&lt;&lt;&lt;choose I2C speed
</span></span><span style="display:flex;"><span>I2C READY
</span></span><span style="display:flex;"><span>I2C&gt;
</span></span></code></pre></div><h4 id="pull-up-resistors">Pull-up resistors</h4>
<p>I2C is an open-collector bus, it requires pull-up resistors to hold the clock and data lines high and create the data &lsquo;1&rsquo;. I2C parts don&rsquo;t output high, they only pull low, without pull-up resistors there can never be a &lsquo;1&rsquo;. This will cause common errors such as the I2C address scanner reporting a response at every address. Read more about open drain/open collector bus types, and the Buzzpirat&rsquo;s on-board pull-up resistors.</p>
<p>I2C requires pull-up resistors to hold the clock and data lines high.
I2C parts don&rsquo;t output high, they only pull low.
Without pull-up resistors there can never be a &lsquo;1&rsquo;.</p>
<h3 id="syntax-2">Syntax</h3>
<table>
<thead>
<tr>
<th>Command</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>A/a/@</code></td>
<td>Toggle auxiliary pin. Capital “A” sets AUX high, small “a” sets to ground. @ sets aux to input (high impedance mode) and reads the pin value.</td>
</tr>
<tr>
<td><code>D/d</code></td>
<td>Measure voltage on the ADC pin (v1+ hardware only).</td>
</tr>
<tr>
<td><code>W/w</code></td>
<td>Capital ‘W’ enables the on-board power supplies. Small ‘w’ disables them. (v1+ hardware only).</td>
</tr>
<tr>
<td><code>{</code> or <code>[</code></td>
<td>Issue I2C start condition.</td>
</tr>
<tr>
<td><code>]</code> or <code>}</code></td>
<td>Issue I2C stop condition.</td>
</tr>
<tr>
<td><code>r</code></td>
<td>Read one byte, send ACK. (<code>r:1…255</code> for bulk reads)</td>
</tr>
<tr>
<td><code>0b</code></td>
<td>Write this binary value, check ACK. Format is <code>0b00000000</code> for a byte, but partial bytes are also fine: <code>0b1001</code>.</td>
</tr>
<tr>
<td><code>0x</code></td>
<td>Write this HEX value, check ACK. Format is <code>0×01</code>. Partial bytes are fine: <code>0xA</code>. A-F can be lower-case or capital letters.</td>
</tr>
<tr>
<td><code>0-255</code></td>
<td>Write this decimal value, check ACK. Any number not preceded by <code>0x</code> or <code>0b</code> is interpreted as a decimal value.</td>
</tr>
<tr>
<td><code>,</code></td>
<td>Value delimiter. Use a coma or space to separate numbers. Any combination is fine, no delimiter is required between non-number values: <code>{0xa6,0, 0 16 5 0b111 0xaF}</code>.</td>
</tr>
<tr>
<td><code>&amp;</code></td>
<td>Delay 1uS. (<code>&amp;:1…255</code> for multiple delays)</td>
</tr>
<tr>
<td><code>(#)</code></td>
<td>Run macro, <code>(0)</code> for macro list</td>
</tr>
</tbody>
</table>
<h3 id="macro-1">Macro</h3>
<table>
<thead>
<tr>
<th>Command</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>0</code></td>
<td>Macro menu</td>
</tr>
<tr>
<td><code>1</code></td>
<td>7bit address search. Find all connected devices by brute force.</td>
</tr>
<tr>
<td><code>2</code></td>
<td>I2C snooper (alpha testing, unlisted) v2.1+</td>
</tr>
</tbody>
</table>
<h4 id="i2c-address-search-scanner-macro">I2C address search scanner macro</h4>
<p>You can find the <a href="http://en.wikipedia.org/wiki/I%C2%B2C">I2C</a> address for most I2C-compatible chips in the datasheet. But what if you&rsquo;re working with an unknown chip, a dated chip with no datasheet, or you&rsquo;re just too lazy to look it up?</p>
<p>The Buzzpirat has a built-in address scanner that checks every possible I2C address for a response. This brute force method is a fast and easy way to see if any chips are responding, and to uncover undocumented access addresses.</p>
<p>I2C chips respond to a 7bit address, so up to 128 devices can share the same two communication wires. An additional bit of the address determines if the operation is a write to the chip (0), or a read from the chip (1).</p>
<p>I connected the Buzzpirat to the 3EEPROM explorer board. The 7bit base address for the 24LC/AA I2C EEPROM is 101 0000 (0x50 in HEX). It answers at the write address 1010 0000 (0xA0) and the read address 1010 0001 (0xA1).</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>I2C&gt;(1)
</span></span><span style="display:flex;"><span>Searching 7bit I2C address space.
</span></span><span style="display:flex;"><span>Found devices at:
</span></span><span style="display:flex;"><span>0xA0(0x50 W) 0xA1(0x50 R)
</span></span><span style="display:flex;"><span>I2C&gt;
</span></span></code></pre></div><p>Macro 1 in the I2C library runs the address scanner. The scanner displays the raw addresses the chip acknowledged (0xA0, 0xA1), and the 7bit address equivalent (0x50) with write or read bit indicators (W/R). Datasheets usually list the 7bit address, but the 8bit value is more recognizable on a logic analyzer, snooper, debugger, etc.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>I2C&gt; (1)
</span></span><span style="display:flex;"><span>Searching I2C address space. Found devices at:
</span></span><span style="display:flex;"><span>Warning: *Short or no pull-up
</span></span><span style="display:flex;"><span>I2C&gt;
</span></span></code></pre></div><p>The scanner will find a chip at every address if there&rsquo;s no pull-up resistors on the I2C bus. This is a really common error. the scanner checks for pull-ups, and exits with an error if the bus isn&rsquo;t pulled up.</p>
<h5 id="scanner-details">Scanner details</h5>
<p>Details about the address scanner macro are at the end of this post and around here in the source.</p>
<ul>
<li>
<p>For I2C write addresses: the BP sends a start, the write address, looks for an ACK, then sends a stop.</p>
</li>
<li>
<p>For I2C read addresses: the BP sends a start, the read address, looks for an ACK. If there is an ACK, it reads a byte and NACKs it. Finally it sends a stop.</p>
</li>
</ul>
<p>When the I2C chip responds to the read address, it outputs data and will miss a stop condition sent immediately after the read address (bus contention). If the I2C chip misses the stop condition, the address scanner will see ghost addresses until the read ends randomly. By reading a byte after any read address that ACKs, I have a chance to NACK the read and properly end the I2C transaction.</p>
<h4 id="i2c-bus-sniffer-macro">I2C Bus Sniffer macro</h4>
<p>The I2C sniffer is implemented in software and seems to work up to 100kHz (firmware v5.3+). It’s not a substitute for a proper logic analyzer, but additional improvements are probably possible.</p>
<ul>
<li>[/] – Start/stop bit</li>
<li>+/- – ACK/NACK</li>
</ul>
<p>I2C start and stop bits are represented by the normal Buzzpirat syntax.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>I2C&gt; (2)
</span></span><span style="display:flex;"><span>Sniffer
</span></span><span style="display:flex;"><span>Any key to exit
</span></span><span style="display:flex;"><span>[0x40-][0x40-0x40-0x30-0x56-0x77-]
</span></span><span style="display:flex;"><span>I2C&gt;
</span></span></code></pre></div><p>Sniffed data values are always HEX formatted in user mode. Press any key to exit the sniffer.</p>
<p>Notes The sniffer uses a 4096byte output ring buffer. Sniffer output goes into the ring buffer and gets pushed to the PC when the UART is free. This should eliminate problems with dropped bytes, regardless of UART speed or display mode. A long enough stream of data will eventually overtake the buffer, after which bytes are dropped silently (will be updated after v5.3).</p>
<p>Any commands entered after the sniffer macro will be lost.</p>
<p>Pins that are normally output become inputs in sniffer node. MOSI and CLOCK are inputs in I2C sniffer mode.</p>
<p>The I2C sniffer maximum speed is around 100kHz.</p>
<h3 id="acknack-management">ACK/NACK management</h3>
<p>These examples read and write from the RAM of a DS1307 RTC chip.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>I2C&gt; [0xd1 rrrr]
</span></span><span style="display:flex;"><span>I2C START CONDITION
</span></span><span style="display:flex;"><span>WRITE: 0xD1 GOT ACK: YES&lt;&lt;&lt;read address
</span></span><span style="display:flex;"><span>READ: 0×07 ACK &lt;&lt;&lt;sent ACK[
</span></span><span style="display:flex;"><span>READ: 0x06 ACK
</span></span><span style="display:flex;"><span>READ: 0x05 ACK
</span></span><span style="display:flex;"><span>READ: 0x04 NACK &lt;&lt;&lt;last read before STOP, sent NACK
</span></span><span style="display:flex;"><span>I2C STOP CONDITION
</span></span><span style="display:flex;"><span>I2C&gt;
</span></span></code></pre></div><p>I2C read operations must be ACKed or NACKed by the host (the Buzzpirat). The Buzzpirat automates this, but you should know a few rules about how it works.</p>
<p>The I2C library doesn&rsquo;t ACK/NACK a read operation until the following command. If the next command is a STOP (or START) the Buzzpirat sends a NACK bit. On all other commands it sends an ACK bit. The terminal output displays the (N)ACK status.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>I2C&gt; [0xd1 r:5]
</span></span><span style="display:flex;"><span>I2C START CONDITION
</span></span><span style="display:flex;"><span>WRITE: 0xD1 GOT ACK: YES
</span></span><span style="display:flex;"><span>BULK READ 0×05 BYTES:
</span></span><span style="display:flex;"><span>0×07 ACK 0×06 ACK 0×05 ACK 0×04 ACK 0×03 NACK
</span></span><span style="display:flex;"><span>I2C STOP CONDITION
</span></span><span style="display:flex;"><span>I2C&gt;
</span></span></code></pre></div><p>Nothing changes for write commands because the slave ACKs to the Buzzpirat during writes. Here’s an example using the bulk read command (r:5).</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>I2C&gt;[0xd1 r &lt;&lt;&lt;setup and read one byte
</span></span><span style="display:flex;"><span>I2C START CONDITION
</span></span><span style="display:flex;"><span>WRITE: 0xD1 GOT ACK: YES
</span></span><span style="display:flex;"><span>READ: 0x07 *(N)ACK PENDING &lt;&lt;&lt;no ACK sent yet
</span></span><span style="display:flex;"><span>I2C&gt;r&lt;&lt;&lt;read another byte
</span></span><span style="display:flex;"><span>ACK &lt;&lt;&lt;ACK for previous byte
</span></span><span style="display:flex;"><span>READ: 0x06 *(N)ACK PENDING &lt;&lt;&lt;no ACK yet
</span></span><span style="display:flex;"><span>I2C&gt;] &lt;&lt;&lt;STOP command
</span></span><span style="display:flex;"><span>NACK &lt;&lt;&lt;next command is STOP, so NACK
</span></span><span style="display:flex;"><span>I2C STOP CONDITION
</span></span><span style="display:flex;"><span>I2C&gt;
</span></span></code></pre></div><p>A consequence of the delayed ACK/NACK system is that partial transactions will leave read operations incomplete.</p>
<p>Here, I setup a read operation ([0xd1) and read a byte (r). Since the Buzzpirat has no way of knowing if the next operation will be another read (r) or a stop condition (]), it leaves the ninth bit hanging. The warning “*(N)ACK PENDING” alerts you to this state.</p>
<p>Our next command is another read (r), so the Buzzpirat ACKs the previous read and gets another byte. Again, it leaves the (N)ACK bit pending until the next command.</p>
<p>The final command is STOP (]). The Buzzpirat ends the read with a NACK and then sends the stop condition.</p>
<h3 id="connections-1">Connections</h3>
<table>
<thead>
<tr>
<th>Buzzpirat</th>
<th>Dir.</th>
<th>Circuit</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>MOSI</td>
<td>↔</td>
<td>SDA</td>
<td>Serial Data</td>
</tr>
<tr>
<td>CLK</td>
<td>→</td>
<td>SCL</td>
<td>Serial Clock</td>
</tr>
<tr>
<td>GND</td>
<td>⏚</td>
<td>GND</td>
<td>Signal Ground</td>
</tr>
</tbody>
</table>
<h2 id="spi">SPI</h2>
<ul>
<li><strong>Bus:</strong> <a href="http://en.wikipedia.org/wiki/Serial_Peripheral_Interface_Bus">SPI (serial peripheral interface)</a>.</li>
<li><strong>Connections:</strong> Four pins (MOSI/MISO/CLOCK/CS) and ground.</li>
<li><strong>Output type:</strong> 3.3 volt normal, or <a href="http://en.wikipedia.org/wiki/High_impedence">open collector</a> pull-up resistors required.</li>
<li><strong>Pull-up resistors:</strong> Required for open drain output mode (2K – 10K).</li>
<li><strong>Maximum voltage:</strong> 5.5 volts (5 volt safe).</li>
<li><strong>Last documentation update:</strong> v5.8.</li>
</ul>
<h3 id="configuration-options-2">Configuration options</h3>
<ul>
<li><em>Speed:</em> 30, 125, 250 kHz; 1, 2, 2.6, 4, 8 MHz</li>
<li><em>Clock polarity:</em> Idle low, idle high.</li>
<li><em>Output clock edge:</em> Idle to active, active to idle.</li>
<li><em>Input sample phase:</em> Middle, end.</li>
<li><em>Output type:</em> Open drain/open collector (high=Hi-Z, low=ground), normal (high=3.3 volts, low=ground). Use open drain/open collector output types with pull-up resistors for multi-voltage interfacing.</li>
</ul>
<h3 id="syntax-3">Syntax</h3>
<table>
<thead>
<tr>
<th>Command</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>A/a/@</code></td>
<td>Toggle auxiliary pin. Capital “A” sets AUX high, small “a” sets to ground. <code>@</code> sets aux to input (high impedance mode) and reads the pin value.</td>
</tr>
<tr>
<td><code>D/d</code></td>
<td>Measure voltage on the ADC pin (v1+ hardware only).</td>
</tr>
<tr>
<td><code>W/w</code></td>
<td>Capital ‘W’ enables the on-board power supplies. Small ‘w’ disables them. (v1+ hardware only).</td>
</tr>
<tr>
<td><code>[</code></td>
<td>Chip select (CS) active (low).</td>
</tr>
<tr>
<td><code>{</code></td>
<td>CS active (low), show the SPI read byte after every write.</td>
</tr>
<tr>
<td><code>]</code> or <code>}</code></td>
<td>CS disable (high).</td>
</tr>
<tr>
<td><code>r</code></td>
<td>Read one byte by sending dummy byte (0xff). (<code>r:1…255</code> for bulk reads)</td>
</tr>
<tr>
<td><code>0b</code></td>
<td>Write this binary value. Format is <code>0b00000000</code> for a byte, but partial bytes are also fine: <code>0b1001</code>.</td>
</tr>
<tr>
<td><code>0x</code></td>
<td>Write this HEX value. Format is <code>0x01</code>. Partial bytes are fine: <code>0xA</code>. A-F can be lower-case or capital letters.</td>
</tr>
<tr>
<td><code>0-255</code></td>
<td>Write this decimal value. Any number not preceded by <code>0x</code> or <code>0b</code> is interpreted as a decimal value.</td>
</tr>
<tr>
<td><code>,</code></td>
<td>Value delimiter. Use a comma or space to separate numbers. Any combination is fine, no delimiter is required between non-number values: <code>{0xa6,0, 0 16 5 0b111 0xaF}</code>.</td>
</tr>
<tr>
<td><code>&amp;</code></td>
<td>Delay 1uS. (<code>&amp;:1…255</code> for multiple delays)</td>
</tr>
<tr>
<td><code>(#) </code></td>
<td>Run macro, <code>(0)</code> for macro list</td>
</tr>
</tbody>
</table>
<h3 id="macro-2">Macro</h3>
<table>
<thead>
<tr>
<th>Command</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>0</code></td>
<td>Macro menu</td>
</tr>
<tr>
<td><code>1</code></td>
<td>SPI bus sniffer, sniff when CS is low (hardware CS filter)</td>
</tr>
<tr>
<td><code>2</code></td>
<td>SPI bus sniffer, sniff all traffic (no CS filter)</td>
</tr>
<tr>
<td><code>3</code></td>
<td><s>SPI bus sniffer, sniff when CS is high (software CS filter)</s> Temporarily removed to increase speed.</td>
</tr>
<tr>
<td><code>10</code></td>
<td>Change clock polarity to 0 without re-entering SPI mode</td>
</tr>
<tr>
<td><code>11</code></td>
<td>Change clock polarity to 1 without re-entering SPI mode</td>
</tr>
<tr>
<td><code>12</code></td>
<td>Change clock edge to 0 without re-entering SPI mode</td>
</tr>
<tr>
<td><code>13</code></td>
<td>Change clock edge to 1 without re-entering SPI mode</td>
</tr>
<tr>
<td><code>14</code></td>
<td>Change sample phase to 0 without re-entering SPI mode</td>
</tr>
<tr>
<td><code>15</code></td>
<td>Change sample phase to 1 without re-entering SPI mode</td>
</tr>
</tbody>
</table>
<h3 id="spi-bus-sniffer">SPI Bus sniffer</h3>
<p>The Buzzpirat can read the traffic on an SPI bus.</p>
<p>Warning! Enter sniffer mode before connecting the target!!
The Buzzpirat SPI CLOCK or DATA lines could be grounded and ruin the target device!
Reset with the CS pin to clear garbage if needed</p>
<p>Pin connections are the same as normal SPI mode. Connect the Buzzpirat clock to the clock on the SPI bus you want to sniff. The data pins MOSI and MISO are both inputs, connect them to the SPI bus data lines. Connect the CS pin to the SPI bus CS pin.</p>
<ul>
<li><code>[/]</code> – CS enable/disable</li>
<li><code>0xXX</code> – MOSI read</li>
<li><code>(0xXX)</code> – MISO read</li>
</ul>
<p>SPI CS pin transitions are represented by the normal Buzzpirat syntax. The byte sniffed on the MISO pin is displayed inside <code>()</code>.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>SPI&gt; (0)
</span></span><span style="display:flex;"><span>0.Macro menu
</span></span><span style="display:flex;"><span>1.Sniff CS low
</span></span><span style="display:flex;"><span>2.Sniff all traffic
</span></span><span style="display:flex;"><span>SPI&gt; (1)
</span></span><span style="display:flex;"><span>Sniffer
</span></span><span style="display:flex;"><span>Any key to exit
</span></span><span style="display:flex;"><span>[0x30(0x00)0xff(0x12)0xff(0x50)][0x40(0x00)]
</span></span></code></pre></div><p>The SPI sniffer can read all traffic, or filter by the state of the CS pin. The byte sniffed on the MOSI pin is displayed as a HEX formatted value, the byte sniffed on the MISO pin is inside the ().</p>
<p>There may be an issue in the sniffer terminal mode from v5.2+.
Try the binary mode sniffer utility for best results.
Notes</p>
<p>The sniffer uses a 4096byte output ring buffer. Sniffer output goes into the ring buffer and gets pushed to the PC when the UART is free. This should eliminate problems with dropped bytes, regardless of UART speed or display mode.</p>
<p>Warning! Enter sniffer mode before connecting the target!!
The Buzzpirat SPI CLOCK or DATA lines could be grounded and ruin the target device!
Reset with the CS pin to clear garbage if needed</p>
<ul>
<li>A long enough stream of data will eventually overtake the buffer, after which the MODE LED turns off (v5.2+). No data can be trusted if the MODE LED is off - this will be improved in a future firmware.</li>
<li>The SPI hardware has a 4 byte buffer. If it fills before I can transfer the data to the ring buffer, then the terminal will display &ldquo;Can&rsquo;t keep up&rdquo; and drop back to the SPI prompt. This error and the ring buffer error will be combined in a future update.</li>
<li>Any commands entered after the sniffer macro will be lost.</li>
<li>Pins that are normally output become inputs in sniffer mode. MOSI, CLOCK, MISO, and CS are all inputs in SPI sniffer mode.</li>
<li>Since v5.3 the SPI sniffer uses hardware chip select for the CS low sniffer mode. The minimum time between CS falling and the first clock is 120ns theoretical, and less than 1.275us in tests. The software CS detect (CS high sniffer mode) requires between 27usec and 50usec minimum delay between the transition of the CS line and the start of data. Thanks to Peter Klammer for testing and updates.</li>
<li>The sniffer follows the output clock edge and output polarity settings of the SPI mode, but not the input sample phase.</li>
</ul>
<h3 id="clock-edgeclock-polaritysample-phase-macros">Clock edge/clock polarity/sample phase macros</h3>
<p>Macros 10-15 change SPI settings without disabling the SPI module. These macros were added at a user&rsquo;s request, but they never reported if it worked.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>SPI&gt; (10)(11)(12)(13)(14)(15)
</span></span><span style="display:flex;"><span>SPI (spd ckp ske smp csl hiz)=( 3 0 1 0 1 1 )
</span></span><span style="display:flex;"><span>SPI (spd ckp ske smp csl hiz)=( 3 1 1 0 1 1 )
</span></span><span style="display:flex;"><span>SPI (spd ckp ske smp csl hiz)=( 3 1 0 0 1 1 )
</span></span><span style="display:flex;"><span>SPI (spd ckp ske smp csl hiz)=( 3 1 1 0 1 1 )
</span></span><span style="display:flex;"><span>SPI (spd ckp ske smp csl hiz)=( 3 1 1 0 1 1 )
</span></span><span style="display:flex;"><span>SPI (spd ckp ske smp csl hiz)=( 3 1 1 1 1 1 )
</span></span><span style="display:flex;"><span>SPI&gt;
</span></span></code></pre></div><h3 id="connections-2">Connections</h3>
<table>
<thead>
<tr>
<th>Buzzpirat</th>
<th>Dir.</th>
<th>Circuit</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>MOSI</td>
<td>→</td>
<td>MOSI</td>
<td>Master Out, Slave In</td>
</tr>
<tr>
<td>MISO</td>
<td>←</td>
<td>MISO</td>
<td>Master In, Slave Out</td>
</tr>
<tr>
<td>CS</td>
<td>→</td>
<td>CS</td>
<td>Chip Select</td>
</tr>
<tr>
<td>CLK</td>
<td>→</td>
<td>CLK</td>
<td>Clock signal</td>
</tr>
<tr>
<td>GND</td>
<td>⏚</td>
<td>GND</td>
<td>Signal Ground</td>
</tr>
</tbody>
</table>
<h2 id="raw-2-wire">Raw 2-wire</h2>
<ul>
<li><strong>Bus:</strong> General purpose 2-wire library with bitwise pin control.</li>
<li><strong>Connections:</strong> Two pins (SDA/SCL) and ground.</li>
<li><strong>Output type:</strong> 3.3 volt normal, or <a href="http://en.wikipedia.org/wiki/High_impedence">open collector</a> pull-up resistors required.</li>
<li><strong>Pull-up resistors:</strong> Required for open drain output mode (2K – 10K).</li>
<li><strong>Maximum voltage:</strong> 5.5 volts (5 volt safe).</li>
<li><strong>Last documentation update:</strong> v5.6.</li>
</ul>
<p>The raw 2 wire library is similar to I2C, but it doesn’t handle acknowledge bits and it has bitwise pin control. I2C could be built using the basic elements in the raw2wire library.</p>
<h3 id="configuration-options-3">Configuration options</h3>
<ul>
<li><strong>Speed:</strong> High (~50kHz) and low (~5kHz).</li>
<li><strong>Output type:</strong> Open drain/open collector (high=Hi-Z, low=ground), normal (high=3.3 volts, low=ground). Use open drain/open collector output types with pull-up resistors for multi-voltage interfacing.</li>
</ul>
<h3 id="syntax-4">Syntax</h3>
<table>
<thead>
<tr>
<th>Command</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>A/a/@</code></td>
<td>Toggle auxiliary pin. Capital “A” sets AUX high, small “a” sets to ground. <code>@</code> sets aux to input (high impedance mode) and reads the pin value.</td>
</tr>
<tr>
<td><code>D/d</code></td>
<td>Measure voltage on the ADC pin (v1+ hardware only).</td>
</tr>
<tr>
<td><code>W/w</code></td>
<td>Capital ‘W’ enables the on-board power supplies. Small ‘w’ disables them. (v1+ hardware only).</td>
</tr>
<tr>
<td><code>{ or [</code></td>
<td>Issue I2C-style start condition.</td>
</tr>
<tr>
<td><code>] or }</code></td>
<td>Issue I2C-style stop condition.</td>
</tr>
<tr>
<td><code>r</code></td>
<td>Read one byte. (<code>r:1…255</code> for bulk reads)</td>
</tr>
<tr>
<td><code>0b</code></td>
<td>Write this binary value. Format is <code>0b00000000</code> for a byte, but partial bytes are also fine: <code>0b1001</code>.</td>
</tr>
<tr>
<td><code>0x</code></td>
<td>Write this HEX value. Format is <code>0×01</code>. Partial bytes are fine: <code>0xA</code>. A-F can be lower-case or capital letters.</td>
</tr>
<tr>
<td><code>0-255</code></td>
<td>Write this decimal value. Any number not preceded by <code>0x</code> or <code>0b</code> is interpreted as a decimal value.</td>
</tr>
<tr>
<td><code>,</code></td>
<td>Value delimiter. Use a comma or space to separate numbers. Any combination is fine, no delimiter is required between non-number values: <code>{0xa6,0, 0 16 5 0b111 0xaF}</code>.</td>
</tr>
<tr>
<td><code>&amp;</code></td>
<td>Delay 1uS. (<code>&amp;:1…255</code> for multiple delays)</td>
</tr>
<tr>
<td><code>(#)</code></td>
<td>Run macro, <code>(0)</code> for macro list</td>
</tr>
<tr>
<td><em>Bitwise</em></td>
<td></td>
</tr>
<tr>
<td><code>^</code></td>
<td>Send one clock tick. (<code>^:1…255</code> for multiple clock ticks)</td>
</tr>
<tr>
<td><code>/ or \</code></td>
<td>Toggle clock level high (<code>/</code>) and low (<code>\</code>). Includes clock delay (100uS).</td>
</tr>
<tr>
<td><code>- or _</code></td>
<td>Toggle data state high (<code>-</code>) and low (<code>_</code>). Includes data setup delay (20uS).</td>
</tr>
<tr>
<td><code>!</code></td>
<td>Read one bit with clock.</td>
</tr>
<tr>
<td><code>.</code></td>
<td>Read data pin state (no clock).</td>
</tr>
</tbody>
</table>
<h3 id="macro-3">Macro</h3>
<table>
<thead>
<tr>
<th>Command</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>0</code></td>
<td>Macro menu</td>
</tr>
<tr>
<td><code>1</code></td>
<td>ISO7813-3 ATR for smart cards, parses reply bytes.</td>
</tr>
<tr>
<td><code>2</code></td>
<td>ISO7813-3 parse only (provide your own ATR command).</td>
</tr>
</tbody>
</table>
<h3 id="connections-3">Connections</h3>
<table>
<thead>
<tr>
<th>Buzzpirat</th>
<th>Dir.</th>
<th>Circuit</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>MOSI</td>
<td>↔</td>
<td>SDA</td>
<td>Serial Data</td>
</tr>
<tr>
<td>CLK</td>
<td>→</td>
<td>SCL</td>
<td>Serial Clock</td>
</tr>
<tr>
<td>GND</td>
<td>⏚</td>
<td>GND</td>
<td>Signal Ground</td>
</tr>
</tbody>
</table>
<h2 id="raw-3-wire">Raw 3-wire</h2>
<ul>
<li><strong>Bus:</strong> General purpose 3-wire library with bitwise pin control.</li>
<li><strong>Connections:</strong> Four pins (MOSI/MISO/CLOCK/CS) and ground.</li>
<li><strong>Output types:</strong> 3.3 volt normal, or <a href="http://en.wikipedia.org/wiki/High_impedence">open drain/open collector</a> pull-up resistors required.</li>
<li><strong>Pull-up resistors:</strong> Required for open drain output mode (2K – 10K).</li>
<li><strong>Maximum voltage:</strong> 5.5 volts (5 volt safe).</li>
<li><strong>Last documentation update:</strong> v5.6.</li>
</ul>
<p>The raw 3 wire library is like SPI, but includes bitwise pin control.</p>
<h3 id="configuration-options-4">Configuration options</h3>
<ul>
<li><strong>Speed:</strong> High (~50kHz) and low (~5kHz).</li>
<li><strong>Output type:</strong> Open drain/open collector (high=Hi-Z, low=ground), normal (high=3.3 volts, low=ground). Use open drain/open collector output types with pull-up resistors for multi-voltage interfacing.</li>
</ul>
<h3 id="syntax-5">Syntax</h3>
<table>
<thead>
<tr>
<th>Command</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>A/a/@</code></td>
<td>Toggle auxiliary pin. Capital “A” sets AUX high, small “a” sets to ground. <code>@</code> sets aux to input (high impedance mode) and reads the pin value.</td>
</tr>
<tr>
<td><code>D/d</code></td>
<td>Measure voltage on the ADC pin (v1+ hardware only).</td>
</tr>
<tr>
<td><code>W/w</code></td>
<td>Capital ‘W’ enables the on-board power supplies. Small ‘w’ disables them. (v1+ hardware only).</td>
</tr>
<tr>
<td><code>[</code></td>
<td>Chip select (CS) active (low).</td>
</tr>
<tr>
<td><code>{</code></td>
<td>CS active (low), show the SPI read byte after every write.</td>
</tr>
<tr>
<td><code>]</code> or <code>}</code></td>
<td>CS disable (high).</td>
</tr>
<tr>
<td><code>r</code></td>
<td>Read one byte by sending dummy byte (0xff). (<code>r:1…255</code> for bulk reads)</td>
</tr>
<tr>
<td><code>0b</code></td>
<td>Write this binary value. Format is <code>0b00000000</code> for a byte, but partial bytes are also fine: <code>0b1001</code>.</td>
</tr>
<tr>
<td><code>0x</code></td>
<td>Write this HEX value. Format is <code>0x01</code>. Partial bytes are fine: <code>0xA</code>. A-F can be lower-case or capital letters.</td>
</tr>
<tr>
<td><code>0-255</code></td>
<td>Write this decimal value. Any number not preceded by <code>0x</code> or <code>0b</code> is interpreted as a decimal value.</td>
</tr>
<tr>
<td><code>,</code></td>
<td>Value delimiter. Use a comma or space to separate numbers. Any combination is fine, no delimiter is required between non-number values: <code>{0xa6,0, 0 16 5 0b111 0xaF}</code>.</td>
</tr>
<tr>
<td><code>&amp;</code></td>
<td>Delay 1uS. (<code>&amp;:1…255</code> for multiple delays)</td>
</tr>
<tr>
<td><code>(#)</code></td>
<td>Run macro, <code>(0)</code> for macro list</td>
</tr>
<tr>
<td><em>Bitwise</em></td>
<td></td>
</tr>
<tr>
<td><code>^</code></td>
<td>Send one clock tick. (<code>^:1…255</code> for multiple clock ticks)</td>
</tr>
<tr>
<td><code>/</code> or <code>\</code></td>
<td>Toggle clock level high (<code>/</code>) and low (<code>\</code>). Includes clock delay (100uS).</td>
</tr>
<tr>
<td><code>-</code> or <code>_</code></td>
<td>Toggle data state high (<code>-</code>) and low (<code>_</code>). Includes data setup delay (20uS).</td>
</tr>
<tr>
<td><code>!</code></td>
<td>Read one bit with clock.</td>
</tr>
<tr>
<td><code>.</code></td>
<td>Read data pin state (no clock).</td>
</tr>
</tbody>
</table>
<h3 id="connections-4">Connections</h3>
<table>
<thead>
<tr>
<th>Buzzpirat</th>
<th>Dir.</th>
<th>Circuit</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>MOSI</td>
<td>→</td>
<td>MOSI</td>
<td>Master Out, Slave In</td>
</tr>
<tr>
<td>MISO</td>
<td>←</td>
<td>MISO</td>
<td>Master In, Slave Out</td>
</tr>
<tr>
<td>CS</td>
<td>→</td>
<td>CS</td>
<td>Chip Select</td>
</tr>
<tr>
<td>CLK</td>
<td>→</td>
<td>CLK</td>
<td>Clock signal</td>
</tr>
<tr>
<td>GND</td>
<td>↔</td>
<td>GND</td>
<td>Signal Ground</td>
</tr>
</tbody>
</table>
<h2 id="hd44780-lcds">HD44780 LCDs</h2>
<ul>
<li><strong>Bus:</strong> <a href="http://ouwehand.net/%7Epeter/lcd/lcd.shtml">HD44780 LCD</a> test library.</li>
<li><strong>Adapter:</strong> 74HCT595-based LCD adapter board</li>
</ul>
<p>The Buzzpirat can test HD44780 LCDs but it needs an IO expander chip. Currently, it uses a simple 74HCT595 adapter</p>
<h3 id="syntax-6">Syntax</h3>
<table>
<thead>
<tr>
<th>Command</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>A/a/@</code></td>
<td>Toggle auxiliary pin. Capital “A” sets AUX high, small “a” sets to ground. <code>@</code> sets aux to input (high impedance mode) and reads the pin value.</td>
</tr>
<tr>
<td><code>D/d</code></td>
<td>Measure voltage on the ADC pin (v1+ hardware only).</td>
</tr>
<tr>
<td><code>W/w</code></td>
<td>Capital ‘W’ enables the on-board power supplies. Small ‘w’ disables them. (v1+ hardware only).</td>
</tr>
<tr>
<td><code>{</code> or <code>[</code></td>
<td>RS low. Next read/write is a COMMAND.</td>
</tr>
<tr>
<td><code>]</code> or <code>}</code></td>
<td>RS high. Next read/write is TEXT/DATA.</td>
</tr>
<tr>
<td><code>r</code></td>
<td>Read one byte (<code>r:1…255</code> for bulk reads).</td>
</tr>
<tr>
<td><code>0b</code></td>
<td>Write this binary value. Format is <code>0b00000000</code> for a byte, but partial bytes are also fine: <code>0b1001</code>.</td>
</tr>
<tr>
<td><code>0x</code></td>
<td>Write this HEX value. Format is <code>0x01</code>. Partial bytes are fine: <code>0xA</code>. A-F can be lower-case or capital letters.</td>
</tr>
<tr>
<td><code>0-255</code></td>
<td>Write this decimal value. Any number not preceded by <code>0x</code> or <code>0b</code> is interpreted as a decimal value.</td>
</tr>
<tr>
<td><code>&quot;xxx&quot;</code></td>
<td>Write the ASCII text <code>xxx</code> to the LCD.</td>
</tr>
<tr>
<td><code>,</code></td>
<td>Value delimiter. Use a comma or space to separate numbers. Any combination is fine, no delimiter is required between non-number values: <code>{0xa6,0, 0 16 5 0b111 0xaF}</code>.</td>
</tr>
<tr>
<td><code>&amp;</code></td>
<td>Delay 1uS. (<code>&amp;:1…255</code> for multiple delays)</td>
</tr>
<tr>
<td><code>(#)</code></td>
<td>Run macro, <code>(0)</code> for macro list</td>
</tr>
</tbody>
</table>
<h3 id="macro-4">Macro</h3>
<table>
<thead>
<tr>
<th>Command</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>0</code></td>
<td>Macro menu</td>
</tr>
<tr>
<td><code>1</code></td>
<td>LCD reset.</td>
</tr>
<tr>
<td><code>2</code></td>
<td>Init LCD.</td>
</tr>
<tr>
<td><code>3</code></td>
<td>Clear LCD.</td>
</tr>
<tr>
<td><code>4</code></td>
<td>Cursor position ex: <code>(4:0)</code>.</td>
</tr>
<tr>
<td><code>5</code></td>
<td>Write test text. (deprecated)</td>
</tr>
<tr>
<td><code>6</code></td>
<td>Write <code>:number</code> test numbers ex: <code>(6:80)</code>.</td>
</tr>
<tr>
<td><code>7</code></td>
<td>Write <code>:number</code> test characters ex: <code>(7:80)</code>.</td>
</tr>
</tbody>
</table>
<h2 id="pc-keyboard">PC keyboard</h2>
<ul>
<li><strong>Bus:</strong> PC keyboard interface library.</li>
<li><strong>Connections:</strong> Two pins (KBD/KBC) and ground.</li>
<li><strong>Output type:</strong> <a href="http://en.wikipedia.org/wiki/High_impedence">Open drain/open collector</a>.</li>
<li><strong>Pull-up resistors:</strong> <em>None</em>, keyboard has internal pull-ups.</li>
<li><strong>Maximum voltage:</strong> 5 volts.</li>
</ul>
<p>This library interfaces PC keyboards. A PC keyboard operates at 5 volts and has its own internal pull-up resistors to 5 volts. The keyboard issues a clock signal that drives all transactions, the library includes a time-out (v0h+) so the Buzzpirat won’t freeze if the keyboard doesn’t respond.</p>
<h3 id="syntax-7">Syntax</h3>
<table>
<thead>
<tr>
<th>Command</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>A/a/@</code></td>
<td>Toggle auxiliary pin. Capital “A” sets AUX high, small “a” sets to ground. <code>@</code> sets aux to input (high impedance mode) and reads the pin value.</td>
</tr>
<tr>
<td><code>D/d</code></td>
<td>Measure voltage on the ADC pin (v1+ hardware only).</td>
</tr>
<tr>
<td><code>W/w</code></td>
<td>Capital ‘W’ enables the on-board power supplies. Small ‘w’ disables them. (v1+ hardware only).</td>
</tr>
<tr>
<td><code>r</code></td>
<td>Read one byte with timeout. (<code>r:1…255</code> for bulk reads)</td>
</tr>
<tr>
<td><code>0b</code></td>
<td>Write this binary value with timeout. Format is <code>0b00000000</code> for a byte, but partial bytes are also fine: <code>0b1001</code>.</td>
</tr>
<tr>
<td><code>0x</code></td>
<td>Write this HEX value with timeout. Format is <code>0x01</code>. Partial bytes are fine: <code>0xA</code>. A-F can be lower-case or capital letters.</td>
</tr>
<tr>
<td><code>0-255</code></td>
<td>Write this decimal value with timeout. Any number not preceded by <code>0x</code> or <code>0b</code> is interpreted as a decimal value.</td>
</tr>
<tr>
<td><code>,</code></td>
<td>Value delimiter. Use a comma or space to separate numbers. Any combination is fine, no delimiter is required between non-number values: <code>{0xa6,0, 0 16 5 0b111 0xaF}</code>.</td>
</tr>
<tr>
<td><code>&amp;</code></td>
<td>Delay 1uS. (<code>&amp;:1…255</code> for multiple delays)</td>
</tr>
<tr>
<td><code>(#)</code></td>
<td>Run macro, <code>(0)</code> for macro list</td>
</tr>
</tbody>
</table>
<h3 id="macro-5">Macro</h3>
<table>
<thead>
<tr>
<th>Command</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>0</code></td>
<td>Macro menu</td>
</tr>
<tr>
<td><code>1</code></td>
<td>Live keyboard monitor (v0h+)</td>
</tr>
</tbody>
</table>
<h2 id="dio">DIO</h2>
<p>This mode gives the user 100% control over the Buzzpirat IO pins from the terminal.</p>
<p>Send same command values as the binary bitbang mode to set pin direction and state.</p>
<h2 id="basic-script-reference">BASIC script reference</h2>
<p>BASIC script mode is entered by typing &rsquo;s&rsquo; at the Buzzpirat commandline. You need to take care of entering the correct mode and set it up (things like speed, Hiz, etc.).</p>
<p>This isn&rsquo;t intended as a guide in learning how to program. General programming knowledge is assumed. Be aware that only basic checking is done and there are no warnings printed to the terminal (except those intended by the program with print statements). The editor is very rudimentary and does not check if the syntax is right. The language is loosely based on BASIC.</p>
<p>Enter script mode:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>HiZ&gt; s
</span></span><span style="display:flex;"><span>HiZ(BASIC)&gt;
</span></span></code></pre></div><h3 id="new">NEW</h3>
<p>The memory is cleared by entering the NEW command.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>HiZ(BASIC)&gt; new
</span></span><span style="display:flex;"><span>Ready.
</span></span><span style="display:flex;"><span>HiZ(BASIC)&gt;
</span></span></code></pre></div><p>NOTE: With firmware before version 5.8 this command was mandatory before entering anything else in the basic editor!!</p>
<h3 id="list">LIST</h3>
<p>From the basic commandline programs can be entered. The basicinterpreter uses linenumbers followed by statements. After this the program can be listed by the command &lsquo;LIST&rsquo;</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>HiZ(BASIC)&gt; list
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>100 REM BASICDEMO
</span></span><span style="display:flex;"><span>110 PRINT &#34;HELLO WORLD!&#34;
</span></span><span style="display:flex;"><span>120 PRINT &#34;HELLO AGAIN&#34;
</span></span><span style="display:flex;"><span>65535 END
</span></span><span style="display:flex;"><span>52 bytes.
</span></span><span style="display:flex;"><span>Ready.
</span></span><span style="display:flex;"><span>HiZ(BASIC)&gt;
</span></span></code></pre></div><h3 id="run">RUN</h3>
<p>You can also run it with the command run:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>HiZ(BASIC)&gt; run
</span></span><span style="display:flex;"><span>HELLO WORLD!
</span></span><span style="display:flex;"><span>HELLO AGAIN
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Ready.
</span></span><span style="display:flex;"><span>HiZ(BASIC)&gt;
</span></span></code></pre></div><h3 id="variables">Variables</h3>
<p>A..Z (26) variables are possible. The variable are internally 16bit signed</p>
<h3 id="let">LET</h3>
<p>assigns a variable. Another variable, constants or functions that returns a value (e.g. RECEIVE)</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>10 LET A=B+1
</span></span></code></pre></div><h3 id="if-ifstat-then-truestat-else-falsestat">IF {ifstat} THEN {truestat} ELSE {falsestat}</h3>
<p>Evaluate the {ifstat} if it evaluate to a value that is not zero {truestat} get executed otherwise {falsestat}.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>10 IF A=1 THEN GOTO 100 ELSE PRINT &#34;A IS NOT 1&#34;
</span></span></code></pre></div><h3 id="goto-line">GOTO {line}</h3>
<p>jumps to line {line}, without remembering where it came from (see also GOSUB)</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>10 GOTO 100
</span></span><span style="display:flex;"><span>20 PRINT &#34;line 20&#34;
</span></span><span style="display:flex;"><span>100 PRINT &#34;line 100&#34;
</span></span></code></pre></div><p>line 20 doesn&rsquo;t get executed</p>
<h3 id="gosub-line-and-return">GOSUB {line} and RETURN</h3>
<p>jumps to line {line}, executes from there till a RETURN and return to the line after the GOSUB.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>10 GOSUB 1000
</span></span><span style="display:flex;"><span>20 PRINT &#34;line 20&#34;
</span></span><span style="display:flex;"><span>30 END
</span></span><span style="display:flex;"><span>1000 PRINT &#34;line 1000&#34;
</span></span><span style="display:flex;"><span>1010 RETURN
</span></span></code></pre></div><p>Stack is 10 levels deep, so 10 nested gosubs are possible.</p>
<h3 id="rem-text">REM {text}</h3>
<p>Puts a remark into the code, but gets skipped.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>10 REM A WONDERFULL PROGRAM
</span></span></code></pre></div><p>Don&rsquo;t use REM between DATA statements!</p>
<h3 id="print-text">PRINT {text}</h3>
<p>Prints {text} to the terminal. Variable and statement can be mixed and are seperated with a &lsquo;;&rsquo;. A &lsquo;;&rsquo; at the end suppresses a newline.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>10 PRINT &#34;A = &#34;;A
</span></span><span style="display:flex;"><span>20 PRINT &#34;RECEIVED: &#34;;RECEIVE
</span></span><span style="display:flex;"><span>30 PRINT &#34;B = &#34;;
</span></span><span style="display:flex;"><span>40 PRINT B
</span></span></code></pre></div><h3 id="input-questionvar">INPUT {question},{var}</h3>
<p>Ask {question} and put the answer the user gave into {var}</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>10 INPUT &#34;A = &#34;,A
</span></span></code></pre></div><h3 id="for-varminvalue-to-maxvalue-stats-next-var">FOR {var}={minvalue} TO {maxvalue} {stats} NEXT {var}</h3>
<p>Assigns value {minvalue} to variable {var}, executes statements {stats} until NEXT is encountered. Variable {var} wil be increased by one, {stats} is again executed, until {var} has the value {maxvalue}.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>10 FOR A=1 TO 10
</span></span><span style="display:flex;"><span>20 PRINT &#34;A = &#34;;A
</span></span><span style="display:flex;"><span>30 NEXT A
</span></span></code></pre></div><p>for/nexts can be nested 4 deep.</p>
<h3 id="read-var--data-val1-val2--val1-val2">READ {var} &amp; DATA {val1}, {val2}, .. {val1}, {val2},</h3>
<p>Read a value into variable {var}. The values are stored in DATA statements.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>10 READ A
</span></span><span style="display:flex;"><span>20 PRINT &#34;A = &#34;;A
</span></span><span style="display:flex;"><span>30 READ A
</span></span><span style="display:flex;"><span>40 PRINT &#34;A = &#34;;A
</span></span><span style="display:flex;"><span>1000 DATA 10,20
</span></span></code></pre></div><h3 id="start">START</h3>
<p>Same as the Buzzpirat &lsquo;[&rsquo; command</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>10 START
</span></span></code></pre></div><h3 id="stop">STOP</h3>
<p>Same as the Buzzpirat &lsquo;]&rsquo; command</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>10 STOP
</span></span></code></pre></div><h3 id="startr">STARTR</h3>
<p>Same as the Buzzpirat &lsquo;{&rsquo; command</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>10 STARTR
</span></span></code></pre></div><h3 id="stopr">STOPR</h3>
<p>Same as the Buzzpirat &lsquo;}&rsquo; command</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>10 STOPR
</span></span></code></pre></div><h3 id="send-valvar">SEND {val/var}</h3>
<p>Sends a value {val} or variable {var} over the bus.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>10 SEND 10
</span></span><span style="display:flex;"><span>20 SEND A
</span></span></code></pre></div><p>Some protocols send/receive at the same time. This is also possible:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>10 LET A=SEND 100
</span></span><span style="display:flex;"><span>20 PRINT &#34;SEND 100 GOT &#34;;A
</span></span></code></pre></div><h3 id="receive">RECEIVE</h3>
<p>Receives data from the bus. With some protocols it returns value &gt;255 to signal busstates (like no data, got ACK, etc), other protocols are 16 bit (like pic).</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>10 LET A=RECEIVE
</span></span><span style="display:flex;"><span>20 PRINT &#34;A = &#34;;A
</span></span></code></pre></div><h3 id="clk-val">CLK {val}</h3>
<p>Controls the CLK line, its behaviour depends on val; 0=low, 1=high, 2=pulse.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>10 CLK 2
</span></span></code></pre></div><h3 id="dat-val">DAT {val}</h3>
<p>Controls the DAT line, its behaviour depends on val; 0=low, 1=high.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>10 DAT 0
</span></span></code></pre></div><p>DAT value can also be read:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>10 LET A=DAT
</span></span><span style="display:flex;"><span>20 PRINT &#34;A = &#34;;A
</span></span></code></pre></div><h3 id="bitread">BITREAD</h3>
<p>Same as the Buzzpirat &lsquo;!&rsquo; command.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>10 LET A=BITREAD
</span></span><span style="display:flex;"><span>20 PRINT &#34;A = &#34;;A
</span></span></code></pre></div><h3 id="adc">ADC</h3>
<p>Reads the ADC. Value returned is 10bits (no conversion!).</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>10 LET A=ADC
</span></span><span style="display:flex;"><span>20 PRINT &#34;A = &#34;;A
</span></span></code></pre></div><h3 id="aux-val">AUX {val}</h3>
<p>Controls the AUX line, its behaviour depends on val; 0=low, 1=high.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>10 AUX 1
</span></span></code></pre></div><p>AUX value can also be read:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>10 LET A=AUX
</span></span><span style="display:flex;"><span>20 PRINT &#34;A = &#34;;A
</span></span></code></pre></div><h3 id="auxpin-val">AUXPIN {val}</h3>
<p>Controls which pin is controlled by the AUX statement; 0=AUX; 1=CS</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>10 AUXPIN 1
</span></span></code></pre></div><h3 id="psu-val">PSU {val}</h3>
<p>Controls the onboard voltage regulators; 0=off, 1=on</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>10 PSU 1
</span></span></code></pre></div><h3 id="pullup-val">PULLUP {val}</h3>
<p>Controls the onboard pullup resistors; 0=off, 1=on</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>10 PULLUP 0
</span></span></code></pre></div><h3 id="delay-var">DELAY {var}</h3>
<p>Delays {var} ms</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>10 DELAY 100
</span></span></code></pre></div><h3 id="freq-var--duty-var">FREQ {var} &amp; DUTY {var}</h3>
<p>Controls the onboard PWM generator. Frequency of 0 disables it. (same limits apply as regular PWM command (&lsquo;g&rsquo;))</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>10 freq 100
</span></span><span style="display:flex;"><span>20 duty 25
</span></span></code></pre></div>
</div>



    
      
  
  
  
  

  
  

  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-c639f7a400d557214471d50010a514eb">3 - Unbrick</h1>
    <div class="lead">How to unbrick your Buzzpirat / Bus Pirate v3</div>
	<p>Have you tried updating the bootloader of Buzzpirat or Bus Pirate v3 and it doesn&rsquo;t work? Doesn&rsquo;t it even enter bootloader mode when bridging the PGD and PGC pins? Don&rsquo;t worry, there are several ways to fix it.</p>
<nav id="TableOfContents">
  <ul>
    <li><a href="#unbrick-using-another-bus-pirate-v3">Unbrick using another Bus Pirate v3</a>
      <ul>
        <li><a href="#downgrade-your-bus-pirate-v3-firmware">Downgrade your Bus Pirate v3 firmware</a></li>
        <li><a href="#connect-to-the-bus-pirate-v3-to-bricked-buzzpirat--bricked-bus-pirate-v3">Connect to the Bus Pirate v3 to Bricked Buzzpirat / Bricked Bus Pirate v3</a></li>
        <li><a href="#burn-a-new-bootloader-and-firmware-to-the-bricked-device">Burn a new bootloader and firmware to the bricked device</a></li>
      </ul>
    </li>
    <li><a href="#unbrick-using-clones-like-pickit35">Unbrick using clones like PICkit3.5</a></li>
    <li><a href="#unbrick-using-official-mplab-pickit-5">Unbrick using official MPLAB PICkit 5</a></li>
  </ul>
</nav>

<h2 id="unbrick-using-another-bus-pirate-v3">Unbrick using another Bus Pirate v3</h2>
<p>The Bus Pirate v3 can be used as an inexpensive PIC programmer.</p>
<p>Total cost: ~40$</p>
<ul>
<li>Buy a Bus Pirate v3 + USB mini -&gt; USB A cable</li>
<li>Buy 5 dupont cables FEMALE-FEMALE</li>
</ul>
<h3 id="downgrade-your-bus-pirate-v3-firmware">Downgrade your Bus Pirate v3 firmware</h3>


<div class="alert alert-warning" role="alert">
<h4 class="alert-heading">Warning</h4>

    You must install this version because the picprog program only works with certain firmwares.

</div>

<p>Download <strong>BPv3-Firmware-v5.9-extras.hex</strong> firmware from this page:</p>
<ul>
<li><a href="https://github.com/therealdreg/buzzpirat/tree/main/bin/oldfirm">https://github.com/therealdreg/buzzpirat/tree/main/bin/oldfirm</a></li>
</ul>
<p>Download the last buzzloader app (There are versions available for Windows, Linux and Mac) from this page:</p>
<ul>
<li>
<p><a href="https://github.com/therealdreg/buzzpirat/tree/main/bin/buzzloader">https://github.com/therealdreg/buzzpirat/tree/main/bin/buzzloader</a></p>
</li>
<li>
<p>put a jumper/dupont_wire connecting the PGD pin to the PGC pin</p>
</li>
<li>
<p>connect the Bus Pirate v3 to your computer via a usb cable</p>
</li>
<li>
<p>check for the new COM port assignment in the device manager (e.g., COM29)</p>
</li>
</ul>
<p>Make sure to close Tera Term or any other software that might be using the COM port to free it up and execute:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>buzzloader.exe --dev=COM29 --hex=BPv3-Firmware-v5.9-extras.hex
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>Erasing page 41, a400...OK
</span></span><span style="display:flex;"><span>Writing page 41 row 328, a400...OK
</span></span><span style="display:flex;"><span>Writing page 41 row 329, a480...OK
</span></span><span style="display:flex;"><span>Writing page 41 row 330, a500...OK
</span></span><span style="display:flex;"><span>Writing page 41 row 331, a580...OK
</span></span><span style="display:flex;"><span>Writing page 41 row 332, a600...OK
</span></span><span style="display:flex;"><span>Writing page 41 row 333, a680...OK
</span></span><span style="display:flex;"><span>Writing page 41 row 334, a700...OK
</span></span><span style="display:flex;"><span>Writing page 41 row 335, a780...OK
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Firmware updated successfully :)!
</span></span><span style="display:flex;"><span>Use screen com30 115200 to verify
</span></span></code></pre></div><p>Remove the jumper/Dupont cable, then reconnect the device to the USB port, and you&rsquo;re all set! You should now have the  firmware installed.</p>
<p>Run the &lsquo;i&rsquo; command and perform a self-test with the &lsquo;~&rsquo; command to ensure everything has gone smoothly.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>i
</span></span><span style="display:flex;"><span>Bus Pirate v3b
</span></span><span style="display:flex;"><span>Firmware v5.9 (r529) [HiZ 2WIRE 3WIRE KEYB LCD DIO] Bootloader v4.5
</span></span><span style="display:flex;"><span>DEVID:0x0447 REVID:0x3046 (24FJ64GA002 B8)
</span></span><span style="display:flex;"><span>http://dangerousprototypes.com
</span></span><span style="display:flex;"><span>HiZ&gt;
</span></span></code></pre></div><h3 id="connect-to-the-bus-pirate-v3-to-bricked-buzzpirat--bricked-bus-pirate-v3">Connect to the Bus Pirate v3 to Bricked Buzzpirat / Bricked Bus Pirate v3</h3>
<p>Locate the PIC programming pins on the bricked device. Look for the pin named: MCLR.</p>
<p>Connect the pins using Dupont cables in the following manner:</p>
<table>
<thead>
<tr>
<th>Bus Pirate v3</th>
<th>Bricked device</th>
</tr>
</thead>
<tbody>
<tr>
<td>CLK</td>
<td>PGC</td>
</tr>
<tr>
<td>MOSI</td>
<td>PGD</td>
</tr>
<tr>
<td>GND</td>
<td>GND</td>
</tr>
<tr>
<td>+3v3</td>
<td>+3v3</td>
</tr>
<tr>
<td>CS</td>
<td>MCLR</td>
</tr>
</tbody>
</table>
<h3 id="burn-a-new-bootloader-and-firmware-to-the-bricked-device">Burn a new bootloader and firmware to the bricked device</h3>


<div class="alert alert-warning" role="alert">
<h4 class="alert-heading">Warning</h4>

    Download the firmware labeled with &ldquo;pickit&rdquo; in its name

</div>

<p>If you are unbricking a Buzzpirat. Download the last bootloader + firmware .hex file from this page:</p>
<ul>
<li><a href="https://github.com/therealdreg/buzzpirat/tree/main/bin/stablefirm">https://github.com/therealdreg/buzzpirat/tree/main/bin/stablefirm</a></li>
</ul>
<p>If you are unbricking a Bus Pirate v3. Download the last bootloader + firmware .hex file from this page:</p>
<ul>
<li><a href="https://github.com/therealdreg/buzzpirat/tree/main/bin/stablefirm/bpv3comp">https://github.com/therealdreg/buzzpirat/tree/main/bin/stablefirm/bpv3comp</a></li>
</ul>
<p>Download the last picprog app from this page:</p>
<ul>
<li><a href="https://github.com/therealdreg/buzzpirat/tree/main/bin/picprog">https://github.com/therealdreg/buzzpirat/tree/main/bin/picprog</a></li>
</ul>
<p>Ensure that both the bricked device and the Bus Pirate v3 are connected to the PC via USB</p>
<p>Make sure to close Tera Term or any other software that might be using the COM port to free it up and execute: (my Bus Pirate v3 is on COM29):</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>picprog.exe -p buspirate -u COM29 -s 115200 -c 24FJ64GA002 -t HEX -w BZ-pickit-firmware-v7.1.6969-bootloader-v4.5.hex -E
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>Skipping page 333 [ 0x014d00 ], not used
</span></span><span style="display:flex;"><span>Skipping page 334 [ 0x014e00 ], not used
</span></span><span style="display:flex;"><span>Writing page 335, 14f00...
</span></span><span style="display:flex;"><span>Writing page 336, 15000...
</span></span><span style="display:flex;"><span>Writing page 337, 15100...
</span></span><span style="display:flex;"><span>Writing page 338, 15200...
</span></span><span style="display:flex;"><span>Writing page 339, 15300...
</span></span><span style="display:flex;"><span>Skipping page 340 [ 0x015400 ], not used
</span></span><span style="display:flex;"><span>Skipping page 341 [ 0x015500 ], not used
</span></span><span style="display:flex;"><span>Skipping page 342 [ 0x015600 ], not used
</span></span><span style="display:flex;"><span>Writing page 343, 15700...
</span></span></code></pre></div><p>Remove the Dupont cables from MCLR, PGD, PGC, GND, +3v3 pins, then reconnect the bricked device to the USB port, and you&rsquo;re all set! You should now have the bootloader+firmware installed.</p>
<p>Run the &lsquo;i&rsquo; command and perform a self-test with the &lsquo;~&rsquo; command to ensure everything has gone smoothly.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>HiZ&gt;i
</span></span><span style="display:flex;"><span>Bus Pirate v3.5
</span></span><span style="display:flex;"><span>Community Firmware v7.1 - buzzpirat.com by Dreg BZ SIXTHOUSANDNINEHUNDREDSIXTYNINE [HiZ 1-WIRE UART I2C SPI 2WIRE 3WIRE KEYB LCD PIC DIO] Bootloader v4.5
</span></span><span style="display:flex;"><span>DEVID:0x0447 REVID:0x3046 (24FJ64GA00 2 B8)
</span></span><span style="display:flex;"><span>http://dangerousprototypes.com
</span></span><span style="display:flex;"><span>HiZ&gt;
</span></span></code></pre></div><p>Now, <a href="/docs/firmware-update/">reinstall</a> the latest firmware on your Bus Pirate v3 (the one you used as a PIC programmer).</p>
<h2 id="unbrick-using-clones-like-pickit35">Unbrick using clones like PICkit3.5</h2>
<p>Buy a PICkit3.5 from Aliexpress (an inexpensive PIC programmer).</p>
<p>Total cost: ~30$</p>
<p>Download &amp; install the last pickit minus app from this page:</p>
<ul>
<li><a href="https://github.com/therealdreg/buzzpirat/tree/main/bin/pickitminus">https://github.com/therealdreg/buzzpirat/tree/main/bin/pickitminus</a></li>
</ul>
<p>If you are unbricking a Buzzpirat. Download the last bootloader + firmware .hex file from this page:</p>
<ul>
<li><a href="https://github.com/therealdreg/buzzpirat/tree/main/bin/stablefirm">https://github.com/therealdreg/buzzpirat/tree/main/bin/stablefirm</a></li>
</ul>
<p>If you are unbricking a Bus Pirate v3. Download the last bootloader + firmware .hex file from this page:</p>
<ul>
<li><a href="https://github.com/therealdreg/buzzpirat/tree/main/bin/stablefirm/bpv3comp">https://github.com/therealdreg/buzzpirat/tree/main/bin/stablefirm/bpv3comp</a></li>
</ul>
<p>Connect Buzzpirat / Bus Pirate pins to the pins located furthest to the right of the Pickit:</p>
<p><img src="pcktmins0.png" alt=""></p>
<p>Connect Buzzpirat / Buspirate &amp; Pickit to PC USB</p>
<p>Open the pickitminus app</p>
<p><img src="pcktmins1.png" alt=""></p>
<p>Go to Tools -&gt; Download PICkit Operating System</p>
<p><img src="pcktmins2.png" alt=""></p>
<p>Make sure the PIC has been detected: PIC DEVICE FOUND, PIC24FJ64GA002</p>
<p>Select .hex for pickit minus use</p>
<p><img src="pcktmins3.png" alt=""></p>
<p><img src="pcktmins4.png" alt=""></p>
<p>Go to File -&gt; Import Hex</p>
<p>And select the Buzzpirat / Buspirate &ldquo;bootloader + firmware&rdquo; .hex file (with pickit in its name, example: BZ-pickit-firmware-v7.1.9-bootloader-v4.5.hex)</p>
<p><img src="pcktmins5.png" alt=""></p>
<p>Click on Write</p>
<p><img src="pcktmins6.png" alt=""></p>
<p>Done!</p>
<p>Disconnect Buzzpirat / Buspirate &amp; Pickit from PC USB</p>
<h2 id="unbrick-using-official-mplab-pickit-5">Unbrick using official MPLAB PICkit 5</h2>
<p>Buy a PICkit 5 from Microchip.</p>
<p>Total cost: ~100$</p>
<p>Download &amp; install the last MPLAB X IDE from this page:</p>
<p><a href="https://www.microchip.com/en-us/tools-resources/develop/mplab-x-ide">https://www.microchip.com/en-us/tools-resources/develop/mplab-x-ide</a></p>
<p>Connect Buzzpirat / Bus Pirate pins to the pins located furthest to the right of the Pickit:</p>
<p><img src="mplabipe0.png" alt=""></p>
<p>Connect Buzzpirat / Buspirate &amp; Pickit to PC USB</p>
<p>Open MPLAB IPE (included with MPLAB X IDE):</p>
<p>Select your Pickit Programmer, PIC24FJ64GA002</p>
<p>And click on Connect, after that check that the PICKIT &amp; PIC has been detected: PIC DEVICE FOUND, PIC24FJ64GA002:</p>
<p><img src="mplabipe1.png" alt=""></p>
<p>Go to Browse and select the Buzzpirat / Buspirate &ldquo;bootloader + firmware&rdquo; .hex file (with pickit in its name, example: BZ-pickit-firmware-v7.1.9-bootloader-v4.5.hex)</p>
<p>And click on Program</p>
<p><img src="mplabipe2.png" alt=""></p>
<p>Done!</p>
<p>Disconnect Buzzpirat / Buspirate &amp; Pickit from PC USB</p>

</div>



    
      
  
  
  
  

  
  

  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-f0244b1b55a581904dd1c3ad618f02b4">4 - Binary I/O</h1>
    <div class="lead">Binary I/O mod from dangerousprototypes</div>
	<p>The bitbang protocol uses a single byte for all commands. The default start-up state is pin input (HiZ).</p>
<ul>
<li>Send 0x00 to the user terminal (max.) 20 times to enter the raw binary bitbang mode. Check in between if BBIO1 is returned.</li>
<li>Send 0x0F to exit raw bitbang mode and reset the Buzzpirat.</li>
<li>Other raw protocol modes are accessible from within bitbang mode, 0x00 always returns to raw bitbang mode and prints the version string.</li>
<li>There is a slight settling delay between pin updates, currently about 5us.</li>
</ul>


<div class="alert alert-warning" role="alert">
<h4 class="alert-heading">Warning</h4>

    To avoid the BBIO1 endless loop bug in the Buzzpirat, it is crucial to send each 0x00 command individually and verify the presence of a &ldquo;BBIO1&rdquo; response. Transmitting multiple 0x00 commands rapidly in succession may lead to a continuous BBIO1 response loop. The sole solution to this loop issue is to disconnect and then reconnect the USB: <a href="http://dangerousprototypes.com/forum/index.php?topic=4227.0">http://dangerousprototypes.com/forum/index.php?topic=4227.0</a>

</div>

<nav id="TableOfContents">
  <ul>
    <li><a href="#main-b00000000-0x00---reset-responds-bbio1">MAIN b00000000 (0x00) - Reset, responds &ldquo;BBIO1&rdquo;</a></li>
    <li><a href="#main-b00000001-0x01---enter-binary-spi-mode-responds-spi1">MAIN b00000001 (0x01) - Enter binary SPI mode, responds &ldquo;SPI1&rdquo;</a>
      <ul>
        <li><a href="#spi-mode-key-points">SPI Mode, Key points</a></li>
        <li><a href="#spi-b00000001-0x01---enter-raw-spi-mode-display-version-string">SPI b00000001 (0x01) - Enter raw SPI mode, display version string</a></li>
        <li><a href="#spi-b0000001x-0x02-0x03---cs-high-1-or-low-0">SPI b0000001x (0x02-0x03) - CS high (1) or low (0)</a></li>
        <li><a href="#spi-b000011xx-0x0c-0x0f---sniff-spi-traffic-when-cs-low10all01">SPI b000011xx (0x0C-0x0F) - Sniff SPI traffic when CS low(10)/all(01)</a></li>
        <li><a href="#spi-b0001xxxx-0x10-0x1f---bulk-spi-transfer-sendread-1-16-bytes-01byte">SPI b0001xxxx (0x10-0x1F) - Bulk SPI transfer, send/read 1-16 bytes (0=1byte!)</a></li>
        <li><a href="#spi-b0100wxyz-0x40-0x4f---configure-peripherals-wpower-xpull-ups-yaux-zcs">SPI b0100wxyz (0x40-0x4F) - Configure peripherals w=power, x=pull-ups, y=AUX, z=CS</a></li>
        <li><a href="#spi-b01100xxx-0x60-0x67---spi-speed">SPI b01100xxx (0x60-0x67) - SPI speed</a></li>
        <li><a href="#spi-b1000wxyz-0x80-0x8f---spi-config-whiz33v-xckp-idle-ycke-edge-zsmp-sample">SPI b1000wxyz (0x80-0x8F) - SPI config, w=HiZ/3.3v, x=CKP idle, y=CKE edge, z=SMP sample</a></li>
        <li><a href="#spi-b00000100-0x04---write-then-read--b00000101-0x05---write-then-read-no-cs">SPI b00000100 (0x04) - Write then read &amp; b00000101 (0x05) - Write then read, no CS</a></li>
        <li><a href="#spi-b00000110-0x06---avr-extended-commands">SPI b00000110 (0x06) - AVR Extended Commands</a></li>
        <li><a href="#spi-b11111110-0xfe---execute-buzz-commands">SPI b11111110 (0xFE) - Execute Buzz Commands</a></li>
      </ul>
    </li>
    <li><a href="#main-b00000010-0x02---enter-binary-i2c-mode-responds-i2c1">MAIN b00000010 (0x02) - Enter binary I2C mode, responds &ldquo;I2C1&rdquo;</a>
      <ul>
        <li><a href="#i2c-mode-key-points">I2C Mode, Key points</a></li>
        <li><a href="#i2c-b00000001-0x01--display-mode-version-string-responds-i2c1">I2C b00000001 (0x01) – Display mode version string, responds &ldquo;I2C1&rdquo;</a></li>
        <li><a href="#i2c-b00000010-0x02--i2c-start-bit">I2C b00000010 (0x02) – I2C start bit</a></li>
        <li><a href="#i2c-b00000011-0x03---i2c-stop-bit">I2C b00000011 (0x03) - I2C stop bit</a></li>
        <li><a href="#i2c-b00000100-0x04---i2c-read-byte">I2C b00000100 (0x04) - I2C Read Byte</a></li>
        <li><a href="#i2c-b00000110-0x06---ack-bit">I2C b00000110 (0x06) - ACK bit</a></li>
        <li><a href="#i2c-b00000111-0x07---nack-bit">I2C b00000111 (0x07) - NACK bit</a></li>
        <li><a href="#i2c-b00001111-0x0f---start-bus-sniffer">I2C b00001111 (0x0F) - Start bus sniffer</a></li>
        <li><a href="#i2c-b0001xxxx-0x10-0x1f--bulk-i2c-write-send-1-16-bytes-01byte">I2C b0001xxxx (0x10-0x1F) – Bulk I2C write, send 1-16 bytes (0=1byte!)</a></li>
        <li><a href="#i2c-b0100wxyz-0x40-0x4f--configure-peripherals-wpower-xpullups-yaux-zcs">I2C b0100wxyz (0x40-0x4F) – Configure peripherals w=power, x=pullups, y=AUX, z=CS</a></li>
        <li><a href="#i2c-b011000xx-0x60-0x63---set-i2c-speed-3400khz-2100khz-150khz-05khz">I2C b011000xx (0x60-0x63) - Set I2C speed, 3=~400kHz, 2=~100kHz, 1=~50kHz, 0=~5kHz</a></li>
        <li><a href="#i2c-b00001000-0x08---write-then-read">I2C b00001000 (0x08) - Write then read</a></li>
        <li><a href="#i2c-b00001001-0x09-extended-aux-command">I2C b00001001 (0x09) Extended AUX command</a></li>
        <li><a href="#i2c-b11111110-0xfe---execute-buzz-commands">I2C b11111110 (0xFE) - Execute Buzz Commands</a></li>
      </ul>
    </li>
    <li><a href="#main-b00000011-0x03---enter-binary-uart-mode-responds-art1">MAIN b00000011 (0x03) - Enter binary UART mode, responds &ldquo;ART1&rdquo;</a>
      <ul>
        <li><a href="#uart-mode-key-points">UART Mode, Key points</a></li>
        <li><a href="#uart-b00000001-0x01--display-mode-version-string-responds-art1">UART b00000001 (0x01) – Display mode version string, responds &ldquo;ART1&rdquo;</a></li>
        <li><a href="#uart-b0000001x-0x02-0x03--start-0stop1-echo-uart-rx">UART b0000001x (0x02-0x03) – Start (0)/stop(1) echo UART RX</a></li>
        <li><a href="#uart-b00000111-0x07--manual-baud-rate-configuration-send-2-bytes">UART b00000111 (0x07) – Manual baud rate configuration, send 2 bytes</a></li>
        <li><a href="#uart-b00001111-0x0f---uart-bridge-mode-reset-to-exit">UART b00001111 (0x0F) - UART bridge mode (reset to exit)</a></li>
        <li><a href="#uart-b0001xxxx-0x10-0x1f--bulk-uart-write-send-1-16-bytes-01byte">UART b0001xxxx (0x10-0x1F) – Bulk UART write, send 1-16 bytes (0=1byte!)</a></li>
        <li><a href="#uart-b0100wxyz-0x40-0x4f--configure-peripherals-wpower-xpullups-yaux-zcs">UART b0100wxyz (0x40-0x4F) – Configure peripherals w=power, x=pullups, y=AUX, z=CS</a></li>
        <li><a href="#uart-b011000xx-0x60-0x63---set-uart-speed">UART b011000xx (0x60-0x63) - Set UART speed</a></li>
        <li><a href="#uart-b100wxxyz-0x80-0x9f--configure-uart-settings">UART b100wxxyz (0x80-0x9F) – Configure UART settings</a></li>
        <li><a href="#uart-b11111110-0xfe---execute-buzz-commands">UART b11111110 (0xFE) - Execute Buzz Commands</a></li>
      </ul>
    </li>
    <li><a href="#main-b00000100-0x04---enter-binary-1-wire-mode-responds-1w01">MAIN b00000100 (0x04) - Enter binary 1-Wire mode, responds &ldquo;1W01&rdquo;</a>
      <ul>
        <li><a href="#1-wire-mode-key-points">1-Wire Mode, Key points</a></li>
        <li><a href="#1-wire-b00000001-0x01--display-mode-version-string-responds-1w01">1-Wire b00000001 (0x01) – Display mode version string, responds &ldquo;1W01&rdquo;</a></li>
        <li><a href="#1-wire-b00000010-0x02--1-wire-reset">1-Wire b00000010 (0x02) – 1-Wire reset</a></li>
        <li><a href="#1-wire-b00000100-0x04--read-byte">1-Wire b00000100 (0x04) – Read byte</a></li>
        <li><a href="#1-wire-b00001000-0x08---rom-search-macro-0xf0">1-Wire b00001000 (0x08) - ROM search macro (0xF0)</a></li>
        <li><a href="#1-wire-b00001001-0x09---alarm-search-macro-0xec">1-Wire b00001001 (0x09) - ALARM search macro (0xEC)</a></li>
        <li><a href="#1-wire-b0001xxxx-0x10-0x1f--bulk-1-wire-write-send-1-16-bytes-01byte">1-Wire b0001xxxx (0x10-0x1F) – Bulk 1-Wire write, send 1-16 bytes (0=1byte!)</a></li>
        <li><a href="#1-wire-b0100wxyz-0x40-0x4f--configure-peripherals-wpower-xpullups-yaux-zcs">1-Wire b0100wxyz (0x40-0x4F) – Configure peripherals w=power, x=pullups, y=AUX, z=CS</a></li>
        <li><a href="#1-wire-b11111110-0xfe---execute-buzz-commands">1-Wire b11111110 (0xFE) - Execute Buzz Commands</a></li>
      </ul>
    </li>
    <li><a href="#main-b00000101-0x05---enter-binary-raw-wire-mode-responds-raw1">MAIN b00000101 (0x05) - Enter binary RAW-WIRE mode, responds &ldquo;RAW1&rdquo;</a>
      <ul>
        <li><a href="#raw-wire--mode-key-points">RAW-WIRE  Mode, Key points</a></li>
        <li><a href="#raw-wire--b00000001-0x01--display-mode-version-string-responds-raw1">RAW-WIRE  b00000001 (0x01) – Display mode version string, responds &ldquo;RAW1&rdquo;</a></li>
        <li><a href="#raw-wire--b0000001x-0x02-0x03---i2c-style-start-0--stop-1-bit">RAW-WIRE  b0000001x (0x02-0x03) - I2C-style start (0) / stop (1) bit</a></li>
        <li><a href="#raw-wire--b0000010x-0x04-0x05---cs-low-0--high-1">RAW-WIRE  b0000010x (0x04-0x05) - CS low (0) / high (1)</a></li>
        <li><a href="#raw-wire--b00000110-0x06---read-byte">RAW-WIRE  b00000110 (0x06) - Read byte</a></li>
        <li><a href="#raw-wire--b00000111-0x07---read-bit">RAW-WIRE  b00000111 (0x07) - Read bit</a></li>
        <li><a href="#raw-wire--b00001000-0x08---peek-at-input-pin">RAW-WIRE  b00001000 (0x08) - Peek at input pin</a></li>
        <li><a href="#raw-wire--b00001001-0x09---clock-tick">RAW-WIRE  b00001001 (0x09) - Clock Tick</a></li>
        <li><a href="#raw-wire--b0000101x-0x0a-0x0b---clock-low-0--high-1">RAW-WIRE  b0000101x (0x0A-0x0B) - Clock low (0) / high (1)</a></li>
        <li><a href="#raw-wire--b0000110x-0x0c-0x0d---data-low-0--high-1">RAW-WIRE  b0000110x (0x0C-0x0D) - Data low (0) / high (1)</a></li>
        <li><a href="#raw-wire--b0001xxxx-0x10-0x1f--bulk-transfer-send-1-16-bytes-01byte">RAW-WIRE  b0001xxxx (0x10-0x1F) – Bulk transfer, send 1-16 bytes (0=1byte!)</a></li>
        <li><a href="#raw-wire--b0010xxxx-0x20-0x2f---bulk-clock-ticks-send-1-16-ticks">RAW-WIRE  b0010xxxx (0x20-0x2F) - Bulk clock ticks, send 1-16 ticks</a></li>
        <li><a href="#raw-wire--b0011xxxx-0x30-0x3f---bulk-bits-send-1-8-bits-of-the-next-byte-01bit">RAW-WIRE  b0011xxxx (0x30-0x3F) - Bulk bits, send 1-8 bits of the next byte (0=1bit!)</a></li>
        <li><a href="#raw-wire--b0100wxyz-0x40-0x4f--configure-peripherals-wpower-xpullups-yaux-zcs">RAW-WIRE  b0100wxyz (0x40-0x4F) – Configure peripherals w=power, x=pullups, y=AUX, z=CS</a></li>
        <li><a href="#raw-wire--b011000xx-0x60-0x63---set-bus-speed-3400khz-2100khz-150khz-05khz">RAW-WIRE  b011000xx (0x60-0x63) - Set bus speed, 3=~400kHz, 2=~100kHz, 1=~50kHz, 0=~5kHz</a></li>
        <li><a href="#raw-wire--b1000wxyz-0x80-0x8f--config-whiz33v-x23wire-ymsblsb-znot-used">RAW-WIRE  b1000wxyz (0x80-0x8F) – Config, w=HiZ/3.3v, x=2/3wire, y=msb/lsb, z=not used</a></li>
        <li><a href="#raw-wire--b10100100-0xa4---pic-write-send-command--2-bytes-of-data-read-1-byte">RAW-WIRE  b10100100 (0xA4) - PIC write. Send command + 2 bytes of data, read 1 byte</a></li>
        <li><a href="#raw-wire--b10100101-0xa5---pic-read-send-command-read-1-byte-of-data">RAW-WIRE  b10100101 (0xA5) - PIC read. Send command, read 1 byte of data</a></li>
        <li><a href="#raw-wire-b11111110-0xfe---execute-buzz-commands">RAW-WIRE b11111110 (0xFE) - Execute Buzz Commands</a></li>
      </ul>
    </li>
    <li><a href="#main-b00000110-0x06---enter-openocd-jtag-mode">MAIN b00000110 (0x06) - Enter OpenOCD JTAG mode</a></li>
    <li><a href="#main-b00001010-0x0a---enter-buzz-mode">MAIN b00001010 (0x0A) - Enter Buzz mode</a>
      <ul>
        <li><a href="#buzz-b01101001-0x69---null-command">Buzz b01101001 (0x69) - NULL COMMAND</a></li>
        <li><a href="#buzz-b10010110-0x96---check-if-firmware-is-bpv3">Buzz b10010110 (0x96) - Check if firmware is BPv3</a></li>
        <li><a href="#buzz-b00000000-0x00---take-voltage-measurement-from-all-sources">Buzz b00000000 (0x00) - Take voltage measurement from all sources</a></li>
        <li><a href="#buzz-b00000001-0x01---tp0-input-low">Buzz b00000001 (0x01) - TP0 INPUT LOW</a></li>
        <li><a href="#buzz-b00000010-0x02---tp0-output-low">Buzz b00000010 (0x02) - TP0 OUTPUT LOW</a></li>
        <li><a href="#buzz-b00000011-0x03---read-tp0-status">Buzz b00000011 (0x03) - Read TP0 status</a></li>
        <li><a href="#buzz-b00010000-0x10---check-for-short-circuits-in-the-power-supply-units">Buzz b00010000 (0x10) - Check for short circuits in the power supply units</a></li>
        <li><a href="#buzz-b00010010-0x12---setup-pulse-width-modulation-requires-5-byte-setup">Buzz b00010010 (0x12) - Setup pulse-width modulation (requires 5 byte setup)</a></li>
        <li><a href="#buzz-b00010011-0x13---cleardisable-pwm">Buzz b00010011 (0x13) - Clear/disable PWM</a></li>
        <li><a href="#buzz-b00010100-0x14---take-voltage-probe-measurement-returns-2-bytes">Buzz b00010100 (0x14) - Take voltage probe measurement (returns 2 bytes)</a></li>
        <li><a href="#buzz-b00010101-0x15---continuous-voltage-probe-measurement">Buzz b00010101 (0x15) - Continuous voltage probe measurement</a></li>
        <li><a href="#buzz-b00010110-0x16---frequency-measurement-on-aux-pin">Buzz b00010110 (0x16) - Frequency measurement on AUX pin</a></li>
      </ul>
    </li>
    <li><a href="#main-b00001111-0x0f---reset-buzzpirat">MAIN b00001111 (0x0F) - Reset Buzzpirat</a></li>
    <li><a href="#main-b00010000-0x10---buzzpirat-short-self-test--b00010001-0x11-long-self-test">MAIN b00010000 (0x10) - Buzzpirat Short self-test &amp; b00010001 (0x11) Long self-test</a></li>
    <li><a href="#main-b00010010-0x12---setup-pulse-width-modulation-requires-5-byte-setup">MAIN b00010010 (0x12) - Setup pulse-width modulation (requires 5 byte setup)</a></li>
    <li><a href="#main-b00010011-0x13---cleardisable-pwm">MAIN b00010011 (0x13) - Clear/disable PWM</a></li>
    <li><a href="#main-b00010100-0x14---take-voltage-probe-measurement-returns-2-bytes">MAIN b00010100 (0x14) - Take voltage probe measurement (returns 2 bytes)</a></li>
    <li><a href="#main-b00010101-0x15---continuous-voltage-probe-measurement">MAIN b00010101 (0x15) - Continuous voltage probe measurement</a></li>
    <li><a href="#main-b00010110-0x16---frequency-measurement-on-aux-pin">MAIN b00010110 (0x16) - Frequency measurement on AUX pin</a></li>
    <li><a href="#main-b010xxxxx-0x40-0x5f---configure-pins-as-input1-or-output0-auxmosiclkmisocs">MAIN b010xxxxx (0x40-0x5F) - Configure pins as input(1) or output(0): AUX|MOSI|CLK|MISO|CS</a></li>
    <li><a href="#main-b1xxxxxxx-0x80-0xff---set-on-1-or-off-0-powerpullupauxmosiclkmisocs">MAIN b1xxxxxxx (0x80-0xFF) - Set on (1) or off (0): POWER|PULLUP|AUX|MOSI|CLK|MISO|CS</a></li>
    <li><a href="#adc-calculation">ADC Calculation</a>
      <ul>
        <li><a href="#python-3">Python 3</a></li>
        <li><a href="#c">C</a></li>
      </ul>
    </li>
    <li><a href="#pwm-computation">PWM Computation</a>
      <ul>
        <li><a href="#python-3-1">Python 3</a></li>
        <li><a href="#c-1">C</a></li>
      </ul>
    </li>
  </ul>
</nav>

<h2 id="main-b00000000-0x00---reset-responds-bbio1">MAIN b00000000 (0x00) - Reset, responds &ldquo;BBIO1&rdquo;</h2>
<p>This command resets the Buzzpirat into raw bitbang mode from the user terminal. It also resets to raw bitbang mode from raw SPI mode, or any other protocol mode. This command always returns a five byte bitbang version string &ldquo;BBIO1&rdquo;, where 1 is the current protocol version.</p>
<p>Some terminals send a NULL character (0x00) on start-up, causing the Buzzpirat to enter binary mode when it wasn&rsquo;t wanted. To get around this, you must now enter 0x00 at least 20 times to enter raw bitbang mode.</p>


<div class="alert alert-warning" role="alert">
<h4 class="alert-heading">Warning</h4>

    The Buzzpirat user terminal could be stuck in a configuration menu when your program attempts to enter binary mode. One way to ensure that you&rsquo;re at the command line is to send <enter> at least 10 times, and then send &lsquo;#&rsquo; to reset. Next, send 0x00 to the command line 20+ times until you get the BBIO1 string.

</div>

<p>After entering bitbang mode, you can enter other binary protocol modes.</p>
<h2 id="main-b00000001-0x01---enter-binary-spi-mode-responds-spi1">MAIN b00000001 (0x01) - Enter binary SPI mode, responds &ldquo;SPI1&rdquo;</h2>
<p>Commands are a single byte, except bulk SPI transfers. The Buzzpirat responds to SPI write commands with the data read from the SPI bus during the write. Most other commands return 0x01 for success, or 0x00 for failure/unknown command.</p>
<h3 id="spi-mode-key-points">SPI Mode, Key points</h3>
<ul>
<li>Send 0x00 to the user terminal (max.) 20 times to enter the raw binary bitbang mode. Pause briefly after sending each 0x00 to check if BBIO1 is returned. Example binary mode entry functions.</li>
<li>Enter 0x01 in bitbang mode to enter raw SPI mode.</li>
<li>Return to raw bitbang mode from raw SPI mode by sending 0x00 one time.</li>
<li>Operations that write a byte to the SPI bus also return a byte read from the SPI bus.</li>
<li>Hex values shown here, like 0x00, represent actual byte values; not typed ASCII entered into a terminal.</li>
</ul>
<p>Once you have successfully entered the mode, you can use the following commands:</p>
<h3 id="spi-b00000001-0x01---enter-raw-spi-mode-display-version-string">SPI b00000001 (0x01) - Enter raw SPI mode, display version string</h3>
<p>Once in raw bitbang mode, send 0x01 to enter raw SPI mode. The Buzzpirat responds &lsquo;SPI1&rsquo;, where 1 is the raw SPI protocol version. Get the version string at any time by sending 0x01 again.</p>
<h3 id="spi-b0000001x-0x02-0x03---cs-high-1-or-low-0">SPI b0000001x (0x02-0x03) - CS high (1) or low (0)</h3>
<p>Toggle the Buzzpirat chip select pin, follows HiZ configuration setting. CS high is pin output at 3.3volts, or HiZ. CS low is pin output at ground. Buzzpirat responds 0x01.</p>
<h3 id="spi-b000011xx-0x0c-0x0f---sniff-spi-traffic-when-cs-low10all01">SPI b000011xx (0x0C-0x0F) - Sniff SPI traffic when CS low(10)/all(01)</h3>
<p>The SPI sniffer is implemented in hardware and should work up to 10MHz. It follows the configuration settings you entered for SPI mode. The sniffer can read all traffic, or filter by the state of the CS pin.</p>
<ul>
<li>[/] - CS enable/disable</li>
<li>\xy - escape character (\) precedes two byte values X (MOSI pin) and Y (MISO pin)</li>
</ul>
<p>Sniffed traffic is encoded according to the table above. The two data bytes are escaped with the &lsquo;' character to help locate data in the stream.</p>
<p>Send the SPI sniffer command to start the sniffer, the Buzzpirat responds 0x01 then sniffed data starts to flow. Send any byte to exit.</p>
<p>If the sniffer can&rsquo;t keep with the SPI data, the MODE LED turns off and the sniff is aborted.</p>
<p>The sniffer follows the output clock edge and output polarity settings of the SPI mode, but not the input sample phase.</p>
<h3 id="spi-b0001xxxx-0x10-0x1f---bulk-spi-transfer-sendread-1-16-bytes-01byte">SPI b0001xxxx (0x10-0x1F) - Bulk SPI transfer, send/read 1-16 bytes (0=1byte!)</h3>
<p>Bulk SPI allows direct byte reads and writes. The Buzzpirat expects xxxx+1 data bytes. Up to 16 data bytes can be sent at once, each returns a byte read from the SPI bus during the write.</p>
<p>Note that 0000 indicates 1 byte because there&rsquo;s no reason to send 0. BP replies 0x01 to the bulk SPI command, and returns the value read from SPI after each data byte write.</p>
<p>The way it goes together:</p>
<ul>
<li>The upper 4 bit of the command byte are the bulk read command (0001xxxx)</li>
<li>xxxx = the number of bytes to read. 0000=1, 0001=2, etc, up to 1111=16</li>
</ul>
<p>If I want to read (0001) four bytes (0011=3=read 4) the full command is 00010011 (0001 + 0011 ). Convert from binary to hex and it is 0x13</p>
<h3 id="spi-b0100wxyz-0x40-0x4f---configure-peripherals-wpower-xpull-ups-yaux-zcs">SPI b0100wxyz (0x40-0x4F) - Configure peripherals w=power, x=pull-ups, y=AUX, z=CS</h3>
<p>Enable (1) and disable (0) Buzzpirat peripherals and pins. Bit w enables the power supplies, bit x toggles the on-board pull-up resistors, y sets the state of the auxiliary pin, and z sets the chip select pin. Features not present in a specific hardware version are ignored. Buzzpirat responds 0x01 on success.</p>


<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">Note</h4>

    CS pin always follows the current HiZ pin configuration. AUX is always a normal pin output (0=GND, 1=3.3volts)

</div>

<h3 id="spi-b01100xxx-0x60-0x67---spi-speed">SPI b01100xxx (0x60-0x67) - SPI speed</h3>
<p>000=30kHz, 001=125kHz, 010=250kHz, 011=1MHz, 100=2MHz, 101=2.6MHz, 110=4MHz, 111=8MHz</p>
<p>This command sets the SPI bus speed according to the values shown. Default startup speed is 000 (30kHz).</p>
<h3 id="spi-b1000wxyz-0x80-0x8f---spi-config-whiz33v-xckp-idle-ycke-edge-zsmp-sample">SPI b1000wxyz (0x80-0x8F) - SPI config, w=HiZ/3.3v, x=CKP idle, y=CKE edge, z=SMP sample</h3>
<p>This command configures the SPI settings. Options and start-up defaults are the same as the user terminal SPI mode. w= pin output HiZ(0)/3.3v(1), x=CKP clock idle phase (low=0), y=CKE clock edge (active to idle=1), z=SMP sample time (middle=0). The Buzzpirat responds 0x01 on success.</p>
<p>Default raw SPI startup condition is 0010. HiZ mode configuration applies to the SPI pins and the CS pin, but not the AUX pin. See the PIC24FJ64GA002 datasheet and the SPI section of the PIC24 family manual for more about the SPI configuration settings.</p>
<h3 id="spi-b00000100-0x04---write-then-read--b00000101-0x05---write-then-read-no-cs">SPI b00000100 (0x04) - Write then read &amp; b00000101 (0x05) - Write then read, no CS</h3>
<p>This command was developed to help speed ROM programming with Flashrom, asprogrammer dreg mod. It might be helpful for a lot of common SPI operations.</p>
<ul>
<li>b00000100 - Write then read: It enables chip select, writes 0-4096 bytes, reads 0-4096 bytes, then disables chip select.</li>
<li>b00000101 - Write then read, no CS: writes 0-4096 bytes, reads 0-4096 bytes (CS transitions are NOT automated/included).</li>
</ul>
<p>All data for this command can be sent at once, and it will be buffered in the Buzzpirat. The write and read operations happen all at once, and the read data is buffered. At the end of the operation, the read data is returned from the buffer. The goal is to meet the stringent timing requirements of some ROM chips by buffering everything instead of letting the serial port delay things.</p>
<p>Write then read command format:</p>
<ol>
<li>send 1 byte: b00000100 (Write then read command) or b00000101 (Write then read, no CS)</li>
<li>send 2 bytes: number of write bytes 0-4096 (first byte High8, second Low8)</li>
<li>send 2 bytes: number of read bytes 0-4096 (first byte High8, second Low8)</li>
<li>If the number of bytes to read or write are out of bounds, the Buzzpirat will send 0x00 now</li>
<li>send 0-4096 bytes: bytes to write (specified by step 2)</li>
<li>read 1 byte: success/0x01</li>
<li>read 0-4096 bytes: bytes to read (specified by step 3)</li>
</ol>
<p>Key Points:</p>
<ul>
<li>There is no acknowledgment that a byte is received.</li>
<li>All write bytes are sent at once (before that CS goes low for b00000100 - Write then read command)</li>
<li>Read starts immediately, all bytes are put into a buffer at max SPI speed (no waiting for UART)</li>
<li>At the end of the read, CS goes high for b00000100 - Write then read command</li>
</ul>
<h3 id="spi-b00000110-0x06---avr-extended-commands">SPI b00000110 (0x06) - AVR Extended Commands</h3>
<ul>
<li>b00000000 (0x00) - Null operation - verifies extended commands are available.</li>
<li>b00000001 (0x01) - Return version (2 bytes)</li>
<li>b00000010 (0x02) - Bulk Memory Read from Flash</li>
</ul>
<h3 id="spi-b11111110-0xfe---execute-buzz-commands">SPI b11111110 (0xFE) - Execute Buzz Commands</h3>
<p>Buzz Commands allows for actions such as reading all voltages (similar to the &lsquo;v&rsquo; command), manipulating the TP0 pin, etc.</p>
<p>You have access to the same commands as when you enter Buzz Mode using 0x0A. A list of the supported commands is available further below.</p>
<p>Buzzpirat returns 0x01 if it has successfully entered this mode.</p>
<h4 id="spi-buzz-commands-0x97-0xff">SPI Buzz Commands (0x97-0xFF)</h4>
<p>Each protocol has reserved the range from 0x97 to 0xFF for protocol-specific Buzz commands. However, none have been defined for this protocol yet.</p>
<hr>
<h2 id="main-b00000010-0x02---enter-binary-i2c-mode-responds-i2c1">MAIN b00000010 (0x02) - Enter binary I2C mode, responds &ldquo;I2C1&rdquo;</h2>
<p>Enter binary I2C mode by first entering bitbang mode, then send 0x02 to enter I2C mode.</p>
<p>Most I2C mode commands are a single byte. Commands generally return 1 for success, 0 for failure.</p>
<h3 id="i2c-mode-key-points">I2C Mode, Key points</h3>
<ul>
<li>Send 0x00 to the user terminal (max.) 20 times to enter the raw binary bitbang mode. Pause briefly after sending each 0x00 to check if BBIO1 is returned. Example binary mode entry functions.</li>
<li>Enter 0x02 in bitbang mode to enter raw I2C mode.</li>
<li>Return to raw bitbang mode from raw I2C mode by sending 0x00 one time.</li>
<li>Hex values shown here, like 0x00, represent actual byte values; not typed ASCII entered into a terminal.</li>
</ul>
<p>Once you have successfully entered the mode, you can use the following commands:</p>
<h3 id="i2c-b00000001-0x01--display-mode-version-string-responds-i2c1">I2C b00000001 (0x01) – Display mode version string, responds &ldquo;I2C1&rdquo;</h3>
<p>Once in binary I2C mode, send 0x01 to get the current mode version string. The Buzzpirat responds ‘I2C1’, where x is the raw I2C protocol version (currently 1). Get the version string at any time by sending 0x01 again. This command is the same in all binary modes, the current mode can always be determined by sending 0x01.</p>
<h3 id="i2c-b00000010-0x02--i2c-start-bit">I2C b00000010 (0x02) – I2C start bit</h3>
<p>Send an I2C start bit. Responds 0x01.</p>
<h3 id="i2c-b00000011-0x03---i2c-stop-bit">I2C b00000011 (0x03) - I2C stop bit</h3>
<p>Send an I2C stop bit. Responds 0x01.</p>
<h3 id="i2c-b00000100-0x04---i2c-read-byte">I2C b00000100 (0x04) - I2C Read Byte</h3>
<p>Reads a byte from the I2C bus and returns the byte. You must manually ACK or NACK each byte!</p>
<h3 id="i2c-b00000110-0x06---ack-bit">I2C b00000110 (0x06) - ACK bit</h3>
<p>Send an I2C ACK bit after reading a byte. Tells a slave device that you will read another byte. Responds 0x01.</p>
<h3 id="i2c-b00000111-0x07---nack-bit">I2C b00000111 (0x07) - NACK bit</h3>
<p>Send an I2C NACK bit after reading a byte. Tells a slave device that you will stop reading, next bit should be an I2C stop bit. Responds 0x01.</p>
<h3 id="i2c-b00001111-0x0f---start-bus-sniffer">I2C b00001111 (0x0F) - Start bus sniffer</h3>
<p>Sniff traffic on an I2C bus.</p>
<ul>
<li>[/] - Start/stop bit</li>
<li>\ - escape character precedes a data byte value</li>
<li>+/- - ACK/NACK</li>
</ul>
<p>Sniffed traffic is encoded according to the table above. Data bytes are escaped with the &lsquo;' character. Send a single byte to exit, Buzzpirat responds 0x01 on exit.</p>
<h3 id="i2c-b0001xxxx-0x10-0x1f--bulk-i2c-write-send-1-16-bytes-01byte">I2C b0001xxxx (0x10-0x1F) – Bulk I2C write, send 1-16 bytes (0=1byte!)</h3>
<p>Bulk I2C allows multi-byte writes. The Buzzpirat expects xxxx+1 data bytes. Up to 16 data bytes can be sent at once. Note that 0000 indicates 1 byte because there’s no reason to send 0.</p>
<p>BP replies 0x01 to the bulk I2C command. After each data byte the Buzzpirat returns the ACK (0x00) or NACK (0x01) bit from the slave device.</p>
<h3 id="i2c-b0100wxyz-0x40-0x4f--configure-peripherals-wpower-xpullups-yaux-zcs">I2C b0100wxyz (0x40-0x4F) – Configure peripherals w=power, x=pullups, y=AUX, z=CS</h3>
<p>Enable (1) and disable (0) Buzzpirat peripherals and pins. Bit w enables the power supplies, bit x toggles the on-board pull-up resistors, y sets the state of the auxiliary pin, and z sets the chip select pin. Features not present in a specific hardware version are ignored. Buzzpirat responds 0x01 on success.</p>


<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">Note</h4>

    CS pin always follows the current HiZ pin configuration. AUX is always a normal pin output (0=GND, 1=3.3volts)

</div>

<h3 id="i2c-b011000xx-0x60-0x63---set-i2c-speed-3400khz-2100khz-150khz-05khz">I2C b011000xx (0x60-0x63) - Set I2C speed, 3=~400kHz, 2=~100kHz, 1=~50kHz, 0=~5kHz</h3>
<p>0110000x - Set I2C speed, 1=high (50kHz) 0=low (5kHz)</p>
<p>The lower bits of the speed command determine the I2C bus speed. Binary mode currently uses the software I2C library, though it may be configurable in a future update. Startup default is high-speed. Buzzpirat responds 0x01 on success.</p>
<h3 id="i2c-b00001000-0x08---write-then-read">I2C b00001000 (0x08) - Write then read</h3>
<p>This command internally sends I2C start, writes from 0-4096 bytes, then reads 0-4096 bytes into the Buzzpirats internal buffer, ACKing each byte internally until the final byte at which point it sends an NACK stop bit.</p>
<p>All data for this command can be sent at once, and it will be buffered in the Buzzpirat. The write and read operations happen once the completed command has been passed to the Buzzpirat. Any write data is internally buffered by the Buzzpirat. At the end of the operation, any read data is returned from the buffer, be aware that the write buffer is re-used as the read buffer, as such any write data needs to be re-loaded if the command is re-executed.</p>
<p>Write then read command format:</p>
<ol>
<li>send 1 byte: b00001000 (Write then read command)</li>
<li>send 2 bytes: number of write bytes 0-4096 (first byte High8, second Low8)</li>
<li>send 2 bytes: number of read bytes 0-4096 (first byte High8, second Low8)</li>
<li>If the number of bytes to read or write are out of bounds, the Buzzpirat will send 0x00 now</li>
<li>send 0-4096 bytes: bytes to write (specified by step 2. The initial byte can serve as the I2C address. Therefore, in step 2, it&rsquo;s necessary to specify at least one byte for writing).</li>
<li>read 1 byte: success/0x01, would be 0x00 If an I2C write is not ACKed by a slave device, then the operation will abort.</li>
<li>read 0-4096 bytes: bytes to read (specified by step 3).</li>
</ol>
<p>Key points:</p>
<ul>
<li>The Buzzpirat sends an I2C start bit, then all write bytes are sent at once.</li>
<li>All read bytes are ACKed, except the last byte which is NACKed, this process is handled internally between the Buzzpirat and the I2C device.</li>
<li>At the end of the read process, the Buzzpirat sends an I2C stop</li>
<li>Except as described above, there is no acknowledgment that a byte is received.</li>
</ul>
<h3 id="i2c-b00001001-0x09-extended-aux-command">I2C b00001001 (0x09) Extended AUX command</h3>
<p>Provides extended use of AUX pin. Requires one command byte. Buzzpirat acknowledges 0x01.</p>
<p>Command	Function</p>
<ul>
<li>b00000000 (0x00) - AUX/CS low</li>
<li>b00000001 (0x01) - AUX/CS high</li>
<li>b00000010 (0x02) - AUX/CS HiZ</li>
<li>b00000011 (0x03) - AUX read</li>
<li>b00010000 (0x10) - use AUX</li>
<li>b00100000 (0x20) - use CS</li>
</ul>
<h3 id="i2c-b11111110-0xfe---execute-buzz-commands">I2C b11111110 (0xFE) - Execute Buzz Commands</h3>
<p>Buzz Commands allows for actions such as reading all voltages (similar to the &lsquo;v&rsquo; command), manipulating the TP0 pin, etc.</p>
<p>You have access to the same commands as when you enter Buzz Mode using 0x0A. A list of the supported commands is available further below (the first one is 0x00)</p>
<p>Buzzpirat returns 0x01 if it has successfully entered this mode.</p>
<h4 id="i2c-buzz-commands-0x97-0xff">I2C Buzz Commands (0x97-0xFF)</h4>
<p>Each protocol has reserved the range from 0x97 to 0xFF for protocol-specific Buzz commands. However, none have been defined for this protocol yet.</p>
<hr>
<h2 id="main-b00000011-0x03---enter-binary-uart-mode-responds-art1">MAIN b00000011 (0x03) - Enter binary UART mode, responds &ldquo;ART1&rdquo;</h2>
<p>Enter binary UART mode by first entering bitbang mode, then send 0x03 to enter UART mode.</p>
<p>Most UART mode commands are a single byte. Commands generally return 1 for success, 0 for failure.</p>
<h3 id="uart-mode-key-points">UART Mode, Key points</h3>
<ul>
<li>Send 0x00 to the user terminal (max.) 20 times to enter the raw binary bitbang mode. Pause briefly after sending each 0x00 to check if BBIO1 is returned. Example binary mode entry functions.</li>
<li>Enter 0x03 in bitbang mode to enter raw UART mode.</li>
<li>Return to raw bitbang mode from raw UART mode by sending 0x00 one time.</li>
<li>Hex values shown here, like 0x00, represent actual byte values; not typed ASCII entered into a terminal.</li>
</ul>
<p>Once you have successfully entered the mode, you can use the following commands:</p>
<h3 id="uart-b00000001-0x01--display-mode-version-string-responds-art1">UART b00000001 (0x01) – Display mode version string, responds &ldquo;ART1&rdquo;</h3>
<p>Once in binary UART mode, send 0x01 to get the current mode version string. The Buzzpirat responds ‘ART1’, where 1 is the raw UART protocol version. Get the version string at any time by sending 0x01 again. This command is the same in all binary modes, the current mode can always be determined by sending 0x01.</p>
<h3 id="uart-b0000001x-0x02-0x03--start-0stop1-echo-uart-rx">UART b0000001x (0x02-0x03) – Start (0)/stop(1) echo UART RX</h3>
<p>In binary UART mode the UART is always active and receiving. Incoming data is only copied to the USB side if UART RX echo is enabled. This allows you to configure and control the UART mode settings without random data colliding with response codes. UART mode starts with echo disabled. This mode has no impact on data transmissions.</p>
<p>Responds 0x01. Clears buffer overrun bit.</p>
<h3 id="uart-b00000111-0x07--manual-baud-rate-configuration-send-2-bytes">UART b00000111 (0x07) – Manual baud rate configuration, send 2 bytes</h3>
<p>Configures the UART using custom baud rate generator settings. This command is followed by two data bytes that represent the BRG register value. Send the high 8 bits first, then the low 8 bits.</p>
<p>Use the UART manual or an online calculator to find the correct value (key values: fosc 32mHz, clock divider = 2, BRGH=1) . Buzzpirat responds 0x01 to each byte. Settings take effect immediately.</p>
<h3 id="uart-b00001111-0x0f---uart-bridge-mode-reset-to-exit">UART b00001111 (0x0F) - UART bridge mode (reset to exit)</h3>
<p>Starts a transparent UART bridge using the current configuration. Unplug the Buzzpirat to exit.</p>
<h3 id="uart-b0001xxxx-0x10-0x1f--bulk-uart-write-send-1-16-bytes-01byte">UART b0001xxxx (0x10-0x1F) – Bulk UART write, send 1-16 bytes (0=1byte!)</h3>
<p>Bulk UART allows multi-byte writes. The Buzzpirat expects xxxx+1 data bytes. Up to 16 data bytes can be sent at once. Note that 0000 indicates 1 byte because there’s no reason to send 0. Buzzpirat replies 0x01 to each byte.</p>
<h3 id="uart-b0100wxyz-0x40-0x4f--configure-peripherals-wpower-xpullups-yaux-zcs">UART b0100wxyz (0x40-0x4F) – Configure peripherals w=power, x=pullups, y=AUX, z=CS</h3>
<p>Enable (1) and disable (0) Buzzpirat peripherals and pins. Bit w enables the power supplies, bit x toggles the on-board pull-up resistors, y sets the state of the auxiliary pin, and z sets the chip select pin. Features not present in a specific hardware version are ignored. Buzzpirat responds 0x01 on success.</p>


<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">Note</h4>

    CS pin always follows the current HiZ pin configuration. AUX is always a normal pin output (0=GND, 1=3.3volts)

</div>

<h3 id="uart-b011000xx-0x60-0x63---set-uart-speed">UART b011000xx (0x60-0x63) - Set UART speed</h3>
<p>Set the UART at a preconfigured speed value: 0000=300, 0001=1200, 0010=2400,0011=4800,0100=9600,0101=19200,0110=31250 (MIDI), 0111=38400,1000=57600,1010=115200</p>
<p>Start default is 300 baud. Buzzpirat responds 0x01 on success. A read command is planned but not implemented in this version.</p>
<h3 id="uart-b100wxxyz-0x80-0x9f--configure-uart-settings">UART b100wxxyz (0x80-0x9F) – Configure UART settings</h3>
<ul>
<li>w=pin output HiZ(0)/3.3v(1)</li>
<li>xx=databits and parity 8/N(0), 8/E(1), 8/O(2), 9/N(3)</li>
<li>y=stop bits 1(0)/2(1)</li>
<li>z=RX polarity idle 1 (0), idle 0 (1)</li>
</ul>
<p>Startup default is 00000. Buzzpirat responds 0x01 on success. A read command is planned but not implemented in this version.</p>


<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">Note</h4>

    that this command code is three bits because the databits and parity setting consists of two bits. It is not quite the same as the binary SPI mode configuration command code.

</div>

<h3 id="uart-b11111110-0xfe---execute-buzz-commands">UART b11111110 (0xFE) - Execute Buzz Commands</h3>
<p>Buzz Commands allows for actions such as reading all voltages (similar to the &lsquo;v&rsquo; command), manipulating the TP0 pin, etc.</p>
<p>You have access to the same commands as when you enter Buzz Mode using 0x0A. A list of the supported commands is available further below (the first one is 0x00)</p>
<p>Buzzpirat returns 0x01 if it has successfully entered this mode.</p>
<h4 id="uart-buzz-commands-0x97-0xff">UART Buzz Commands (0x97-0xFF)</h4>
<p>Each protocol has reserved the range from 0x97 to 0xFF for protocol-specific Buzz commands. However, none have been defined for this protocol yet.</p>
<hr>
<h2 id="main-b00000100-0x04---enter-binary-1-wire-mode-responds-1w01">MAIN b00000100 (0x04) - Enter binary 1-Wire mode, responds &ldquo;1W01&rdquo;</h2>
<p>Enter binary 1-Wire mode by first entering bitbang mode, then send 0x04 to enter 1-Wire mode.
Most 1-Wire mode commands are a single byte. Commands generally return 1 for success, 0 for failure.</p>
<h3 id="1-wire-mode-key-points">1-Wire Mode, Key points</h3>
<ul>
<li>Send 0x00 to the user terminal (max.) 20 times to enter the raw binary bitbang mode. Pause briefly after sending each 0x00 to check if BBIO1 is returned. Example binary mode entry functions.</li>
<li>Enter 0x04 in bitbang mode to enter raw 1-Wire mode.</li>
<li>Return to raw bitbang mode from raw 1-Wire mode by sending 0x00 one time.</li>
<li>Hex values shown here, like 0x00, represent actual byte values; not typed ASCII entered into a terminal.</li>
</ul>
<p>Once you have successfully entered the mode, you can use the following commands:</p>
<h3 id="1-wire-b00000001-0x01--display-mode-version-string-responds-1w01">1-Wire b00000001 (0x01) – Display mode version string, responds &ldquo;1W01&rdquo;</h3>
<p>Once in binary 1-Wire mode, send 0x01 to get the current mode version string. The Buzzpirat responds ‘1W01’, where 1 is the raw 1-Wire protocol version. Get the version string at any time by sending 0x01 again. This command is the same in all binary modes, the current mode can always be determined by sending 0x01.</p>
<h3 id="1-wire-b00000010-0x02--1-wire-reset">1-Wire b00000010 (0x02) – 1-Wire reset</h3>
<p>Send a 1-Wire reset. Responds 0x01.</p>
<h3 id="1-wire-b00000100-0x04--read-byte">1-Wire b00000100 (0x04) – Read byte</h3>
<p>Reads a byte from the bus, returns the byte.</p>
<h3 id="1-wire-b00001000-0x08---rom-search-macro-0xf0">1-Wire b00001000 (0x08) - ROM search macro (0xF0)</h3>
<h3 id="1-wire-b00001001-0x09---alarm-search-macro-0xec">1-Wire b00001001 (0x09) - ALARM search macro (0xEC)</h3>
<p>Search macros are special 1-Wire procedures that determine device addresses. The command returns 0x01, and then each 8-byte 1-Wire address located. Data ends with 8 bytes of 0xff.</p>
<h3 id="1-wire-b0001xxxx-0x10-0x1f--bulk-1-wire-write-send-1-16-bytes-01byte">1-Wire b0001xxxx (0x10-0x1F) – Bulk 1-Wire write, send 1-16 bytes (0=1byte!)</h3>
<p>Bulk write transfers a packet of xxxx+1 bytes to the 1-Wire bus. Up to 16 data bytes can be sent at once. Note that 0000 indicates 1 byte because there’s no reason to send 0. BP replies 0x01 to each byte.</p>
<h3 id="1-wire-b0100wxyz-0x40-0x4f--configure-peripherals-wpower-xpullups-yaux-zcs">1-Wire b0100wxyz (0x40-0x4F) – Configure peripherals w=power, x=pullups, y=AUX, z=CS</h3>
<p>Enable (1) and disable (0) Buzzpirat peripherals and pins. Bit w enables the power supplies, bit x toggles the on-board pull-up resistors, y sets the state of the auxiliary pin, and z sets the chip select pin. Features not present in a specific hardware version are ignored. Buzzpirat responds 0x01 on success.</p>


<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">Note</h4>

    CS pin always follows the current HiZ pin configuration. AUX is always a normal pin output (0=GND, 1=3.3volts)

</div>

<h3 id="1-wire-b11111110-0xfe---execute-buzz-commands">1-Wire b11111110 (0xFE) - Execute Buzz Commands</h3>
<p>Buzz Commands allows for actions such as reading all voltages (similar to the &lsquo;v&rsquo; command), manipulating the TP0 pin, etc.</p>
<p>You have access to the same commands as when you enter Buzz Mode using 0x0A. A list of the supported commands is available further below (the first one is 0x00)</p>
<p>Buzzpirat returns 0x01 if it has successfully entered this mode.</p>
<h4 id="1-wire-buzz-commands-0x97-0xff">1-Wire Buzz Commands (0x97-0xFF)</h4>
<p>Each protocol has reserved the range from 0x97 to 0xFF for protocol-specific Buzz commands. However, none have been defined for this protocol yet.</p>
<hr>
<h2 id="main-b00000101-0x05---enter-binary-raw-wire-mode-responds-raw1">MAIN b00000101 (0x05) - Enter binary RAW-WIRE mode, responds &ldquo;RAW1&rdquo;</h2>
<p>Enter binary RAW-WIRE  mode by first entering bitbang mode, then send 0x05 to enter RAW2WIRE mode.</p>
<p>Most RAW-WIRE  mode commands are a single byte. Commands generally return 1 for success, 0 for failure.</p>
<h3 id="raw-wire--mode-key-points">RAW-WIRE  Mode, Key points</h3>
<ul>
<li>Send 0x00 to the user terminal (max.) 20 times to enter the raw binary bitbang mode. Pause briefly after sending each 0x00 to check if BBIO1 is returned.</li>
<li>Enter 0x05 in bitbang mode to enter raw RAW-WIRE  mode.</li>
<li>Return to raw bitbang mode from raw RAW-WIRE  mode by sending 0x00 one time.</li>
<li>Hex values shown here, like 0x00, represent actual byte values; not typed ASCII entered into a terminal.</li>
</ul>
<p>Once you have successfully entered the mode, you can use the following commands:</p>
<h3 id="raw-wire--b00000001-0x01--display-mode-version-string-responds-raw1">RAW-WIRE  b00000001 (0x01) – Display mode version string, responds &ldquo;RAW1&rdquo;</h3>
<p>Once in binary RAW-WIRE  mode, send 0x01 to get the current mode version string. The Buzzpirat responds ‘RAW1’, where 1 is the raw RAW-WIRE  protocol version. Get the version string at any time by sending 0x01 again. This command is the same in all binary modes, the current mode can always be determined by sending 0x01.</p>
<h3 id="raw-wire--b0000001x-0x02-0x03---i2c-style-start-0--stop-1-bit">RAW-WIRE  b0000001x (0x02-0x03) - I2C-style start (0) / stop (1) bit</h3>
<p>Send an I2C start or stop bit. Responds 0x01. Useful for I2C-like 2-wire protocols, or building a custom implementation of I2C using the raw-wire library.</p>
<h3 id="raw-wire--b0000010x-0x04-0x05---cs-low-0--high-1">RAW-WIRE  b0000010x (0x04-0x05) - CS low (0) / high (1)</h3>
<p>Toggle the Buzzpirat chip select pin, follows HiZ configuration setting. CS high is pin output at 3.3volts, or HiZ. CS low is pin output at ground. Buzzpirat responds 0x01.</p>
<h3 id="raw-wire--b00000110-0x06---read-byte">RAW-WIRE  b00000110 (0x06) - Read byte</h3>
<p>Reads a byte from the bus, returns the byte. Writes 0xff to bus in 3-wire mode.</p>
<h3 id="raw-wire--b00000111-0x07---read-bit">RAW-WIRE  b00000111 (0x07) - Read bit</h3>
<p>Read a single bit from the bus, returns the bit value.</p>
<h3 id="raw-wire--b00001000-0x08---peek-at-input-pin">RAW-WIRE  b00001000 (0x08) - Peek at input pin</h3>
<p>Returns the state of the data input pin without sending a clock tick.</p>
<h3 id="raw-wire--b00001001-0x09---clock-tick">RAW-WIRE  b00001001 (0x09) - Clock Tick</h3>
<p>Sends one clock tick (low-&gt;high-&gt;low). Responds 0x01.</p>
<h3 id="raw-wire--b0000101x-0x0a-0x0b---clock-low-0--high-1">RAW-WIRE  b0000101x (0x0A-0x0B) - Clock low (0) / high (1)</h3>
<p>Set clock signal low or high. Responds 0x01.</p>
<h3 id="raw-wire--b0000110x-0x0c-0x0d---data-low-0--high-1">RAW-WIRE  b0000110x (0x0C-0x0D) - Data low (0) / high (1)</h3>
<p>Set data signal low or high. Responds 0x01.</p>
<h3 id="raw-wire--b0001xxxx-0x10-0x1f--bulk-transfer-send-1-16-bytes-01byte">RAW-WIRE  b0001xxxx (0x10-0x1F) – Bulk transfer, send 1-16 bytes (0=1byte!)</h3>
<p>Bulk write transfers a packet of xxxx+1 bytes to the bus. Up to 16 data bytes can be sent at once. Note that 0000 indicates 1 byte because there’s no reason to send 0. BP replies 0x01 to each byte in 2wire mode, returns the bus read in 3wire (SPI) mode.</p>
<h3 id="raw-wire--b0010xxxx-0x20-0x2f---bulk-clock-ticks-send-1-16-ticks">RAW-WIRE  b0010xxxx (0x20-0x2F) - Bulk clock ticks, send 1-16 ticks</h3>
<p>Create bulk clock ticks on the bus. Note that 0000 indicates 1 clock tick because there’s no reason to send 0. BP replies 0x01.</p>
<h3 id="raw-wire--b0011xxxx-0x30-0x3f---bulk-bits-send-1-8-bits-of-the-next-byte-01bit">RAW-WIRE  b0011xxxx (0x30-0x3F) - Bulk bits, send 1-8 bits of the next byte (0=1bit!)</h3>
<p>Bulk bits sends xxxx+1 bits of the next byte to the bus. Up to 8 data bytes can be sent at once. Note that 0000 indicates 1 byte because there’s no reason to send 0. BP replies 0x01 to each byte.</p>
<p>This is a PIC programming extension that only supports 2wire mode. All writes are most significant bit first, regardless of the mode set with the configuration command.</p>
<h3 id="raw-wire--b0100wxyz-0x40-0x4f--configure-peripherals-wpower-xpullups-yaux-zcs">RAW-WIRE  b0100wxyz (0x40-0x4F) – Configure peripherals w=power, x=pullups, y=AUX, z=CS</h3>
<p>Enable (1) and disable (0) Buzzpirat peripherals and pins. Bit w enables the power supplies, bit x toggles the on-board pull-up resistors, y sets the state of the auxiliary pin, and z sets the chip select pin. Features not present in a specific hardware version are ignored. Buzzpirat responds 0x01 on success.</p>


<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">Note</h4>

    CS pin always follows the current HiZ pin configuration. AUX is always a normal pin output (0=GND, 1=3.3volts)

</div>

<h3 id="raw-wire--b011000xx-0x60-0x63---set-bus-speed-3400khz-2100khz-150khz-05khz">RAW-WIRE  b011000xx (0x60-0x63) - Set bus speed, 3=~400kHz, 2=~100kHz, 1=~50kHz, 0=~5kHz</h3>
<p>The last bit of the speed command determines the bus speed. Startup default is high-speed. Buzzpirat responds 0x01.</p>
<h3 id="raw-wire--b1000wxyz-0x80-0x8f--config-whiz33v-x23wire-ymsblsb-znot-used">RAW-WIRE  b1000wxyz (0x80-0x8F) – Config, w=HiZ/3.3v, x=2/3wire, y=msb/lsb, z=not used</h3>
<p>Configure the raw-wire mode settings. w= pin output type HiZ(0)/3.3v(1). x= protocol wires (0=2, 1=3), toggles between a shared input/output pin (raw2wire), and a separate input pin (raw3wire). y= bit order (0=MSB, 1=LSB). The Buzzpirat responds 0x01 on success.</p>
<p>Default raw startup condition is 000z. HiZ mode configuration applies to the data pins and the CS pin, but not the AUX pin.</p>
<h3 id="raw-wire--b10100100-0xa4---pic-write-send-command--2-bytes-of-data-read-1-byte">RAW-WIRE  b10100100 (0xA4) - PIC write. Send command + 2 bytes of data, read 1 byte</h3>
<p>An extension for programming PIC microcontrollers. Writes 20bits to the 2wire interface.</p>
<p>Payload is three bytes.</p>
<p>The first byte is XXYYYYYY, where XX are the delay in MS to hold the PGC pin high on the last command bit, this is a delay required at the end of a page write. YYYYYY is a 4 or 6 bit ICSP programming command to send to the PIC (enter 4 bit commands as 00YYYY, commands clocked in LSB first).</p>
<p>The second and third bytes are 16bit instructions to execute on the PIC.</p>
<p>See the PIC 16F/18F programming specifications for more about ICSP.</p>
<h3 id="raw-wire--b10100101-0xa5---pic-read-send-command-read-1-byte-of-data">RAW-WIRE  b10100101 (0xA5) - PIC read. Send command, read 1 byte of data</h3>
<p>An extension for programming PIC microcontrollers. Writes 12bits, reads 8bits.</p>
<p>Payload is one byte 00YYYYYY, where YYYYYY is a 4 or 6 bit ICSP programming command to send to the PIC. Enter 4 bit commands as 00YYYY, all commands are clocked in LSB first.</p>
<p>The Buzzpirat send the 4/6bit command, then 8 &lsquo;0&rsquo; bits, then reads one byte. The read byte is returned.</p>
<p>See the PIC 16F/18F programming specifications for more about ICSP.</p>
<h3 id="raw-wire-b11111110-0xfe---execute-buzz-commands">RAW-WIRE b11111110 (0xFE) - Execute Buzz Commands</h3>
<p>Buzz Commands allows for actions such as reading all voltages (similar to the &lsquo;v&rsquo; command), manipulating the TP0 pin, etc.</p>
<p>You have access to the same commands as when you enter Buzz Mode using 0x0A. A list of the supported commands is available further below (the first one is 0x00)</p>
<p>Buzzpirat returns 0x01 if it has successfully entered this mode.</p>
<h4 id="raw-wire-buzz-commands-0x97-0xff">RAW-WIRE Buzz Commands (0x97-0xFF)</h4>
<p>Each protocol has reserved the range from 0x97 to 0xFF for protocol-specific Buzz commands. However, none have been defined for this protocol yet.</p>
<hr>
<h2 id="main-b00000110-0x06---enter-openocd-jtag-mode">MAIN b00000110 (0x06) - Enter OpenOCD JTAG mode</h2>
<p>OpenOCD mode is documented in the source only.</p>
<hr>
<h2 id="main-b00001010-0x0a---enter-buzz-mode">MAIN b00001010 (0x0A) - Enter Buzz mode</h2>
<p>This mode is exclusive to Buzzpirat and allows for actions such as reading all voltages (similar to the &lsquo;v&rsquo; command), manipulating the TP0 pin, etc.</p>
<p>Buzzpirat returns 0x01 if it has successfully entered this mode.</p>
<p>Once you have successfully entered to the Buzz mode via b00001010 (0x0A) (from the main bitbang) or via b11111110 (0xFE) (from a protocol mode), you can use the following Buzz mode commands:</p>
<h3 id="buzz-b01101001-0x69---null-command">Buzz b01101001 (0x69) - NULL COMMAND</h3>
<p>This command doesn&rsquo;t do anything; it does not return any response. It is designed for when you only want to check if the Buzz mode exists and don&rsquo;t want to execute anything.</p>
<h3 id="buzz-b10010110-0x96---check-if-firmware-is-bpv3">Buzz b10010110 (0x96) - Check if firmware is BPv3</h3>
<p>For each firmware version, I also generate a firmware that is 100% compatible with the Bus Pirate v3 hardware.</p>
<ul>
<li>
<p>returns 0x01 if the firmware currently running is the version for BPv3 hardware.</p>
</li>
<li>
<p>returns 0x00 if the firmware currently running is the official version for Buzzpirat hardware.</p>
</li>
</ul>
<h3 id="buzz-b00000000-0x00---take-voltage-measurement-from-all-sources">Buzz b00000000 (0x00) - Take voltage measurement from all sources</h3>
<p>Take a measurement from the Buzzpirat voltage sources.</p>
<ol>
<li>Returns a 2 byte ADC reading for 5v0 PWR, high 8bits come first.</li>
<li>Returns a 2 byte ADC reading for 3v3 PWR, high 8bits come first.</li>
<li>Returns a 2 byte ADC reading for 2v5 PWR, high 8bits come first.</li>
<li>Returns a 2 byte ADC reading for 1v8 PWR, high 8bits come first.</li>
<li>Returns a 2 byte ADC reading for VPU, high 8bits come first.</li>
<li>Returns a 2 byte ADC reading for ADC PROBE, high 8bits come first.</li>
<li>returns 0x01</li>
</ol>


<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">Note</h4>

    At the end of this page, you will find a code to convert each 2-byte ADC value.

</div>

<h3 id="buzz-b00000001-0x01---tp0-input-low">Buzz b00000001 (0x01) - TP0 INPUT LOW</h3>
<p>Configure TP0 as INPUT LOW.</p>


<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">Note</h4>

    TP0 is connected to VPU like MOSI, MISO.. pins.

</div>

<p>returns 0x01 if it has successfull.</p>
<h3 id="buzz-b00000010-0x02---tp0-output-low">Buzz b00000010 (0x02) - TP0 OUTPUT LOW</h3>
<p>Configure TP0 as OUTPUT LOW.</p>


<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">Note</h4>

    TP0 is connected to VPU like MOSI, MISO.. pins.

</div>

<p>returns 0x01 if it has successfull.</p>
<h3 id="buzz-b00000011-0x03---read-tp0-status">Buzz b00000011 (0x03) - Read TP0 status</h3>
<p>Return 0x01 or 0x00 depending on the status of TP0 (1=HIGH, 0=LOW).</p>


<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">Note</h4>

    TP0 is connected to VPU like MOSI, MISO.. pins.

</div>

<p>returns 0x01 if it has successfull.</p>
<h3 id="buzz-b00010000-0x10---check-for-short-circuits-in-the-power-supply-units">Buzz b00010000 (0x10) - Check for short circuits in the power supply units</h3>
<p>Inspect the power supply units for short circuits across the 5V, 3.3V, 2.5V, and 1.8V lines.</p>
<p>Return 0x01 if any PSU voltage is abnormally low, indicating a potential short circuit.</p>
<p>Return 0x00 if all PSU voltages are within normal parameters.</p>


<div class="alert alert-warning" role="alert">
<h4 class="alert-heading">Warning</h4>

    This command activates all the PSUs, checks the voltage of each one, and then turns off all the PSUs as quickly as possible

</div>



<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">Note</h4>

    It is recommended to use this command before executing the command: &ldquo;Configure peripherals w=1&rdquo;

</div>

<h3 id="buzz-b00010010-0x12---setup-pulse-width-modulation-requires-5-byte-setup">Buzz b00010010 (0x12) - Setup pulse-width modulation (requires 5 byte setup)</h3>
<p>Configure and enable pulse-width modulation output in the AUX pin.</p>
<p>Requires a 5 byte configuration sequence.</p>
<p>Equations to calculate the PWM frequency and period are in the PIC24F output compare manual.</p>
<ul>
<li>Bit 0 and 1 of the first configuration byte set the prescaler value.</li>
<li>The Next two bytes set the duty cycle register, high 8bits first.</li>
<li>The final two bytes set the period register, high 8bits first.</li>
</ul>
<p>Responds 0x01 after a complete sequence is received.</p>


<div class="alert alert-warning" role="alert">
<h4 class="alert-heading">Warning</h4>

    The PWM remains active after leaving binary bitbang mode!

</div>



<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">Note</h4>

    Further down on this page, you will find examples of how to generate the 5 byte setup.

</div>



<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">Note</h4>

    This command was previously available only in the main menu; now, you can use it from any mode, including SPI, I2C, etc..

</div>

<h3 id="buzz-b00010011-0x13---cleardisable-pwm">Buzz b00010011 (0x13) - Clear/disable PWM</h3>
<p>Clears the PWM, disables PWM output. Responds 0x01.</p>


<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">Note</h4>

    This command was previously available only in the main menu; now, you can use it from any mode, including SPI, I2C, etc..

</div>

<h3 id="buzz-b00010100-0x14---take-voltage-probe-measurement-returns-2-bytes">Buzz b00010100 (0x14) - Take voltage probe measurement (returns 2 bytes)</h3>
<p>Take a measurement from the Buzzpirat voltage probe. Returns a 2 byte ADC reading, high 8bits come first. To determine the actual voltage measurement: (ADC/1024)x3.3voltsx2; or simply (ADC/1024)x6.6.</p>


<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">Note</h4>

    At the end of this page, you will find a code to convert the ADC value.

</div>



<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">Note</h4>

    This command was previously available only in the main menu; now, you can use it from any mode, including SPI, I2C, etc..

</div>

<h3 id="buzz-b00010101-0x15---continuous-voltage-probe-measurement">Buzz b00010101 (0x15) - Continuous voltage probe measurement</h3>
<p>Sends ADC data (2bytes, high 8 first) as fast as UART will allow. A new reading is not taken until the previous finishes transmitting to the PC, this prevents time distortion from the buffer. Added for the oscilloscope script.</p>
<p>To exit this mode, send any single character.</p>


<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">Note</h4>

    This command was previously available only in the main menu; now, you can use it from any mode, including SPI, I2C, etc..

</div>

<h3 id="buzz-b00010110-0x16---frequency-measurement-on-aux-pin">Buzz b00010110 (0x16) - Frequency measurement on AUX pin</h3>
<p>Takes frequency measurement on AUX pin. Returns 4byte frequency count, most significant byte first.</p>


<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">Note</h4>

    This command was previously available only in the main menu; now, you can use it from any mode, including SPI, I2C, etc..

</div>

<hr>
<h2 id="main-b00001111-0x0f---reset-buzzpirat">MAIN b00001111 (0x0F) - Reset Buzzpirat</h2>
<p>The Buzzpirat responds 0x01 and then performs a complete hardware reset. The hardware and firmware version is printed (same as the &lsquo;i&rsquo; command in the terminal), and the Buzzpirat returns to the user terminal interface. Send 0x00 20 times to enter binary mode again.
Note: there may be garbage data between the 0x01 reply and the version information as the PIC UART initializes.</p>
<hr>
<h2 id="main-b00010000-0x10---buzzpirat-short-self-test--b00010001-0x11-long-self-test">MAIN b00010000 (0x10) - Buzzpirat Short self-test &amp; b00010001 (0x11) Long self-test</h2>
<p>Self-test commands</p>
<p>b00010001 (0x11) Long test (requires jumpers between +5 and Vpu, +3.3 and ADC)</p>
<p>The full test is the same as self-test in the user terminal, it requires jumpers between two sets of pins in order to test some features. The short test eliminates the six checks that require jumpers.</p>
<p>After the test is complete, the Buzzpirat responds with the number of errors. It also echoes any input plus the number of errors. The MODE LED blinks if the test was successful, or remains solid if there were errors. Exit the self-test by sending 0xff, the Buzzpirat will respond 0x01 and return to binary bitbang mode.</p>
<hr>
<h2 id="main-b00010010-0x12---setup-pulse-width-modulation-requires-5-byte-setup">MAIN b00010010 (0x12) - Setup pulse-width modulation (requires 5 byte setup)</h2>
<p>Configure and enable pulse-width modulation output in the AUX pin.</p>
<p>Requires a 5 byte configuration sequence.</p>
<p>Equations to calculate the PWM frequency and period are in the PIC24F output compare manual.</p>
<ul>
<li>Bit 0 and 1 of the first configuration byte set the prescaler value.</li>
<li>The Next two bytes set the duty cycle register, high 8bits first.</li>
<li>The final two bytes set the period register, high 8bits first.</li>
</ul>
<p>Responds 0x01 after a complete sequence is received.</p>


<div class="alert alert-warning" role="alert">
<h4 class="alert-heading">Warning</h4>

    The PWM remains active after leaving binary bitbang mode!

</div>



<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">Note</h4>

    Further down on this page, you will find examples of how to generate the 5 byte setup.

</div>

<hr>
<h2 id="main-b00010011-0x13---cleardisable-pwm">MAIN b00010011 (0x13) - Clear/disable PWM</h2>
<p>Clears the PWM, disables PWM output. Responds 0x01.</p>
<hr>
<h2 id="main-b00010100-0x14---take-voltage-probe-measurement-returns-2-bytes">MAIN b00010100 (0x14) - Take voltage probe measurement (returns 2 bytes)</h2>
<p>Take a measurement from the Buzzpirat voltage probe. Returns a 2 byte ADC reading, high 8bits come first. To determine the actual voltage measurement: (ADC/1024)x3.3voltsx2; or simply (ADC/1024)x6.6.</p>


<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">Note</h4>

    At the end of this page, you will find a code to convert the ADC value.

</div>

<hr>
<h2 id="main-b00010101-0x15---continuous-voltage-probe-measurement">MAIN b00010101 (0x15) - Continuous voltage probe measurement</h2>
<p>Sends ADC data (2bytes, high 8 first) as fast as UART will allow. A new reading is not taken until the previous finishes transmitting to the PC, this prevents time distortion from the buffer. Added for the oscilloscope script.</p>
<p>To exit this mode, send any single character.</p>
<hr>
<h2 id="main-b00010110-0x16---frequency-measurement-on-aux-pin">MAIN b00010110 (0x16) - Frequency measurement on AUX pin</h2>
<p>Takes frequency measurement on AUX pin. Returns 4byte frequency count, most significant byte first.</p>
<hr>
<h2 id="main-b010xxxxx-0x40-0x5f---configure-pins-as-input1-or-output0-auxmosiclkmisocs">MAIN b010xxxxx (0x40-0x5F) - Configure pins as input(1) or output(0): AUX|MOSI|CLK|MISO|CS</h2>
<p>Configure pins as an input (1) or output(0). The pins are mapped to the lower five bits in this order:</p>
<ul>
<li>AUX|MOSI|CLK|MISO|CS.</li>
</ul>
<p>The Buzzpirat responds to each direction update with a byte showing the current state of the pins, regardless of direction. This is useful for open collector I/O modes.</p>
<hr>
<h2 id="main-b1xxxxxxx-0x80-0xff---set-on-1-or-off-0-powerpullupauxmosiclkmisocs">MAIN b1xxxxxxx (0x80-0xFF) - Set on (1) or off (0): POWER|PULLUP|AUX|MOSI|CLK|MISO|CS</h2>
<p>The lower 7bits of the command byte control the Buzzpirat pins and peripherals. Bitbang works like a player piano or bitmap. The Buzzpirat pins map to the bits in the command byte as follows:</p>
<ul>
<li>1|POWER|PULLUP|AUX|MOSI|CLK|MISO|CS</li>
</ul>
<p>The Buzzpirat responds to each update with a byte in the same format that shows the current state of the pins.</p>
<hr>
<h2 id="adc-calculation">ADC Calculation</h2>
<h3 id="python-3">Python 3</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#!/usr/bin/env python3</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000">adc_high</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0x03</span>
</span></span><span style="display:flex;"><span><span style="color:#000">adc_low</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0x08</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000">adc_buzz</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">adc_high</span> <span style="color:#ce5c00;font-weight:bold">&lt;&lt;</span> <span style="color:#0000cf;font-weight:bold">8</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">adc_low</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87">print</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">f</span><span style="color:#4e9a06">&#34;Combined ADC value (hex): </span><span style="color:#4e9a06">{</span><span style="color:#204a87">hex</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">adc_buzz</span><span style="color:#000;font-weight:bold">)</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000">result</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">adc_buzz</span> <span style="color:#ce5c00;font-weight:bold">/</span> <span style="color:#0000cf;font-weight:bold">1024</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">*</span> <span style="color:#0000cf;font-weight:bold">6.6</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87">print</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">f</span><span style="color:#4e9a06">&#34;Result for ADC value </span><span style="color:#4e9a06">{</span><span style="color:#000">adc_buzz</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06"> (hex </span><span style="color:#4e9a06">{</span><span style="color:#204a87">hex</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">adc_buzz</span><span style="color:#000;font-weight:bold">)</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06">): </span><span style="color:#4e9a06">{</span><span style="color:#000">result</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">)</span>
</span></span></code></pre></div><p>Output:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>Combined ADC value (hex): 0x308
</span></span><span style="display:flex;"><span>Result for ADC value 776 (hex 0x308): 5.0015624999999995
</span></span></code></pre></div><h3 id="c">C</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#include</span> <span style="color:#8f5902;font-style:italic">&lt;stdio.h&gt;</span><span style="color:#8f5902;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">main</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">unsigned</span> <span style="color:#204a87;font-weight:bold">char</span> <span style="color:#000">adc_high</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0x03</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">unsigned</span> <span style="color:#204a87;font-weight:bold">char</span> <span style="color:#000">adc_low</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0x08</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">unsigned</span> <span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">adc_buzz</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">adc_high</span> <span style="color:#ce5c00;font-weight:bold">&lt;&lt;</span> <span style="color:#0000cf;font-weight:bold">8</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">adc_low</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">printf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Combined ADC value (hex): 0x%x</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">adc_buzz</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">double</span> <span style="color:#000">result</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">(((</span><span style="color:#204a87;font-weight:bold">double</span><span style="color:#000;font-weight:bold">)</span><span style="color:#000">adc_buzz</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">/</span> <span style="color:#0000cf;font-weight:bold">1024.0</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">*</span> <span style="color:#0000cf;font-weight:bold">6.6</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">printf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Result for ADC value %u (hex 0x%x): %f</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">adc_buzz</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">adc_buzz</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">result</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><p>Output:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>Combined ADC value (hex): 0x308
</span></span><span style="display:flex;"><span>Result for ADC value 776 (hex 0x308): 5.001562
</span></span></code></pre></div><hr>
<h2 id="pwm-computation">PWM Computation</h2>
<h3 id="python-3-1">Python 3</h3>
<p>Here is a Python Script for computing the PWM for Buzzpirat.</p>
<p>For example, setup PWM with Period of 1msec, 50% duty cycle. Using 1:1 Prescaler.</p>
<p>Modify only the 3 lines:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>Prescaler=1 # 1:1
</span></span><span style="display:flex;"><span>PwmPeriod=1e-3  # 0.1msec
</span></span><span style="display:flex;"><span>DutyCycleInPercent=.5 # 50%
</span></span></code></pre></div><p>It will output:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>======================
</span></span><span style="display:flex;"><span>PwmPeriod: 0.00100000000000000002 sec.
</span></span><span style="display:flex;"><span>Tcy: 0.00000006250000000000 sec.
</span></span><span style="display:flex;"><span>Prescaler: 1
</span></span><span style="display:flex;"><span>PR2: 0x3e7f = 15999
</span></span><span style="display:flex;"><span>OCR: 0x1f3f = 7999
</span></span><span style="display:flex;"><span>5 Byte Setup:
</span></span><span style="display:flex;"><span>1st Byte: 0x00
</span></span><span style="display:flex;"><span>2nd Byte: 0x1f
</span></span><span style="display:flex;"><span>3rd Byte: 0x3f
</span></span><span style="display:flex;"><span>4th Byte: 0x3e
</span></span><span style="display:flex;"><span>5th Byte: 0x7f
</span></span></code></pre></div><p>Use the 5byte setup to set the PWM.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#!/usr/bin/env python3</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#4e9a06">&#39;&#39;&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#4e9a06">Python Script 00.08.00
</span></span></span><span style="display:flex;"><span><span style="color:#4e9a06">    - by 7 mod by Dreg
</span></span></span><span style="display:flex;"><span><span style="color:#4e9a06">&#39;&#39;&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># 32MHz Crystal Oscillator</span>
</span></span><span style="display:flex;"><span><span style="color:#000">Fosc</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">32e6</span>  <span style="color:#8f5902;font-style:italic"># DONT MODIFY THIS</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000">Prescaler</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">1</span>  <span style="color:#8f5902;font-style:italic"># [1, 8, 64, 256]</span>
</span></span><span style="display:flex;"><span><span style="color:#000">PwmPeriod</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">1e-3</span>  <span style="color:#8f5902;font-style:italic"># 0.1 msec</span>
</span></span><span style="display:flex;"><span><span style="color:#000">DutyCycleInPercent</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0.5</span>  <span style="color:#8f5902;font-style:italic"># 50%</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">###################################################</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#### ---------------------------------------- #####</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#### -- DON&#39;T MODIFY ANYTHING BELOW THIS LINE #####</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#### ---------------------------------------- #####</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">###################################################</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#4e9a06">&#39;&#39;&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#4e9a06">Configure and enable pulse-width modulation output in the AUX pin.
</span></span></span><span style="display:flex;"><span><span style="color:#4e9a06">Requires a 5 byte configuration sequence.
</span></span></span><span style="display:flex;"><span><span style="color:#4e9a06">Responds 0x01 after a complete sequence is received.
</span></span></span><span style="display:flex;"><span><span style="color:#4e9a06">The PWM remains active after leaving binary bitbang mode! 
</span></span></span><span style="display:flex;"><span><span style="color:#4e9a06">Equations to calculate the PWM frequency and period are in the PIC24F
</span></span></span><span style="display:flex;"><span><span style="color:#4e9a06">output compare manual. Bit 0 and 1 of the first configuration byte
</span></span></span><span style="display:flex;"><span><span style="color:#4e9a06">set the prescaler value. The Next two bytes set the duty cycle register,
</span></span></span><span style="display:flex;"><span><span style="color:#4e9a06">high 8 bits first. The final two bytes set the period register, high 8 bits first.
</span></span></span><span style="display:flex;"><span><span style="color:#4e9a06">&#39;&#39;&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000">PrescalerList</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">{</span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">8</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">64</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">256</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">3</span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000">Tcy</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">2.0</span> <span style="color:#ce5c00;font-weight:bold">/</span> <span style="color:#000">Fosc</span>
</span></span><span style="display:flex;"><span><span style="color:#000">PRy</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">PwmPeriod</span> <span style="color:#ce5c00;font-weight:bold">/</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">Tcy</span> <span style="color:#ce5c00;font-weight:bold">*</span> <span style="color:#000">Prescaler</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span><span style="color:#000">PRy</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">PRy</span> <span style="color:#ce5c00;font-weight:bold">-</span> <span style="color:#0000cf;font-weight:bold">1</span>
</span></span><span style="display:flex;"><span><span style="color:#000">OCR</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">PRy</span> <span style="color:#ce5c00;font-weight:bold">*</span> <span style="color:#000">DutyCycleInPercent</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#204a87">print</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;======================&#34;</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87">print</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">f</span><span style="color:#4e9a06">&#34;PwmPeriod: </span><span style="color:#4e9a06">{</span><span style="color:#000">PwmPeriod</span><span style="color:#4e9a06">:</span><span style="color:#4e9a06">.20f</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06"> sec.&#34;</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87">print</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">f</span><span style="color:#4e9a06">&#34;Tcy: </span><span style="color:#4e9a06">{</span><span style="color:#000">Tcy</span><span style="color:#4e9a06">:</span><span style="color:#4e9a06">.20f</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06"> sec.&#34;</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87">print</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">f</span><span style="color:#4e9a06">&#34;Prescaler: </span><span style="color:#4e9a06">{</span><span style="color:#204a87">int</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">Prescaler</span><span style="color:#000;font-weight:bold">)</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87">print</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">f</span><span style="color:#4e9a06">&#34;PR2: 0x</span><span style="color:#4e9a06">{</span><span style="color:#204a87">int</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">PRy</span><span style="color:#000;font-weight:bold">)</span><span style="color:#4e9a06">:</span><span style="color:#4e9a06">x</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06"> = </span><span style="color:#4e9a06">{</span><span style="color:#204a87">int</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">PRy</span><span style="color:#000;font-weight:bold">)</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87">print</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">f</span><span style="color:#4e9a06">&#34;OCR: 0x</span><span style="color:#4e9a06">{</span><span style="color:#204a87">int</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">OCR</span><span style="color:#000;font-weight:bold">)</span><span style="color:#4e9a06">:</span><span style="color:#4e9a06">x</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06"> = </span><span style="color:#4e9a06">{</span><span style="color:#204a87">int</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">OCR</span><span style="color:#000;font-weight:bold">)</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#####</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87">print</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;5 Byte Setup:&#34;</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87">print</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">f</span><span style="color:#4e9a06">&#34;1st Byte: 0x</span><span style="color:#4e9a06">{</span><span style="color:#204a87">int</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">PrescalerList</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">Prescaler</span><span style="color:#000;font-weight:bold">])</span><span style="color:#4e9a06">:</span><span style="color:#4e9a06">02x</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87">print</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">f</span><span style="color:#4e9a06">&#34;2nd Byte: 0x</span><span style="color:#4e9a06">{</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87">int</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">OCR</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">&gt;&gt;</span> <span style="color:#0000cf;font-weight:bold">8</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span> <span style="color:#0000cf;font-weight:bold">0xFF</span><span style="color:#4e9a06">:</span><span style="color:#4e9a06">02x</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87">print</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">f</span><span style="color:#4e9a06">&#34;3rd Byte: 0x</span><span style="color:#4e9a06">{</span><span style="color:#204a87">int</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">OCR</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span> <span style="color:#0000cf;font-weight:bold">0xFF</span><span style="color:#4e9a06">:</span><span style="color:#4e9a06">02x</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87">print</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">f</span><span style="color:#4e9a06">&#34;4th Byte: 0x</span><span style="color:#4e9a06">{</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87">int</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">PRy</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">&gt;&gt;</span> <span style="color:#0000cf;font-weight:bold">8</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span> <span style="color:#0000cf;font-weight:bold">0xFF</span><span style="color:#4e9a06">:</span><span style="color:#4e9a06">02x</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87">print</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">f</span><span style="color:#4e9a06">&#34;5th Byte: 0x</span><span style="color:#4e9a06">{</span><span style="color:#204a87">int</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">PRy</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span> <span style="color:#0000cf;font-weight:bold">0xFF</span><span style="color:#4e9a06">:</span><span style="color:#4e9a06">02x</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">)</span>
</span></span></code></pre></div><h3 id="c-1">C</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#include</span> <span style="color:#8f5902;font-style:italic">&lt;stdio.h&gt;</span><span style="color:#8f5902;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">main</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8f5902;font-style:italic">// 32MHz Crystal Oscillator
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#204a87;font-weight:bold">double</span> <span style="color:#000">Fosc</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">32e6</span><span style="color:#000;font-weight:bold">;</span>  <span style="color:#8f5902;font-style:italic">// DON&#39;T MODIFY THIS
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">unsigned</span> <span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">Prescaler</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">;</span>    
</span></span><span style="display:flex;"><span>    <span style="color:#8f5902;font-style:italic">//unsigned int Prescaler = 8;  
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#8f5902;font-style:italic">//unsigned int Prescaler = 64; 
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#8f5902;font-style:italic">//unsigned int Prescaler = 256;  
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#204a87;font-weight:bold">double</span> <span style="color:#000">PwmPeriod</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">1e-3</span><span style="color:#000;font-weight:bold">;</span>  <span style="color:#8f5902;font-style:italic">// 0.1 msec
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#204a87;font-weight:bold">double</span> <span style="color:#000">DutyCycleInPercent</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0.5</span><span style="color:#000;font-weight:bold">;</span>  <span style="color:#8f5902;font-style:italic">// 50%
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>
</span></span><span style="display:flex;"><span>    <span style="color:#8f5902;font-style:italic">// DON&#39;T MODIFY ANYTHING BELOW THIS LINE
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>
</span></span><span style="display:flex;"><span>    <span style="color:#8f5902;font-style:italic">// Configure and enable pulse-width modulation output in the AUX pin
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#204a87;font-weight:bold">unsigned</span> <span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">listv</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">switch</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">Prescaler</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">case</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#ce5c00;font-weight:bold">:</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000">listv</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#204a87;font-weight:bold">break</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">case</span> <span style="color:#0000cf;font-weight:bold">8</span><span style="color:#ce5c00;font-weight:bold">:</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000">listv</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#204a87;font-weight:bold">break</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">case</span> <span style="color:#0000cf;font-weight:bold">64</span><span style="color:#ce5c00;font-weight:bold">:</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000">listv</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#204a87;font-weight:bold">break</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">case</span> <span style="color:#0000cf;font-weight:bold">256</span><span style="color:#ce5c00;font-weight:bold">:</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000">listv</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">3</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#204a87;font-weight:bold">break</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">default</span><span style="color:#ce5c00;font-weight:bold">:</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000">listv</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#204a87;font-weight:bold">break</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">double</span> <span style="color:#000">Tcy</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">2.0</span> <span style="color:#ce5c00;font-weight:bold">/</span> <span style="color:#000">Fosc</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">double</span> <span style="color:#000">PRy</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">PwmPeriod</span> <span style="color:#ce5c00;font-weight:bold">/</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">Tcy</span> <span style="color:#ce5c00;font-weight:bold">*</span> <span style="color:#000">Prescaler</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">PRy</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">PRy</span> <span style="color:#ce5c00;font-weight:bold">-</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">double</span> <span style="color:#000">OCR</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">PRy</span> <span style="color:#ce5c00;font-weight:bold">*</span> <span style="color:#000">DutyCycleInPercent</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">printf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;======================</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">printf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;PwmPeriod: %.20f sec.</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">PwmPeriod</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">printf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Tcy: %.20f sec.</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">Tcy</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">printf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Prescaler: %u</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">Prescaler</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">printf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;PR2: 0x%x = %u</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">unsigned</span> <span style="color:#204a87;font-weight:bold">int</span><span style="color:#000;font-weight:bold">)</span><span style="color:#000">PRy</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">unsigned</span> <span style="color:#204a87;font-weight:bold">int</span><span style="color:#000;font-weight:bold">)</span><span style="color:#000">PRy</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">printf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;OCR: 0x%x = %u</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">unsigned</span> <span style="color:#204a87;font-weight:bold">int</span><span style="color:#000;font-weight:bold">)</span><span style="color:#000">OCR</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">unsigned</span> <span style="color:#204a87;font-weight:bold">int</span><span style="color:#000;font-weight:bold">)</span><span style="color:#000">OCR</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">printf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;5 Byte Setup:</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">printf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;1st Byte: 0x%02x</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">listv</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">printf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;2nd Byte: 0x%02x</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000;font-weight:bold">((</span><span style="color:#204a87;font-weight:bold">unsigned</span> <span style="color:#204a87;font-weight:bold">int</span><span style="color:#000;font-weight:bold">)</span><span style="color:#000">OCR</span> <span style="color:#ce5c00;font-weight:bold">&gt;&gt;</span> <span style="color:#0000cf;font-weight:bold">8</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span> <span style="color:#0000cf;font-weight:bold">0xFF</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">printf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;3rd Byte: 0x%02x</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">unsigned</span> <span style="color:#204a87;font-weight:bold">int</span><span style="color:#000;font-weight:bold">)</span><span style="color:#000">OCR</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span> <span style="color:#0000cf;font-weight:bold">0xFF</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">printf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;4th Byte: 0x%02x</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000;font-weight:bold">((</span><span style="color:#204a87;font-weight:bold">unsigned</span> <span style="color:#204a87;font-weight:bold">int</span><span style="color:#000;font-weight:bold">)</span><span style="color:#000">PRy</span> <span style="color:#ce5c00;font-weight:bold">&gt;&gt;</span> <span style="color:#0000cf;font-weight:bold">8</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span> <span style="color:#0000cf;font-weight:bold">0xFF</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">printf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;5th Byte: 0x%02x</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">unsigned</span> <span style="color:#204a87;font-weight:bold">int</span><span style="color:#000;font-weight:bold">)</span><span style="color:#000">PRy</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span> <span style="color:#0000cf;font-weight:bold">0xFF</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><p>Output:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>======================
</span></span><span style="display:flex;"><span>PwmPeriod: 0.00100000000000000002 sec.
</span></span><span style="display:flex;"><span>Tcy: 0.00000006250000000000 sec.
</span></span><span style="display:flex;"><span>Prescaler: 1
</span></span><span style="display:flex;"><span>PR2: 0x3e7f = 15999
</span></span><span style="display:flex;"><span>OCR: 0x1f3f = 7999
</span></span><span style="display:flex;"><span>5 Byte Setup:
</span></span><span style="display:flex;"><span>1st Byte: 0x00
</span></span><span style="display:flex;"><span>2nd Byte: 0x1f
</span></span><span style="display:flex;"><span>3rd Byte: 0x3f
</span></span><span style="display:flex;"><span>4th Byte: 0x3e
</span></span><span style="display:flex;"><span>5th Byte: 0x7f
</span></span></code></pre></div>
</div>



    
      
  
  
  
  

  
  

  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-e33d280f8f801c075f49bbb64a6ec927">5 - Firmware Update</h1>
    <div class="lead">How to update your Buzzpirat</div>
	

<div class="alert alert-warning" role="alert">
<h4 class="alert-heading">Warning</h4>

    Do not install this firmware on the Bus Pirate v3. Please refer to the lower section of this page for compatible firmware options

</div>

<p>Download the last firmware from this page:</p>
<ul>
<li><a href="https://github.com/therealdreg/buzzpirat/tree/main/bin/stablefirm">https://github.com/therealdreg/buzzpirat/tree/main/bin/stablefirm</a></li>
</ul>


<div class="alert alert-warning" role="alert">
<h4 class="alert-heading">Warning</h4>

    Do not install the firmware labeled with &ldquo;pickit&rdquo; in its name

</div>

<p>Download the last buzzloader app (There are versions available for Windows, Linux and Mac) from this page:</p>
<ul>
<li>
<p><a href="https://github.com/therealdreg/buzzpirat/tree/main/bin/buzzloader">https://github.com/therealdreg/buzzpirat/tree/main/bin/buzzloader</a></p>
</li>
<li>
<p>put a jumper/dupont_wire connecting the PGD pin to the PGC pin</p>
</li>
<li>
<p>connect the buzzpirat to your computer via a usb cable</p>
</li>
<li>
<p>check for the new COM port assignment in the device manager (e.g., COM29)</p>
</li>
</ul>
<p>Make sure to close Tera Term or any other software that might be using the COM port to free it up and execute:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>buzzloader.exe --dev=COM29 --hex=BZ-firmware-v7.1.6969.hex
</span></span></code></pre></div><p>Just ignore a800&hellip;ERROR[50] error message, it&rsquo;s a known issue and the firmware is updated correctly.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>Writing page 41 row 331, a580...OK
</span></span><span style="display:flex;"><span>Writing page 41 row 332, a600...OK
</span></span><span style="display:flex;"><span>Writing page 41 row 333, a680...OK
</span></span><span style="display:flex;"><span>Writing page 41 row 334, a700...OK
</span></span><span style="display:flex;"><span>Writing page 41 row 335, a780...OK
</span></span><span style="display:flex;"><span>Erasing page 42, a800...ERROR [50]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Error updating firmware :(
</span></span></code></pre></div><p>Remove the jumper/Dupont cable, then reconnect the device to the USB port, and you&rsquo;re all set! You should now have the latest firmware installed.</p>
<p>Run the &lsquo;i&rsquo; command and perform a self-test with the &lsquo;~&rsquo; command to ensure everything has gone smoothly.</p>
<hr>
<h2 id="buzzpirat-firmware-for-bpv3-hardware">Buzzpirat firmware for BPv3 hardware</h2>
<p>For each firmware version, I also generate a firmware that is 100% compatible with the Bus Pirate v3 hardware.</p>
<p>So, users with the Bus Pirate v3 hardware can benefit from Buzzpirat features:</p>
<ul>
<li><a href="https://github.com/therealdreg/buzzpirat/tree/main/bin/stablefirm/bpv3comp">https://github.com/therealdreg/buzzpirat/tree/main/bin/stablefirm/bpv3comp</a></li>
</ul>
<p>To ensure compatibility with Buzzpirat firmware, you need to install bootloader 4.5</p>
<p>More information on how to update it can be found here:</p>
<ul>
<li><a href="http://dangerousprototypes.com/forum/index.php?topic=8498.0">http://dangerousprototypes.com/forum/index.php?topic=8498.0</a></li>
</ul>


<div class="alert alert-warning" role="alert">
<h4 class="alert-heading">Warning</h4>

    BOOTLOADER UPDATE IS RISKY, YOU COULD BRICK YOUR BUS PIRATE, AND I AM NOT RESPONSIBLE FOR ANY DAMAGES. LEARN HOW TO <a href="/docs/unbrick/">UNBRICK</a>

</div>

<hr>
<h2 id="last-community-bpv3-firmware--bootloader">Last community BPv3 firmware &amp; bootloader</h2>
<p>Any firmware and bootloader from the original Bus Pirate v3 will work well with Buzzpirat. Here are some that I have tested.</p>
<p>4.5 Bootloader upgrade from v4x:</p>
<ul>
<li><a href="https://github.com/therealdreg/buzzpirat/tree/main/bin/oldfirm/BPv3-bootloader-upgrade-v4xtov4.5_Aug-2023_USBEprom.hex">https://github.com/therealdreg/buzzpirat/tree/main/bin/oldfirm/BPv3-bootloader-upgrade-v4xtov4.5_Aug-2023_USBEprom.hex</a></li>
</ul>
<p>Last community firmware:</p>
<ul>
<li><a href="https://github.com/therealdreg/buzzpirat/tree/main/bin/oldfirm/BPv3-firmware-v7.1-JTAG_SAFE_1_Aug-2023_USBEprom.hex">https://github.com/therealdreg/buzzpirat/tree/main/bin/oldfirm/BPv3-firmware-v7.1-JTAG_SAFE_1_Aug-2023_USBEprom.hex</a></li>
</ul>


<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">Note</h4>

    This community firmware have a bug in the binary SPI mode and cause problems with flashrom

</div>

<hr>
<h2 id="legacy-bpv3-firmware--bootloader">Legacy BPv3 firmware &amp; bootloader</h2>
<p>4.4 Bootloader:</p>
<ul>
<li><a href="https://github.com/therealdreg/buzzpirat/tree/main/bin/oldfirm/BPv3-Bootloader-v4.4.hex">https://github.com/therealdreg/buzzpirat/tree/main/bin/oldfirm/BPv3-Bootloader-v4.4.hex</a></li>
</ul>
<p>6.3-r2151 Firmware:</p>
<ul>
<li><a href="https://github.com/therealdreg/buzzpirat/tree/main/bin/oldfirm/BPv3-firmware-v6.3-r2151.hex">https://github.com/therealdreg/buzzpirat/tree/main/bin/oldfirm/BPv3-firmware-v6.3-r2151.hex</a></li>
</ul>

</div>



    
      
  
  
  
  

  
  

  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-6b758cfd7e576dd18fee3c05f62ee978">6 - AVRDude</h1>
    
	<p><a href="https://github.com/avrdudes/avrdude/">AVRDude</a>, which stands for AVR Downloader Uploader, is a software utility used for programming the onboard memory of Microchip&rsquo;s AVR microcontrollers, typically found in popular Arduino boards. This tool allows for the downloading and uploading of data to the chip&rsquo;s Flash and EEPROM memory. Additionally, when supported by the programming protocol, AVRDUDE can program fuse and lock bits, which are essential for configuring the microcontroller&rsquo;s settings and security features. A distinctive feature of AVRDUDE is its direct instruction mode. This mode empowers users to send any programming instruction directly to the AVR chip, bypassing the limitations of the software&rsquo;s built-in functions. This flexibility makes it an invaluable tool for developers working with AVR-based systems, particularly in the Arduino ecosystem, where customization and direct hardware control are often required</p>


<div class="alert alert-warning" role="alert">
<h4 class="alert-heading">Warning</h4>

    Use short &amp; high-quality USB&amp;Dupont cables. Long or low-quality cables can cause communication issues.

</div>



<div class="alert alert-warning" role="alert">
<h4 class="alert-heading">Warning</h4>

    Use VMs is not recommended, as it can cause communication issues.

</div>

<h2 id="update-avrdude--buzzpirat">Update AVRDude &amp; Buzzpirat</h2>
<p>AVRDude supports Buzzpirat out of the box</p>
<p>Ensure you have the latest stable firmware installed; learn how in the <a href="/docs/firmware-update">Firmware Update</a> section.</p>
<p>Finally, make sure to use the latest development version of AVRDude:</p>
<ul>
<li><a href="https://github.com/avrdudes/avrdude/releases">https://github.com/avrdudes/avrdude/releases</a></li>
</ul>
<p>A nice GUI for avrdude is AVRDUDESS:</p>
<ul>
<li><a href="https://github.com/ZakKemble/AVRDUDESS">https://github.com/ZakKemble/AVRDUDESS</a></li>
<li><a href="https://blog.zakkemble.net/avrdudess-a-gui-for-avrdude/">https://blog.zakkemble.net/avrdudess-a-gui-for-avrdude/</a></li>
</ul>
<p>Image avrdudess:</p>
<p><img src="/otherimgs/avrdudess.png" alt=""></p>
<h2 id="tutorial-arduino-uno-atmega328p">Tutorial Arduino UNO (ATmega328P)</h2>
<p>For this case, simply use the official Buzzpirat cables with the female Dupont connector they come with; there&rsquo;s no need to use SMD IC clips. Connect the Buzzpirat to the Arduino UNO board by attaching the +5v0(SW5V0) to VCC, CS to RESET, MISO to MISO, GND to GND, CLK to SCK, and MOSI to MOSI, ensuring each connection is secure for proper functionality</p>
<table>
<thead>
<tr>
<th>Buzzpirat</th>
<th>Arduino UNO ICSP Connector</th>
</tr>
</thead>
<tbody>
<tr>
<td>+5v(SW5V0)</td>
<td>VCC</td>
</tr>
<tr>
<td>CS</td>
<td>RESET</td>
</tr>
<tr>
<td>MISO</td>
<td>MISO</td>
</tr>
<tr>
<td>MOSI</td>
<td>MOSI</td>
</tr>
<tr>
<td>CLK</td>
<td>SCK</td>
</tr>
<tr>
<td>GND</td>
<td>GND</td>
</tr>
</tbody>
</table>
<p><img src="/conn/arduinoicspbuzz.png" alt=""></p>
<p>To detect the AVR chip, run the following command:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>avrdude -c buspirate -P COM59 -b <span style="color:#0000cf;font-weight:bold">115200</span> -p m328pb
</span></span></code></pre></div><p>AVR chip detected is ATmega328PB, which is the microcontroller used in the Arduino UNO board. The output of the command will look like this:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>avrdude -c buspirate -P COM59 -b <span style="color:#0000cf;font-weight:bold">115200</span> -p m328pb
</span></span><span style="display:flex;"><span>attempting to initiate BusPirate binary mode ...
</span></span><span style="display:flex;"><span>avrdude: paged flash write enabled
</span></span><span style="display:flex;"><span>avrdude: AVR device initialized and ready to accept instructions
</span></span><span style="display:flex;"><span>avrdude: device <span style="color:#000">signature</span> <span style="color:#ce5c00;font-weight:bold">=</span> 0x1e9516 <span style="color:#ce5c00;font-weight:bold">(</span>probably m328pb<span style="color:#ce5c00;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>avrdude error: did not get a response to power off <span style="color:#204a87">command</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>avrdude <span style="color:#204a87;font-weight:bold">done</span>.  Thank you.
</span></span></code></pre></div>

<div class="alert alert-warning" role="alert">
<h4 class="alert-heading">Warning</h4>

    If no response is received, check the connections and ensure that the AVR connection was correctly. If the issue persists, try resetting the Buzzpirat by unplugging and reconnecting it to the USB port.

</div>

<p>The command uses the following parameters:</p>
<ul>
<li>
<p><strong>-c buspirate</strong>: Specifies the programmer type. In this case, it&rsquo;s set to buspirate, indicating that the Buzzpirat is used for programming.</p>
</li>
<li>
<p><strong>-P COM59</strong>: Specifies the port where the Buzzpirat is connected. The COM port number may vary depending on your system&rsquo;s configuration. You can find the COM port number by opening the Device Manager in Windows and looking for the Bus Pirate device under the Ports (COM &amp; LPT) section.</p>
</li>
<li>
<p><strong>-b 115200</strong>: Sets the baud rate for serial communication between the computer and the Buzzpirat to 115200 bits per second. This is a common baud rate for serial communication.</p>
</li>
<li>
<p><strong>-p m328pb</strong>: Specifies the AVR microcontroller model. In this case, it&rsquo;s set to m328pb, which is the model used in the Arduino UNO board.</p>
</li>
</ul>
<p>If the AVR chip is detected successfully, you can proceed with programming the chip using the appropriate commands. For example, to upload a HEX file to the chip, you can use the following command:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>avrdude -c buspirate -p m328pb -P COM59 -b <span style="color:#0000cf;font-weight:bold">115200</span> -U flash:w:<span style="color:#4e9a06">&#34;C:\Users\dreg\Desktop\Blink\build\arduino.avr.uno\Blink.ino.with_bootloader.hex&#34;</span>:i
</span></span></code></pre></div><p>The command uses the following parameter:</p>
<ul>
<li><strong>-U flash:w:&ldquo;C:\Users\dreg\Desktop\Blink\build\arduino.avr.uno\Blink.ino.with_bootloader.hex&rdquo;:i</strong>: Specifies the operation to perform. In this case, it&rsquo;s set to write (w) the contents of the specified HEX file to the flash memory of the AVR chip. The path to the HEX file should be replaced with the actual path to the file on your system.</li>
</ul>
<p>How to read flash memory:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>avrdude -c buspirate -p m328pb -P COM59 -b <span style="color:#0000cf;font-weight:bold">115200</span> -U flash:r:<span style="color:#4e9a06">&#34;C:\Users\dreg\Desktop\dump.hex&#34;</span>:i
</span></span></code></pre></div><p>The command uses the following parameter:</p>
<ul>
<li><strong>-U flash:r:&ldquo;C:\Users\dreg\Desktop\dump.hex&rdquo;:i</strong>: Specifies the operation to perform. In this case, it&rsquo;s set to read (r) the contents of the flash memory of the AVR chip and save it to the specified HEX file. The path to the output file should be replaced with the actual path on your system.</li>
</ul>
<p>How to read EEPROM:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>avrdude -c buspirate -p m328pb -P COM59 -b <span style="color:#0000cf;font-weight:bold">115200</span> -U eeprom:r:<span style="color:#4e9a06">&#34;C:\Users\dreg\Desktop\eeprom_dump.hex&#34;</span>:i
</span></span></code></pre></div><p>The command uses the following parameter:</p>
<ul>
<li><strong>-U eeprom:r:&ldquo;C:\Users\dreg\Desktop\eeprom_dump.hex&rdquo;:i</strong>: Specifies the operation to perform. In this case, it&rsquo;s set to read (r) the contents of the EEPROM memory of the AVR chip and save it to the specified HEX file. The path to the output file should be replaced with the actual path on your system.</li>
</ul>


<div class="alert alert-warning" role="alert">
<h4 class="alert-heading">Warning</h4>

    WARNING use &ldquo;:r&rdquo; for binary files, &ldquo;:i&rdquo; for intel hex files.

</div>

<p>How to read EEPROM binary:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>avrdude -c buspirate -p m328pb -P COM59 -b <span style="color:#0000cf;font-weight:bold">115200</span> -U eeprom:r:<span style="color:#4e9a06">&#34;C:\Users\dreg\Desktop\eeprom_dump.bin&#34;</span>:r
</span></span></code></pre></div>
</div>



    
      
  
  
  
  

  
  

  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-d33db6d5cfbb7ff60d1e19cd08607f8c">7 - Flashrom</h1>
    
	<p><a href="https://www.flashrom.org">Flashrom</a> is a versatile utility for managing flash chips, capable of identifying, reading, writing, verifying, and erasing them. It&rsquo;s particularly adept at flashing BIOS/EFI/coreboot/firmware/optionROM images on a variety of hardware, including mainboards, network/graphics/storage controllers, and other programmer devices.</p>


<div class="alert alert-warning" role="alert">
<h4 class="alert-heading">Warning</h4>

    Use short &amp; high-quality USB&amp;Dupont cables. Long or low-quality cables can cause communication issues.

</div>



<div class="alert alert-warning" role="alert">
<h4 class="alert-heading">Warning</h4>

    Use VMs is not recommended, as it can cause communication issues.

</div>

<p><strong>Key features include:</strong></p>
<ul>
<li>Support for over 476 flash chips, 291 chipsets, 500 mainboards, 79 PCI devices, 17 USB devices, and a range of programmers via parallel/serial ports.</li>
<li>Compatibility with parallel, LPC, FWH, and SPI flash interfaces, and various chip packages like DIP32, PLCC32, DIP8, SO8/SOIC8, TSOP32, TSOP40, TSOP48, BGA, and more.</li>
<li>Operable without physical access; root access is typically sufficient, with some programmers not requiring it.</li>
<li>No need for bootable media, keyboard, or monitor; capable of remote flashing via SSH.</li>
<li>Allows flashing within a running system with no immediate reboot required; the new firmware activates on the next boot.</li>
<li>Supports crossflashing and hotflashing, given electrical and logical compatibility of flash chips.</li>
<li>Scriptable for simultaneous flashing across multiple machines.</li>
<li>Faster than many vendor-specific flash tools.</li>
<li>Portable across various operating systems including DOS, Linux, FreeBSD, NetBSD, OpenBSD, DragonFlyBSD, Solaris-like systems, Mac OS X, and other Unix-like OSes, as well as GNU Hurd. Partial Windows support is available, excluding internal programmer support.&quot;</li>
</ul>
<h2 id="update-flashrom--buzzpirat">Update Flashrom &amp; Buzzpirat</h2>
<p>Flashrom supports Buzzpirat out of the box</p>
<p>Ensure you have the latest stable firmware installed; learn how in the <a href="/docs/firmware-update">Firmware Update</a> section.</p>
<p>Finally, make sure to use the latest development version of flashrom or our mod:</p>
<ul>
<li>Windows mod: <a href="https://github.com/therealdreg/flashrom_build_windows_x64">https://github.com/therealdreg/flashrom_build_windows_x64</a></li>
<li>mod code (For Unix): <a href="https://github.com/therealdreg/flashrom-dregmod">https://github.com/therealdreg/flashrom-dregmod</a></li>
<li>Official repo: <a href="https://github.com/flashrom/flashrom">https://github.com/flashrom/flashrom</a></li>
</ul>
<h2 id="help">Help</h2>
<p>A required <code>dev</code> parameter specifies the Buzzpirat device node and an optional <code>spispeed</code> parameter specifies the frequency of the SPI bus. The parameter delimiter is a comma. Syntax is:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>flashrom -p buspirate_spi:dev<span style="color:#ce5c00;font-weight:bold">=</span>/dev/device,spispeed<span style="color:#ce5c00;font-weight:bold">=</span>frequency
</span></span></code></pre></div><p>where <code>frequency</code> can be <code>30k</code>, <code>125k</code>, <code>250k</code>, <code>1M</code>, <code>2M</code>, <code>2.6M</code>, <code>4M</code> or <code>8M</code> (in Hz). The default is the maximum frequency of 8 MHz.</p>
<p>The baud rate for communication between the host and the Buzzpirat can be specified with the optional <code>serialspeed</code> parameter. Syntax is:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>flashrom -p buspirate_spi:serialspeed<span style="color:#ce5c00;font-weight:bold">=</span>baud
</span></span></code></pre></div><p>where <code>baud</code> can be <code>115200</code>, <code>230400</code>, <code>250000</code> or <code>2000000</code> (<code>2M</code>). The default is <code>2M</code> baud.</p>
<p>An optional pullups parameter specifies the use of the Buzzpirat internal pull-up resistors. This may be needed if you are working with a flash ROM chip that you have physically removed from the board. Syntax is:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>flashrom -p buspirate_spi:pullups<span style="color:#ce5c00;font-weight:bold">=</span>state
</span></span></code></pre></div><p>where <code>state</code> can be <code>on</code> or <code>off</code>.</p>
<p>When working with low-voltage chips, the internal 10k pull-ups of the Buzzpirat might be too high. In such cases, it’s necessary to create an external pull-up using lower-value resistors.</p>
<p>For this, you can use the <code>hiz</code> parameter. This way, the Buzzpirat will operate as an open drain. Syntax is:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>flashrom -p buspirate_spi:hiz<span style="color:#ce5c00;font-weight:bold">=</span>state
</span></span></code></pre></div><p>where <code>state</code> can be <code>on</code> or <code>off</code>.</p>
<p>The state of the Buzzpirat power supply pins is controllable through an optional <code>psus</code> parameter. Syntax is:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>flashrom -p buspirate_spi:psus<span style="color:#ce5c00;font-weight:bold">=</span>state
</span></span></code></pre></div><p>where <code>state</code> can be <code>on</code> or <code>off</code>. This allows the Buzzpirat to power the ROM chip directly. This may also be used to provide the required pullup voltage (when using the <code>pullups</code> option), by connecting the Buzzpirat’s Vpu input to the appropriate Vcc pin.</p>
<p>An optional aux parameter specifies the state of the Buzzpirat auxiliary pin. This may be used to drive the auxiliary pin high or low before a transfer. Syntax is:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>flashrom -p buspirate_spi:aux<span style="color:#ce5c00;font-weight:bold">=</span>state
</span></span></code></pre></div><p>where <code>state</code> can be <code>high</code> or <code>low</code>. The default <code>state</code> is <code>high</code>.</p>
<h2 id="tutorial-winbond-3v3-64m-bit-w25q64fv-board">Tutorial Winbond 3v3 64M-BIT w25q64fv board</h2>
<p>This board is included in our full kit for practice purposes. You can purchase another one on Aliexpress, Amazon, or eBay.</p>
<p><img src="/conn/w25q64schboard.png" alt=""></p>
<p>For this case, simply use the official Buzzpirat cables with the female Dupont connector they come with; there&rsquo;s no need to use SMD IC clips. Connect the Buzzpirat to the w25q64fv board by attaching the +3v3(SW3V3) to VCC, CS to CS, MISO to DO, GND to GND, CLK to CLK, and MOSI to DI, ensuring each connection is secure for proper functionality</p>
<table>
<thead>
<tr>
<th>Buzzpirat</th>
<th>w25q64fv board</th>
</tr>
</thead>
<tbody>
<tr>
<td>+3v3(SW3V3)</td>
<td>VCC</td>
</tr>
<tr>
<td>CS</td>
<td>CS</td>
</tr>
<tr>
<td>MISO</td>
<td>DO</td>
</tr>
<tr>
<td>GND</td>
<td>GND</td>
</tr>
<tr>
<td>CLK</td>
<td>CLK</td>
</tr>
<tr>
<td>MOSI</td>
<td>DI</td>
</tr>
</tbody>
</table>
<p><img src="/conn/conn1flashwinspi3v3.png" alt=""></p>
<p>To read the content of a flash memory chip using <code>flashrom</code> with Buzzpirat, execute the following command:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>flashrom.exe --progress -V -c <span style="color:#4e9a06">&#34;W25Q64BV/W25Q64CV/W25Q64FV&#34;</span> -p buspirate_spi:dev<span style="color:#ce5c00;font-weight:bold">=</span>COM8,spispeed<span style="color:#ce5c00;font-weight:bold">=</span>1M,serialspeed<span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">115200</span> -r flash_content.bin 
</span></span></code></pre></div><ul>
<li><strong><code>--</code>progress</strong>: This parameter shows the progress of the operation, providing visual feedback in the terminal.</li>
<li><strong>-V</strong>: Stands for &lsquo;verbose&rsquo;. It increases the verbosity of the program, providing detailed output about the operations being performed. This is useful for debugging or getting more information about the process.</li>
<li><strong>-c &ldquo;W25Q64BV/W25Q64CV/W25Q64FV&rdquo;</strong> in flashrom is used to specify the exact model of the flash chip that you intend to interact with. When you run flashrom without the -c parameter, the tool attempts to automatically detect the types of flash memory chips that are present in your system.</li>
<li><strong>-p buspirate_spi</strong>: Specifies the programmer type. In this case, it&rsquo;s set to buspirate_spi, indicating that the Buzzpirat is used for SPI (Serial Peripheral Interface) programming.
<ul>
<li><strong>dev=COM8</strong>: This part of the parameter specifies the device name. 

<div class="alert alert-warning" role="alert">
<h4 class="alert-heading">Warning</h4>

    COM8 refers to the COM port where the Buzzpirat is connected. This will vary depending on your system’s configuration. You can find the COM port number by opening the Device Manager in Windows and looking for the Bus Pirate device under the Ports (COM &amp; LPT) section.

</div>
</li>
<li><strong>spispeed=1M</strong>: Sets the SPI communication speed to 1 MHz. Adjusting the SPI speed can be necessary depending on the flash chip&rsquo;s specifications and the quality of the connections.</li>
<li><strong>serialspeed=115200</strong>: Sets the serial communication speed (baud rate) between the computer and the Buzzpirat to 115200 bits per second. This is a common baud rate for serial communication.</li>
</ul>
</li>
<li><strong>-r flash_content.bin</strong>: This part of the command tells flashrom to read the flash memory&rsquo;s content and save it into a file named flash_content.bin</li>
</ul>
<p>The read operation may take about 15 minutes to complete. Once it&rsquo;s done, you can use a hex editor / binwalk etc to open the flash_content.bin file and inspect its contents.</p>
<p>To write the content of a flash memory chip using <code>flashrom</code> with Buzzpirat, execute the following command:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>flashrom.exe --progress -V -c <span style="color:#4e9a06">&#34;W25Q64BV/W25Q64CV/W25Q64FV&#34;</span> -p buspirate_spi:dev<span style="color:#ce5c00;font-weight:bold">=</span>COM8,spispeed<span style="color:#ce5c00;font-weight:bold">=</span>1M,serialspeed<span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">115200</span> -w flash_content.bin 
</span></span></code></pre></div><p>The difference between the read and write commands is the <code>-w</code> parameter, which tells flashrom to write the content of the flash_content.bin file to the flash memory chip.</p>


<div class="alert alert-warning" role="alert">
<h4 class="alert-heading">Warning</h4>

    Warninng 1M can be too fast for some &ldquo;setups&rdquo;, try 250k or 125k if you have issues: spispeed=250k or spispeed=125k

</div>

<h2 id="tutorial-winbond-18v-64m-bit-w25q64fw-board">Tutorial Winbond 1.8V 64M-BIT W25Q64FW board</h2>
<p>After testing with the 3.3V memory, buy a 1.8V Winbond W25Q64FW. Desolder the 3.3V memory and solder the 1.8V one in its place. Ensure the chip&rsquo;s orientation remains the same as the original one.</p>
<p>For this case, simply use the official Buzzpirat cables with the female Dupont connector they come with; there&rsquo;s no need to use SMD IC clips. Connect the Buzzpirat to the w25q64fv board by attaching the +1v8(SW1V8) to VCC, CS to CS, MISO to DO, GND to GND, CLK to CLK, and MOSI to DI, ensuring each connection is secure for proper functionality.</p>


<div class="alert alert-warning" role="alert">
<h4 class="alert-heading">Warning</h4>

    <strong>Also, connect the VPU pin to a SW1V8 pin of the Buzzpirat</strong>.

</div>

<table>
<thead>
<tr>
<th>Buzzpirat</th>
<th>w25q64fv board</th>
</tr>
</thead>
<tbody>
<tr>
<td>+1v8(SW1V8)</td>
<td>VCC</td>
</tr>
<tr>
<td>CS</td>
<td>CS</td>
</tr>
<tr>
<td>MISO</td>
<td>DO</td>
</tr>
<tr>
<td>GND</td>
<td>GND</td>
</tr>
<tr>
<td>CLK</td>
<td>CLK</td>
</tr>
<tr>
<td>MOSI</td>
<td>DI</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>Buzzpirat</th>
<th>Buzzpirat</th>
</tr>
</thead>
<tbody>
<tr>
<td>+1v8(SW1V8)</td>
<td>VPU</td>
</tr>
</tbody>
</table>
<p><img src="/conn/conn1flashwinspi1v8.png" alt=""></p>


<div class="alert alert-warning" role="alert">
<h4 class="alert-heading">Warning</h4>

    It&rsquo;s crucial not to use the Buzzpirat in 3.3V mode as it could endanger the 1.8V chips. Additionally, activating the BuzzPirate&rsquo;s pull-ups is necessary to ensure everything operates at the voltage set in VPU pin (in this case, 1.8V). To do this, we must execute flashrom as follows:

</div>

<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>flashrom.exe --progress -V -c <span style="color:#4e9a06">&#34;W25Q64.W&#34;</span> -p buspirate_spi:dev<span style="color:#ce5c00;font-weight:bold">=</span>COM8,spispeed<span style="color:#ce5c00;font-weight:bold">=</span>30k,serialspeed<span style="color:#ce5c00;font-weight:bold">=</span>115200,pullups<span style="color:#ce5c00;font-weight:bold">=</span>on -r flash_content.bin 
</span></span></code></pre></div><p>pullups=on means that the pull-ups are activated + the Buzzpirat is in hi-z mode.</p>


<div class="alert alert-warning" role="alert">
<h4 class="alert-heading">Warning</h4>

    COM8 refers to the COM port where the Buzzpirat is connected. This will vary depending on your system’s configuration. You can find the COM port number by opening the Device Manager in Windows and looking for the Bus Pirate device under the Ports (COM &amp; LPT) section.

</div>

<p>The read operation may take about 15 minutes to complete. Once it&rsquo;s done, you can use a hex editor / binwalk etc to open the flash_content.bin file and inspect its contents.</p>


<div class="alert alert-warning" role="alert">
<h4 class="alert-heading">Warning</h4>

    30k is the lowest speed, and it&rsquo;s recommended to use it when working with 1.8V chips.

</div>


</div>



    
      
  
  
  
  

  
  

  

    
	
  



          </main>
        </div>
      </div>
      <footer class="td-footer row d-print-none">
  <div class="container-fluid">
    <div class="row mx-md-2">
      <div class="col-6 col-sm-4 text-xs-center order-sm-2">
        
        
        
<ul class="td-footer__links-list">
  
  <li class="td-footer__links-item" data-bs-toggle="tooltip" title="Email" aria-label="Email">
    <a target="_blank" rel="noopener" href="mailto:dreg@rootkit.es" aria-label="Email">
      <i class="fa fa-envelope"></i>
    </a>
  </li>
  
  <li class="td-footer__links-item" data-bs-toggle="tooltip" title="Twitter" aria-label="Twitter">
    <a target="_blank" rel="noopener" href="https://twitter.com/therealdreg" aria-label="Twitter">
      <i class="fab fa-twitter"></i>
    </a>
  </li>
  
</ul>

        
        
      </div>
      <div class="col-6 col-sm-4 text-end text-xs-center order-sm-3">
        
        
        
      </div>
      <div class="td-footer__copyright-etc col-12 col-sm-4 text-center py-2 order-sm-2">
        
        
        
      </div>
    </div>
  </div>
</footer>
    </div>
    
  <script src="/js/main.min.99abe30f7fb05785a480d405ee1665ebd520cec6bbadffe966b7737e103675b8.js" integrity="sha256-mavjD3&#43;wV4WkgNQF7hZl69Ugzsa7rf/pZrdzfhA2dbg=" crossorigin="anonymous"></script>
<script defer src="/js/click-to-copy.min.f724d3de49218995223b7316aa2e53e2b34bf42026bf399ebb21bb02212402d1.js" integrity="sha256-9yTT3kkhiZUiO3MWqi5T4rNL9CAmvzmeuyG7AiEkAtE=" crossorigin="anonymous"></script>
<script src='/js/tabpane-persist.js'></script>

  </body>
</html>
